function RootController(t,e,a,i){var n=this;t.Globalize.culture(i.get("TRANSLATE_LANG_KEY")),n.changeLang=function(i){a.use(i),t.Globalize.culture(i),e.reload()},n.advertiser={name:"Adam"}}RootController.$inject=["$window","$state","$translate","$translateLocalStorage"],function(){"use strict";angular.module("pjtLayout",["ngAnimate","ngCookies","ngTouch","ngSanitize","ngMessages","ngAria","ui.router","ui.bootstrap","toastr","dx","pascalprecht.translate","chart.js","ngStorage"])}(),angular.module("pjtLayout").controller("RootController",RootController),function(){"use strict";function t(t){function e(e,a,i){return t({method:"GET",url:"http://private-anon-d71dffb7f-rtbs.apiary-mock.com/api/v1/statistics",params:{from:e,to:a,by:i}}).then(function(t){return t.data})}function a(e,a){return t({method:"GET",url:"http://private-anon-d71dffb7f-rtbs.apiary-mock.com/api/v1/totals",params:{from:e,to:a}}).then(function(t){return t.data})}function i(e,a,i,n,o,s,r,l){return t({method:"GET",url:"http://private-anon-d71dffb7f-rtbs.apiary-mock.com/api/v1/campaigns",params:{from:e,to:a,skip:i,take:n,sort:o,order:s,stat_by:r,filter:l}}).then(function(t){return t.data})}function n(e,a){return t({method:"GET",url:"http://private-anon-d71dffb7f-rtbs.apiary-mock.com/api/v1/map/clicks",params:{from:e,to:a}}).then(function(t){return t.data})}var o=this;o.statsCampaigns=i,o.statsTotals=a,o.statsChart=e,o.statsMap=n}t.$inject=["$http"],angular.module("pjtLayout").service("Main",t)}(),function(){"use strict";function t(t,e,a,i,n,o,s){var r=this;r.Main=s,r.multipleTotalCount=0,r.checkChart=[],r.by="";var l=n.instant;null==i.series&&(i.series=[{valueField:"impressions",name:"Impressions"},{valueField:"cpa",name:"CPA"},{valueField:"cpc",name:"CPC"},{valueField:"clicks",name:"clicks"},{valueField:"media",name:"media"},{valueField:"conversions",name:"conversions"},{valueField:"ctr",name:"CTR"}]);var c=[];if(null==i.checkChart){i.checkChart={impressions:!0,cpa:!0,cpc:!0,clicks:!0,media:!0,conversions:!0,ctr:!0},c=[];for(var d in i.checkChart)1==i.checkChart[d]&&c.push(d);r.by=c.join()}else{c=[];for(var d in i.checkChart)1==i.checkChart[d]&&c.push(d);r.by=c.join()}null==i.dataStart&&null==i.dataEnd?(i.dataStart=e.moment({hour:"00"}).subtract(1,"day").unix(),i.dataEnd=e.moment({hour:"00"}).subtract(1,"day").endOf("day").unix()):(r.dataStart=i.dataStart,r.dataEnd=i.dataEnd),null==i.SelectedTime&&(i.SelectedTime=0);var u=[{ID:0,Name:l("MAIN.DATE_PICKER.YESTERDAY"),dataStart:e.moment({hour:"00"}).subtract(1,"day").unix(),dataEnd:e.moment({hour:"00"}).subtract(1,"day").endOf("day").unix()},{ID:1,Name:l("MAIN.DATE_PICKER.LAST_3_DAYS"),dataStart:e.moment({hour:"00"}).subtract(3,"day").unix(),dataEnd:e.moment({hour:"00"}).unix()},{ID:2,Name:l("MAIN.DATE_PICKER.LAST_7_DAYS"),dataStart:e.moment({hour:"00"}).subtract(7,"day").unix(),dataEnd:e.moment({hour:"00"}).unix()},{ID:3,Name:l("MAIN.DATE_PICKER.LAST_14_DAYS"),dataStart:e.moment({hour:"00"}).subtract(14,"day").unix(),dataEnd:e.moment({hour:"00"}).unix()},{ID:4,Name:l("MAIN.DATE_PICKER.LAST_21_DAYS"),dataStart:e.moment({hour:"00"}).subtract(21,"day").unix(),dataEnd:e.moment({hour:"00"}).unix()},{ID:5,Name:l("MAIN.DATE_PICKER.CURRENT_MONTH"),dataStart:e.moment().startOf("month").unix(),dataEnd:e.moment().unix()},{ID:6,Name:l("MAIN.DATE_PICKER.LAST_MONTH"),dataStart:e.moment().subtract(1,"month").startOf("month").unix(),dataEnd:e.moment().subtract(1,"month").endOf("month").unix()},{ID:7,Name:l("MAIN.DATE_PICKER.LAST_90_DAYS"),dataStart:e.moment({hour:"00"}).subtract(90,"day").unix(),dataEnd:e.moment().unix()},{ID:8,Name:l("MAIN.DATE_PICKER.ALL_TIME"),dataStart:0,dataEnd:e.moment().unix()}];r.datePiker={items:u,displayExpr:"Name",valueExpr:"ID",value:u[i.SelectedTime].ID,onValueChanged:function(t){i.SelectedTime=t.value,i.dataStart=u[t.value].dataStart,i.dataEnd=u[t.value].dataEnd,a.reload()}},r.totals=[],r.chartStore=new e.DevExpress.data.CustomStore({totalCount:function(){return 0},load:function(){return r.Main.statsChart(r.dataStart,r.dataEnd,r.by).then(function(t){return t.statistics})}}),r.multipleStore=new e.DevExpress.data.CustomStore({totalCount:function(){return r.multipleTotalCount},load:function(t){return null==t.take&&(t.take=20),null==t.skip&&(t.skip=0),null==t.sort&&(t.sort="campaign"),null==t.order&&(t.order="DESC"),r.Main.statsCampaigns(r.dataStart,r.dataEnd,t.skip,t.take,t.sort,t.order,r.by,t.filter).then(function(t){return r.multipleTotalCount=t.totalCount,t.campaigns})}}),r.Main.statsTotals(r.dataStart,r.dataEnd).then(function(t){r.totals.spent=t.spend,r.totals.conv=t.conv,r.totals.imp=t.imp,r.totals.cpc=t.cpc,r.totals.cpm=t.cpm,r.totals.cvr=t.cvr,r.totals.ctr=t.ctr}),r.selectedItems=[],r.chartOptionsFuncgrid=[],r.dataGridOptionsMultiple={bindingOptions:{dataSource:"main.multipleStore"},onInitialized:function(t){r.dataGridOptionsMultipleFunc=t.component,r.dataGridOptionsMultipleFunc._controllers.columns._commandColumns[1].visibleIndex=15},showBorders:!0,alignment:"left",headerFilter:{visible:!0},pager:{showPageSizeSelector:!0,allowedPageSizes:[10,30,50],visible:!0,showNavigationButtons:!0},howBorders:!0,showRowLines:!0,columns:[{caption:l("MAIN.CAMPAIGN.COLUMNS.CAMPAIGN"),dataField:"campaign",cellTemplate:function(t,a){t.addClass("a-campaign"),e.angular.element('<a href="#/campaign/'+a.data.id+'">'+a.data.campaign+"</a>").appendTo(t)}},{caption:l("MAIN.CAMPAIGN.COLUMNS.SPENT"),dataField:"spend"},{caption:l("MAIN.CAMPAIGN.COLUMNS.CONV"),dataField:"conv"},{caption:l("MAIN.CAMPAIGN.COLUMNS.IMP"),dataField:"imp"},{caption:l("MAIN.CAMPAIGN.COLUMNS.CLICKS"),dataField:"clicks"},{caption:l("MAIN.CAMPAIGN.COLUMNS.CPC"),dataField:"cpc"},{caption:l("MAIN.CAMPAIGN.COLUMNS.CPM"),dataField:"cpm"},{caption:l("MAIN.CAMPAIGN.COLUMNS.CVR"),dataField:"cvr"},{caption:l("MAIN.CAMPAIGN.COLUMNS.CTR"),dataField:"ctr"},{width:200,dataField:l("MAIN.CAMPAIGN.COLUMNS.STATS"),cellTemplate:function(t,a){var n={onInitialized:function(t){r.chartOptionsFuncgrid[a.rowIndex]=t.component},dataSource:a.data.statistics,size:{height:80},commonSeriesSettings:{argumentField:"day",type:"line",point:{size:2,hoverStyle:{border:{visible:!0,width:1},size:4}}},commonAxisSettings:{label:{visible:!1},grid:{visible:!1}},argumentAxis:{valueMarginsEnabled:!1,discreteAxisDivisionMode:"crossLabels",grid:{visible:!1},label:{visible:!1},minorGrid:{visible:!1},minorTick:{visible:!1},tick:{visible:!1}},series:i.series,legend:{visible:!1},tooltip:{enabled:!0,customizeTooltip:function(t){return{text:t.valueText}}}};t.addClass("img-container"),e.angular.element('<div id="chartMulti'+a.rowIndex+'" ></div>').appendTo(t),e.$("#chartMulti"+a.rowIndex).dxChart(n).dxChart("instance")}}],selection:{mode:"multiple"},onSelectionChanged:function(t){r.selectedItems=t.selectedRowsData,r.disabled=!r.selectedItems.length}},r.types=["line","stackedLine","fullStackedLine"];r.chartOptions={onInitialized:function(t){r.chartOptionsFunc=t.component},series:i.series,size:{width:500,height:230},bindingOptions:{dataSource:"main.chartStore"},commonSeriesSettings:{argumentField:"day",type:r.types[0],point:{size:3,hoverStyle:{border:{visible:!0,width:2},size:5}}},margin:{bottom:20},argumentAxis:{valueMarginsEnabled:!1,discreteAxisDivisionMode:"crossLabels",grid:{visible:!0}},legend:{verticalAlignment:"bottom",horizontalAlignment:"center",itemTextPosition:"bottom"},tooltip:{enabled:!0,customizeTooltip:function(t){return{text:t.valueText}}}},r.impressions={text:l("MAIN.CHECKBOX.IMPRESSIONS"),value:i.checkChart.impressions?!0:!1,onValueChanged:function(t){if(1==t.value)i.checkChart.impressions=!0,i.series.push({valueField:"impressions",name:"Impressions"}),a.reload();else{i.checkChart.impressions=!1;for(var e in i.series)"impressions"==i.series[e].valueField&&i.series.splice(e,1);a.reload()}}},r.CPA={text:l("MAIN.CHECKBOX.CPA"),value:i.checkChart.cpa?!0:!1,onValueChanged:function(t){if(1==t.value)i.checkChart.cpa=!0,i.series.push({valueField:"cpa",name:"CPA"}),a.reload();else{i.checkChart.cpa=!1;for(var e in i.series)"cpa"==i.series[e].valueField&&i.series.splice(e,1);a.reload()}}},r.CPC={text:l("MAIN.CHECKBOX.CPC"),value:i.checkChart.cpc?!0:!1,onValueChanged:function(t){if(1==t.value)i.checkChart.cpc=!0,i.series.push({valueField:"cpc",name:"CPC"}),a.reload();else{i.checkChart.cpc=!1;for(var e in i.series)"cpc"==i.series[e].valueField&&i.series.splice(e,1);a.reload()}}},r.clicks={text:l("MAIN.CHECKBOX.CLICKS"),value:i.checkChart.clicks?!0:!1,onValueChanged:function(t){if(1==t.value)i.checkChart.clicks=!0,i.series.push({valueField:"clicks",name:"clicks"}),a.reload();else{i.checkChart.clicks=!1;for(var e in i.series)"clicks"==i.series[e].valueField&&i.series.splice(e,1);a.reload()}}},r.media={text:l("MAIN.CHECKBOX.MEDIA_SPENT"),value:i.checkChart.media?!0:!1,onValueChanged:function(t){if(1==t.value)i.checkChart.media=!0,i.series.push({valueField:"media",name:"media"}),a.reload();else{i.checkChart.media=!1;for(var e in i.series)"media"==i.series[e].valueField&&i.series.splice(e,1);a.reload()}}},r.conversions={text:l("MAIN.CHECKBOX.CONVERSIONS"),value:i.checkChart.conversions?!0:!1,onValueChanged:function(t){if(1==t.value)i.checkChart.conversions=!0,i.series.push({valueField:"conversions",name:"conversions"}),a.reload();else{i.checkChart.conversions=!1;for(var e in i.series)"conversions"==i.series[e].valueField&&i.series.splice(e,1);a.reload()}}},r.CTR={text:l("MAIN.CHECKBOX.CTR"),value:i.checkChart.ctr?!0:!1,onValueChanged:function(t){if(1==t.value)i.checkChart.ctr=!0,i.series.push({valueField:"ctr",name:"CTR"}),a.reload();else{i.checkChart.ctr=!1;for(var e in i.series)"ctr"==i.series[e].valueField&&i.series.splice(e,1);a.reload()}}};var m={};r.Main.statsMap(r.dataStart,r.dataEnd).then(function(t){m=t,$("#visualMap").dxVectorMap(r.vectorMapOptions)}),r.vectorMapOptions={size:{width:500,height:350},layers:[{name:"areas",dataSource:e.DevExpress.viz.map.sources.world,palette:"blue",colorGroups:[0,100,1e3,1e4],colorGroupingField:"clicks",label:{enabled:!0,dataField:"name"},customize:function(t){t.forEach(function(t){var e=t.attribute("name"),a=m[e];a&&t.attribute("clicks",a)})}}],tooltip:{enabled:!0,customizeTooltip:function(t){return{text:t.attribute("text")}}},legends:[{source:{layer:"areas",grouping:"color"},horizontalAlignment:"left",verticalAlignment:"bottom",customizeText:function(t){return t.start+" to "+t.end+" clicks"}}],bounds:[-180,85,180,-75]}}t.$inject=["$compile","$window","$state","$localStorage","$translate","$log","Main"],angular.module("pjtLayout").controller("MainController",t)}(),function(){"use strict";angular.module("pjtLayout").constant("RussianTranslations",{INDEX:{ADVERTISER_TITLE:"Статистика для",LEFT_NAV:{HOME:"Главная",CAMPAIGN:"Кампания",BILLING:"Биллинг",OPTIMIZER:"Оптимизатор"}},MAIN:{HOME:"Главная",DATE_PICKER:{YESTERDAY:"Вчера",LAST_3_DAYS:"Последние 3 дня",LAST_7_DAYS:"Последние 7 дней",LAST_14_DAYS:"Последние 14 дней",LAST_21_DAYS:"Последние 21 дней",CURRENT_MONTH:"Текущий месяц",LAST_MONTH:"Прошлый месяц",LAST_90_DAYS:"Последние 90 дней",ALL_TIME:"Все время"},TOTALS:{COLUMNS:{TOTALS:"ИТОГИ",SPENT:"Потрачено",CONV:"Конв",IMP:"Показы",CLICKS:"Клики",CPC:"CPC",CPM:"CPM",CVR:"CVR",CTR:"CTR"}},CAMPAIGN:{COLUMNS:{CAMPAIGN:"Кампания",SPENT:"Потрачено",CONV:"Конв",IMP:"Показы",CLICKS:"Клики",CPC:"CPC",CPM:"CPM",CVR:"CVR",CTR:"CTR",STATS:"Стат"}},CHECKBOX:{IMPRESSIONS:"Показы",CPA:"CPA",CPC:"CPC",CLICKS:"Клики",MEDIA_SPENT:"Потр на медий рекл",CONVERSIONS:"Конверсии",CTR:"CTR"}}})}(),function(){"use strict";angular.module("pjtLayout").constant("EnglishTranslations",{INDEX:{ADVERTISER_TITLE:"Stats for",LEFT_NAV:{HOME:"Home",CAMPAIGN:"Campaign",BILLING:"Billing",OPTIMIZER:"Optimizer"}},MAIN:{HOME:"Home",DATE_PICKER:{YESTERDAY:"Yesterday",LAST_3_DAYS:"Last 3 days",LAST_7_DAYS:"Last 7 days",LAST_14_DAYS:"Last 14 days",LAST_21_DAYS:"Last 21 days",CURRENT_MONTH:"Current month",LAST_MONTH:"Last month",LAST_90_DAYS:"Last 90 days",ALL_TIME:"All times"},TOTALS:{COLUMNS:{TOTALS:"TOTALS",SPENT:"Spent",CONV:"Conv",IMP:"Imp",CLICKS:"Clicks",CPC:"CPC",CPM:"CPM",CVR:"CVR",CTR:"CTR"}},CAMPAIGN:{COLUMNS:{CAMPAIGN:"Campaign",SPENT:"Spent",CONV:"Conv",IMP:"Imp",CLICKS:"Clicks",CPC:"CPC",CPM:"CPM",CVR:"CVR",CTR:"CTR",STATS:"Stats"}},CHECKBOX:{IMPRESSIONS:"Impressions",CPA:"CPA",CPC:"CPC",CLICKS:"Clicks",MEDIA_SPENT:"Media Spent",CONVERSIONS:"Conversions",CTR:"CTR"}}})}(),function(){"use strict";function t(t){}t.$inject=["$stateParams"],angular.module("pjtLayout").controller("CampaignController",t)}(),function(){"use strict";function t(t){t.debug("runBlock end")}t.$inject=["$log"],angular.module("pjtLayout").run(t)}(),function(){"use strict";function t(t,e){t.state("home",{url:"/",templateUrl:"app/main/main.html",controller:"MainController",controllerAs:"main"}).state("campaign",{url:"/campaign/:id",templateUrl:"app/campaign/camp.html",controller:"CampaignController",controllerAs:"camp"}),e.otherwise("/")}t.$inject=["$stateProvider","$urlRouterProvider"],angular.module("pjtLayout").config(t)}(),function(){"use strict";angular.module("pjtLayout")}(),function(){"use strict";function t(t,e,a,i,n){t.debugEnabled(!0),a.translations("en",n),a.translations("ru",i),a.useSanitizeValueStrategy("escape"),a.preferredLanguage("ru"),a.useLocalStorage(),a.storageKey("TRANSLATE_LANG_KEY"),e.allowHtml=!0,e.timeOut=3e3,e.positionClass="toast-top-right",e.preventDuplicates=!0,e.progressBar=!0}t.$inject=["$logProvider","toastrConfig","$translateProvider","RussianTranslations","EnglishTranslations"],angular.module("pjtLayout").config(t)}(),angular.module("pjtLayout").run(["$templateCache",function(t){t.put("app/campaign/camp.html",'<div class="container-camp col-md-10 col-lg-offset-2 col-md-10 col-lg-offset-2"><h1 translate=USERS.TITLE>Home</h1><div class=row><div id=container><div dx-vector-map=camp.vectorMapOptions id=visualMap></div></div></div></div>'),t.put("app/main/main.html",'<div class="container-home col-md-10 col-lg-offset-2 col-md-10 col-lg-offset-2"><h1 translate=MAIN.HOME>Home</h1><div class="col-md-3 col-md-offset-8 piker"><div dx-select-box=main.datePiker></div></div><div class=row><div id=container><div class="col-md-6 contLeft"><div dx-chart=main.chartOptions id=chart></div><div class=col-md-12><div class=checkbox-container><label class=label-checkbox><div dx-check-box=main.impressions></div></label><label class=label-checkbox><div dx-check-box=main.CPA></div></label><label class=label-checkbox><div dx-check-box=main.CPC></div></label><label class=label-checkbox><div dx-check-box=main.clicks></div></label></div><div class=checkbox-container><label class=label-checkbox><div dx-check-box=main.media></div></label><label class=label-checkbox><div dx-check-box=main.conversions></div></label><label class=label-checkbox><div dx-check-box=main.CTR></div></label></div></div></div><div id=visualMap></div></div></div><div class="row first-grid table-responsive"><table class="table table-bordered"><tr><td translate=MAIN.TOTALS.COLUMNS.TOTALS></td><td translate=MAIN.TOTALS.COLUMNS.SPENT></td><td translate=MAIN.TOTALS.COLUMNS.CONV></td><td translate=MAIN.TOTALS.COLUMNS.IMP></td><td translate=MAIN.TOTALS.COLUMNS.CPC></td><td translate=MAIN.TOTALS.COLUMNS.CPM></td><td translate=MAIN.TOTALS.COLUMNS.CVR></td><td translate=MAIN.TOTALS.COLUMNS.CTR></td></tr><tr><td></td><td>{{main.totals.spent}}</td><td>{{main.totals.conv}}</td><td>{{main.totals.imp}}</td><td>{{main.totals.cpc}}</td><td>{{main.totals.cpm}}</td><td>{{main.totals.cvr}}</td><td>{{main.totals.ctr}}</td></tr></table></div><div class="row second-grid"><div id=gridContainer2 dx-data-grid=main.dataGridOptionsMultiple></div></div></div>')}]);