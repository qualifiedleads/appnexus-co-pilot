function RootController(a,e,t,i,n){function o(){n.remove("permission"),n.remove("token"),e.go("auth")}var r=this;a.Globalize.culture(i.get("TRANSLATE_LANG_KEY")),r.changeLang=function(i){t.use(i),a.Globalize.culture(i),e.reload()},r.logout=o}RootController.$inject=["$window","$state","$translate","$translateLocalStorage","$cookies"],function(){"use strict";angular.module("pjtLayout",["ngAnimate","ngCookies","ngTouch","ngSanitize","ngMessages","ngAria","ui.router","ui.bootstrap","toastr","dx","pascalprecht.translate","chart.js","ngStorage"])}(),function(){"use strict";function a(a,e,t){function i(a,e,i){return new t.DevExpress.data.CustomStore({totalCount:function(){return 0},load:function(){return n(a,e,i)}})}function n(i,n,o){return a({method:"GET",url:"/api/v1/campaigns/"+encodeURI(i)+"/domains",headers:{Authorization:"Token "+e.get("token")},params:{from_date:n,to_date:o,take:999999}}).then(function(a){for(var e in a.data.data){var t=[];if(-1==a.data.data[e].analitics.good||-2==a.data.data[e].analitics.good||-3==a.data.data[e].analitics.good)t=null;else{var i=a.data.data[e].analitics.bad,n=a.data.data[e].analitics.good,o=1,r=1,l=+(100*i/(i+n));(.5>=l/100&&l/100>.45||.5>=(100-l)/100&&(100-l)/100>.45)&&(o=.03,r=.03),(.45>l/100&&l/100>.4||.45>(100-l)/100&&(100-l)/100>.4)&&(o=.09,r=.09),(.4>l/100&&l/100>.3||.4>(100-l)/100&&(100-l)/100>.3)&&(o=.2,r=.2),(.3>l/100&&l/100>.2||.3>(100-l)/100&&(100-l)/100>.2)&&(o=.5,r=.5),(.2>l/100&&l/100>.1||.2>(100-l)/100&&(100-l)/100>.1)&&(o=.7,r=.7),(.1>l/100&&l/100>0||.1>(100-l)/100&&(100-l)/100>0)&&(o=1,r=1);var c=100-l+"%",u=l+"%";t={good:a.data.data[e].analitics.good,bad:a.data.data[e].analitics.bad,checked:a.data.data[e].analitics.checked,badDiagram:u,goodDiagram:c,badOpasity:o,goodOpasity:r,k:l}}a.data.data[e].cvr=parseFloat((a.data.data[e].cvr||0).toFixed(4)),a.data.data[e].ctr=parseFloat((a.data.data[e].ctr||0).toFixed(4)),a.data.data[e].cpc=parseFloat((a.data.data[e].cpc||0).toFixed(4)),a.data.data[e].cpm=parseFloat((a.data.data[e].cpm||0).toFixed(4)),a.data.data[e].imp=parseFloat((a.data.data[e].imp||0).toFixed(4)),a.data.data[e].cpa=parseFloat((a.data.data[e].cpa||0).toFixed(4)),a.data.data[e].clicks=parseFloat((a.data.data[e].clicks||0).toFixed(4)),a.data.data[e].conv=parseFloat((a.data.data[e].conv||0).toFixed(4)),a.data.data[e].cost=parseFloat((a.data.data[e].cost||0).toFixed(2)),a.data.data[e].analitics=t,a.data.data[e].imps_viewed=parseFloat((a.data.data[e].imps_viewed||0).toFixed(4)),a.data.data[e].view_measured_imps=parseFloat((a.data.data[e].view_measured_imps||0).toFixed(4)),a.data.data[e].view_measurement_rate=parseFloat((a.data.data[e].view_measurement_rate||0).toFixed(1)),a.data.data[e].view_rate=parseFloat((a.data.data[e].view_rate||0).toFixed(1)),a.data.data[e].state={blackList:2&a.data.data[e].state,suspended:1&a.data.data[e].state,whiteList:4&a.data.data[e].state}}return d=a.data.totalCount,s.totalSummary=a.data.totalSummary,a.data.data})["catch"](function(a){t.DevExpress.ui.notify(a.data.detail,"error",4e3)})}function o(i,n,o){return a({method:"POST",url:"/api/v1/campaigns/"+i+"/MLPlacement",headers:{Authorization:"Token "+e.get("token")},data:{placementId:n,checked:o}}).then(function(a){return a.data})["catch"](function(a){t.DevExpress.ui.notify(a.statusText,"error",4e3)})}function r(i,n){return a({method:"GET",url:"/api/v1/campaigns/"+i+"/MLPlacement",headers:{Authorization:"Token "+e.get("token")},params:{placementId:n}}).then(function(a){var e=[];for(var t in a.data.analitics)if(-1==a.data.analitics[t].good)e[t]=!1;else{"0"==a.data.analitics[t].day&&(a.data.analitics[t].day="Sunday"),"1"==a.data.analitics[t].day&&(a.data.analitics[t].day="Monday"),"2"==a.data.analitics[t].day&&(a.data.analitics[t].day="Tuesday"),"3"==a.data.analitics[t].day&&(a.data.analitics[t].day="Wednesday"),"4"==a.data.analitics[t].day&&(a.data.analitics[t].day="Thursday"),"5"==a.data.analitics[t].day&&(a.data.analitics[t].day="Friday"),"6"==a.data.analitics[t].day&&(a.data.analitics[t].day="Saturday"),"7"==a.data.analitics[t].day&&(a.data.analitics[t].day="All week");var i=a.data.analitics[t].bad,n=a.data.analitics[t].good,o=1,r=1,s=+(100*i/(i+n));(.5>=s/100&&s/100>=.45||.5>=(100-s)/100&&(100-s)/100>.45)&&(o=.03,r=.03),(.45>s/100&&s/100>.4||.45>=(100-s)/100&&(100-s)/100>.4)&&(o=.09,r=.09),(.4>=s/100&&s/100>.3||.4>=(100-s)/100&&(100-s)/100>.3)&&(o=.2,r=.2),(.3>=s/100&&s/100>.2||.3>=(100-s)/100&&(100-s)/100>.2)&&(o=.5,r=.5),(.2>=s/100&&s/100>.1||.2>=(100-s)/100&&(100-s)/100>.1)&&(o=.7,r=.7),(.1>=s/100&&s/100>0||.1>=(100-s)/100&&(100-s)/100>0)&&(o=1,r=1);var d=100-s+"%",l=s+"%";e.push({day:a.data.analitics[t].day,good:a.data.analitics[t].good,bad:a.data.analitics[t].bad,checked:a.data.analitics[t].checked,badDiagram:l,goodDiagram:d,badOpasity:o,goodOpasity:r,k:s})}return e})["catch"](function(a){t.DevExpress.ui.notify(a.statusText,"error",4e3)})}var s=this,d=0;s.showAllMLDiagram=r,s.getGridCampaignStore=i,s.decisionML=o}a.$inject=["$http","$cookies","$window"],angular.module("pjtLayout").service("valuationByExpertS",a)}(),function(){"use strict";function a(a,e,t,i,n,o,r){var s=this,d=n.instant;s.campId=13921687,s.arrayDiagram=[],s.popUpIf=!1,s.culcReady=!1,s.popUpHide=function(){s.popUpIf=!1},null==t.SelectedTime?(t.SelectedTime=0,t.dataStart=a.moment({hour:"00"}).subtract(1,"day").unix(),t.dataEnd=a.moment({hour:"00"}).subtract(1,"day").endOf("day").unix(),s.dataStart=a.moment({hour:"00"}).subtract(1,"day").unix(),s.dataEnd=a.moment({hour:"00"}).subtract(1,"day").endOf("day").unix()):null==t.dataStart||null==t.dataEnd?(t.SelectedTime=0,t.dataStart=a.moment({hour:"00"}).subtract(1,"day").unix(),t.dataEnd=a.moment({hour:"00"}).subtract(1,"day").endOf("day").unix(),s.dataStart=a.moment({hour:"00"}).subtract(1,"day").unix(),s.dataEnd=a.moment({hour:"00"}).subtract(1,"day").endOf("day").unix()):(s.dataStart=t.dataStart,s.dataEnd=t.dataEnd);var l=[{ID:0,Name:d("MAIN.DATE_PICKER.YESTERDAY"),dataStart:a.moment({hour:"00"}).subtract(1,"day").unix(),dataEnd:a.moment({hour:"00"}).subtract(1,"day").endOf("day").unix()},{ID:1,Name:d("MAIN.DATE_PICKER.LAST_3_DAYS"),dataStart:a.moment({hour:"00"}).subtract(3,"day").unix(),dataEnd:a.moment({hour:"00"}).unix()},{ID:2,Name:d("MAIN.DATE_PICKER.LAST_7_DAYS"),dataStart:a.moment({hour:"00"}).subtract(7,"day").unix(),dataEnd:a.moment({hour:"00"}).unix()},{ID:3,Name:d("MAIN.DATE_PICKER.LAST_14_DAYS"),dataStart:a.moment({hour:"00"}).subtract(14,"day").unix(),dataEnd:a.moment({hour:"00"}).unix()},{ID:4,Name:d("MAIN.DATE_PICKER.LAST_21_DAYS"),dataStart:a.moment({hour:"00"}).subtract(21,"day").unix(),dataEnd:a.moment({hour:"00"}).unix()},{ID:5,Name:d("MAIN.DATE_PICKER.CURRENT_MONTH"),dataStart:a.moment().startOf("month").unix(),dataEnd:a.moment().unix()},{ID:6,Name:d("MAIN.DATE_PICKER.LAST_MONTH"),dataStart:a.moment().subtract(1,"month").startOf("month").unix(),dataEnd:a.moment().subtract(1,"month").endOf("month").unix()},{ID:7,Name:d("MAIN.DATE_PICKER.LAST_90_DAYS"),dataStart:a.moment({hour:"00"}).subtract(90,"day").unix(),dataEnd:a.moment().unix()},{ID:8,Name:d("MAIN.DATE_PICKER.ALL_TIME"),dataStart:0,dataEnd:a.moment().unix()}];s.gridStore=r.getGridCampaignStore(s.campId,s.dataStart,s.dataEnd),s.UI={datePiker:{items:l,displayExpr:"Name",valueExpr:"ID",value:l[t.SelectedTime].ID,onValueChanged:function(a){t.SelectedTime=a.value,t.dataStart=l[a.value].dataStart,t.dataEnd=l[a.value].dataEnd,e.reload()}},calculateAUC:{text:d("VBE.CALCULATE-AUC"),onClick:function(){s.culcReady=!0,i.$apply()}},dataGridOptionsExpert:{editing:{mode:"batch",allowUpdating:!0},alignment:"left",headerFilter:{visible:!0},filterRow:{visible:!0,applyFilter:"auto"},bindingOptions:{dataSource:"VBE.gridStore"},paging:{pageSize:10},remoteOperations:!1,pager:{showPageSizeSelector:!0,allowedPageSizes:[10,30,50],visible:!0,showNavigationButtons:!0},allowColumnReordering:!0,allowColumnResizing:!0,columnAutoWidth:!0,wordWrapEnabled:!0,showBorders:!0,showRowLines:!0,columns:[{caption:d("CAMP.CAMPAIGN.COLUMNS.PLACEMENT"),dataField:"placement",alignment:"center",dataType:"number"},{caption:d("CAMP.CAMPAIGN.COLUMNS.NETWORK"),dataField:"NetworkPublisher",alignment:"center",dataType:"string"},{caption:d("CAMP.CAMPAIGN.COLUMNS.CONV"),dataField:"conv",alignment:"center",dataType:"number"},{caption:d("CAMP.CAMPAIGN.COLUMNS.IMP"),dataField:"imp",dataType:"number",sortOrder:"desc",alignment:"center"},{caption:d("CAMP.CAMPAIGN.COLUMNS.CPA")+" ,$",dataField:"cpa",dataType:"number",alignment:"center"},{caption:d("CAMP.CAMPAIGN.COLUMNS.COST")+" ,$",dataField:"cost",alignment:"center",dataType:"number"},{caption:d("CAMP.CAMPAIGN.COLUMNS.CLICKS"),dataField:"clicks",alignment:"center",dataType:"number",allowEditing:!1},{caption:d("CAMP.CAMPAIGN.COLUMNS.CPC")+" ,$",dataField:"cpc",alignment:"center",dataType:"number"},{caption:d("CAMP.CAMPAIGN.COLUMNS.CPM")+" ,$",dataField:"cpm",alignment:"center",dataType:"number"},{caption:d("CAMP.CAMPAIGN.COLUMNS.CVR")+" ,%",dataField:"cvr",alignment:"center",dataType:"number"},{caption:d("CAMP.CAMPAIGN.COLUMNS.CTR")+" ,%",dataField:"ctr",alignment:"center",dataType:"number"},{caption:d("CAMP.CAMPAIGN.COLUMNS.IMPS_VIEWED"),dataField:"imps_viewed",alignment:"center",visible:!1,width:80,dataType:"number"},{caption:d("CAMP.CAMPAIGN.COLUMNS.VIEW_MEASURED_IMPS"),dataField:"view_measured_imps",alignment:"center",visible:!1,width:100,dataType:"number"},{caption:d("CAMP.CAMPAIGN.COLUMNS.VIEW_MEASUREMENT_RATE")+" ,%",dataField:"view_measurement_rate",alignment:"center",visible:!1,width:120,dataType:"number"},{caption:d("CAMP.CAMPAIGN.COLUMNS.VIEW_RATE")+" ,%",dataField:"view_rate",alignment:"center",visible:!1,width:80,dataType:"number"},{caption:"Prediction 1",width:115,columnIndex:16,dataField:"analytics",allowEditing:!1,cellTemplate:function(e,t){if(s.arrayDiagram.push(t.data),null===t.data.analitics);else{var n=(t.data.analitics.bad,t.data.analitics.good,t.data.analitics.badOpasity),d=t.data.analitics.goodOpasity,l=t.data.analitics.k,c=t.data.analitics.goodDiagram,u=t.data.analitics.badDiagram,p=o('<div class="analiticCO"><div class="diagramCO" ng-click="VBE.showAllDiagram('+t.data.placement+')"><div class="badDiagramCO" style="width:'+u+";opacity:"+n+';"></div><div class="goodDiagramCO" style="width:'+c+";opacity:"+d+';"></div><p class="textBadDiagramCO" >'+l.toFixed(1)+'%</p><p class="textGoodDiagramCO">'+(100-l).toFixed(1)+'%</p></div><div class="buttonAnaliticCO'+t.data.placement+'"><div class="trueButtonAnaliticCO'+t.data.placement+'"></div><div class="falseButtonAnaliticCO'+t.data.placement+'"></div></div></div>;')(i);p.appendTo(e);var m=a.$(".trueButtonAnaliticCO"+t.data.placement).dxButton({text:"True",disabled:!1,onClick:function(){a.$(".falseButtonAnaliticCO"+t.data.placement).removeClass("active-white"),a.$(".trueButtonAnaliticCO"+t.data.placement).addClass("active-white"),r.decisionML(s.campId,t.data.placement,!0).then(function(a){return a})}}),h=a.$(".falseButtonAnaliticCO"+t.data.placement).dxButton({text:"False",disabled:!1,onClick:function(){a.$(".falseButtonAnaliticCO"+t.data.placement).addClass("active-white"),a.$(".trueButtonAnaliticCO"+t.data.placement).removeClass("active-white"),r.decisionML(s.campId,t.data.placement,!1).then(function(a){return a})}});1==t.data.analitics.checked?m.addClass("active-white").append():m.append(),0==t.data.analitics.checked?h.addClass("active-white").append():h.append(),s.showAllDiagram=function(a){s.popUpIf=!0,r.showAllMLDiagram(s.campId,a).then(function(a){s.arraytoPopup=a})}}}}],columnChooser:{enabled:!0,height:180,width:400,emptyPanelText:"A place to hide the columns"},onInitialized:function(a){s.dataGridOptionsMultipleFunc=a.component,s.dataGridOptionsMultipleFunc._controllers.columns._commandColumns[1].visibleIndex=9,s.dataGridOptionsMultipleFunc._controllers.columns._commandColumns[1].width=35},onSelectionChanged:function(a){s.selectedItems=a.selectedRowsData,s.disabled=!s.selectedItems.length}}}}a.$inject=["$window","$state","$localStorage","$scope","$translate","$compile","valuationByExpertS"],angular.module("pjtLayout").controller("valuationByExpertController",a)}(),angular.module("pjtLayout").controller("RootController",RootController),function(){"use strict";function a(a,e,t){function i(a,t,i,o){return new e.DevExpress.data.CustomStore({totalCount:function(){return 0},load:function(){return n(a,t,i,o).then(function(a){return a.statistics})}})}function n(i,n,o,r){return a({method:"GET",url:"/api/v1/statistics",headers:{Authorization:"Token "+t.get("token")},params:{advertiser_id:i,from_date:n,to_date:o,by:r}}).then(function(a){for(var t in a.data.statistics)a.data.statistics[t].cvr=+parseFloat(a.data.statistics[t].cvr).toFixed(4),a.data.statistics[t].ctr=+parseFloat(a.data.statistics[t].ctr).toFixed(4),a.data.statistics[t].cpc=+parseFloat(a.data.statistics[t].cpc).toFixed(2),a.data.statistics[t].cpm=+parseFloat(a.data.statistics[t].cpm).toFixed(4),a.data.statistics[t].spend=+parseFloat(a.data.statistics[t].spend).toFixed(2),a.data.statistics[t].day=e.moment(a.data.statistics[t].day).format("DD/MM");return a.data})["catch"](function(a){e.DevExpress.ui.notify(a.data.detail,"error",4e3)})}function o(i,n,o){return a({method:"GET",url:"/api/v1/totals",headers:{Authorization:"Token "+t.get("token")},params:{advertiser_id:i,from_date:n,to_date:o}}).then(function(a){return a.data.totals.cvr=+parseFloat(a.data.totals.cvr).toFixed(4),a.data.totals.ctr=+parseFloat(a.data.totals.ctr).toFixed(4),a.data.totals.cpc=+parseFloat(a.data.totals.cpc).toFixed(2),a.data.totals.cpm=+parseFloat(a.data.totals.cpm).toFixed(2),a.data.totals.spend=+parseFloat(a.data.totals.spend).toFixed(2),a.data.totals})["catch"](function(a){e.DevExpress.ui.notify(a.data.detail,"error",4e3)})}function r(a,t,i,n){return new e.DevExpress.data.CustomStore({totalCount:function(){return c},load:function(e){return e.searchOperation&&e.dataField&&(e.take=999999),s(a,t,i,e.skip,e.take,e.sort,e.order,n,e.filter).then(function(a){return c=a.totalCount,a.campaigns})}})}function s(i,n,o,r,s,d,l,c,u){return d?(l=d[0].desc===!0?"desc":"asc",d=d[0].selector):(d="campaign",l="DESC"),null==s&&(s=20),null==r&&(r=0),a({method:"GET",url:"/api/v1/campaigns",headers:{Authorization:"Token "+t.get("token")},params:{advertiser_id:i,from_date:n,to_date:o,skip:r,take:s,sort:d,order:l,stat_by:c,filter:u}}).then(function(a){for(var e in a.data.campaigns){for(var t in a.data.campaigns[e].chart)a.data.campaigns[e].chart[t].conv=+parseFloat(a.data.campaigns[e].chart[t].conv).toFixed(4),a.data.campaigns[e].chart[t].cpc=+parseFloat(a.data.campaigns[e].chart[t].cpc).toFixed(2),a.data.campaigns[e].chart[t].ctr=+parseFloat(a.data.campaigns[e].chart[t].ctr).toFixed(4),a.data.campaigns[e].chart[t].cvr=+parseFloat(a.data.campaigns[e].chart[t].cvr).toFixed(4),a.data.campaigns[e].chart[t].spend=+parseFloat(a.data.campaigns[e].chart[t].spend).toFixed(2);a.data.campaigns[e].cvr=+parseFloat(a.data.campaigns[e].cvr).toFixed(4),a.data.campaigns[e].ctr=+parseFloat(a.data.campaigns[e].ctr).toFixed(4),a.data.campaigns[e].cpc=+parseFloat(a.data.campaigns[e].cpc).toFixed(4),a.data.campaigns[e].cpm=+parseFloat(a.data.campaigns[e].cpm).toFixed(4),a.data.campaigns[e].spend=+parseFloat(a.data.campaigns[e].spend).toFixed(4),a.data.campaigns[e].imps_viewed=+parseFloat(a.data.campaigns[e].imps_viewed).toFixed(4),a.data.campaigns[e].view_measured_imps=+parseFloat(a.data.campaigns[e].view_measured_imps).toFixed(4),a.data.campaigns[e].view_measurement_rate=+parseFloat(a.data.campaigns[e].view_measurement_rate).toFixed(1),a.data.campaigns[e].view_rate=+parseFloat(a.data.campaigns[e].view_rate).toFixed(1)}return a.data})["catch"](function(a){e.DevExpress.ui.notify(a.data.detail,"error",4e3)})}function d(i,n,o){return a({method:"GET",url:"/api/v1/map/clicks",headers:{Authorization:"Token "+t.get("token")},params:{advertiser_id:i,from_date:n,to_date:o}}).then(function(a){return a.data})["catch"](function(a){e.DevExpress.ui.notify(a.data.detail,"error",4e3)})}var l=this,c=0;l.multipleStore=r,l.chartStore=i,l.statsTotals=o,l.statsMap=d}a.$inject=["$http","$window","$cookies"],angular.module("pjtLayout").service("Main",a)}(),function(){"use strict";function a(a,e,t,i,n,o){function r(){for(var a in i.checkChart)i.checkChart[a]?("imp"==a&&s.chartOptionsFunc.getSeriesByName("Impressions").show(),"cvr"==a&&s.chartOptionsFunc.getSeriesByName("CVR").show(),"cpc"==a&&s.chartOptionsFunc.getSeriesByName("CPC").show(),"clicks"==a&&s.chartOptionsFunc.getSeriesByName("Clicks").show(),"spend"==a&&s.chartOptionsFunc.getSeriesByName("Cost").show(),"conv"==a&&s.chartOptionsFunc.getSeriesByName("Conversions").show(),"ctr"==a&&s.chartOptionsFunc.getSeriesByName("CTR").show()):("imp"==a&&s.chartOptionsFunc.getSeriesByName("Impressions").hide(),"cvr"==a&&s.chartOptionsFunc.getSeriesByName("CVR").hide(),"cpc"==a&&s.chartOptionsFunc.getSeriesByName("CPC").hide(),"clicks"==a&&s.chartOptionsFunc.getSeriesByName("Clicks").hide(),"spend"==a&&s.chartOptionsFunc.getSeriesByName("Cost").hide(),"conv"==a&&s.chartOptionsFunc.getSeriesByName("Conversions").hide(),"ctr"==a&&s.chartOptionsFunc.getSeriesByName("CTR").hide())}var s=this;s.advertiser=i.advertiser,s.Main=o,s.multipleTotalCount=0,s.checkChart=[],s.Init=[],s.by="imp,cvr,cpc,clicks,spend,conv,ctr",s.selectedItems=[],s.chartOptionsFuncgrid=[],s.charIsUpdating=!1;var d=n.instant;null==i.checkChart&&(i.checkChart={imp:!0,cvr:!1,cpc:!1,clicks:!1,spend:!1,conv:!1,ctr:!1});var l=[{valueField:"imp",name:"Impressions",axis:"imp",visible:i.checkChart.imp},{valueField:"cvr",name:"CVR",axis:"cvr",visible:i.checkChart.cvr},{valueField:"cpc",name:"CPC",axis:"cpc",visible:i.checkChart.cpc},{valueField:"clicks",name:"Clicks",axis:"clicks",visible:i.checkChart.clicks},{valueField:"spend",name:"Cost",axis:"spend",visible:i.checkChart.spend},{valueField:"conv",name:"Conversions",axis:"conv",visible:i.checkChart.conv},{valueField:"ctr",name:"CTR",axis:"ctr",visible:i.checkChart.ctr}];null==i.SelectedTime?(i.SelectedTime=0,i.dataStart=a.moment({hour:"00"}).subtract(1,"day").unix(),i.dataEnd=a.moment({hour:"00"}).subtract(1,"day").endOf("day").unix(),s.dataStart=a.moment({hour:"00"}).subtract(1,"day").unix(),s.dataEnd=a.moment({hour:"00"}).subtract(1,"day").endOf("day").unix()):null==i.dataStart||null==i.dataEnd?(i.SelectedTime=0,i.dataStart=a.moment({hour:"00"}).subtract(1,"day").unix(),i.dataEnd=a.moment({hour:"00"}).subtract(1,"day").endOf("day").unix(),s.dataStart=a.moment({hour:"00"}).subtract(1,"day").unix(),s.dataEnd=a.moment({hour:"00"}).subtract(1,"day").endOf("day").unix()):(s.dataStart=i.dataStart,s.dataEnd=i.dataEnd);var c=[{ID:0,Name:d("MAIN.DATE_PICKER.YESTERDAY"),dataStart:a.moment({hour:"00"}).subtract(1,"day").unix(),dataEnd:a.moment({hour:"00"}).subtract(1,"day").endOf("day").unix()},{ID:1,Name:d("MAIN.DATE_PICKER.LAST_3_DAYS"),dataStart:a.moment({hour:"00"}).subtract(3,"day").unix(),dataEnd:a.moment({hour:"00"}).unix()},{ID:2,Name:d("MAIN.DATE_PICKER.LAST_7_DAYS"),dataStart:a.moment({hour:"00"}).subtract(7,"day").unix(),dataEnd:a.moment({hour:"00"}).unix()},{ID:3,Name:d("MAIN.DATE_PICKER.LAST_14_DAYS"),dataStart:a.moment({hour:"00"}).subtract(14,"day").unix(),dataEnd:a.moment({hour:"00"}).unix()},{ID:4,Name:d("MAIN.DATE_PICKER.LAST_21_DAYS"),dataStart:a.moment({hour:"00"}).subtract(21,"day").unix(),dataEnd:a.moment({hour:"00"}).unix()},{ID:5,Name:d("MAIN.DATE_PICKER.CURRENT_MONTH"),dataStart:a.moment().startOf("month").unix(),dataEnd:a.moment().unix()},{ID:6,Name:d("MAIN.DATE_PICKER.LAST_MONTH"),dataStart:a.moment().subtract(1,"month").startOf("month").unix(),dataEnd:a.moment().subtract(1,"month").endOf("month").unix()},{ID:7,Name:d("MAIN.DATE_PICKER.LAST_90_DAYS"),dataStart:a.moment({hour:"00"}).subtract(90,"day").unix(),dataEnd:a.moment().unix()},{ID:8,Name:d("MAIN.DATE_PICKER.ALL_TIME"),dataStart:0,dataEnd:a.moment().unix()}];s.totals=[],s.Main.statsTotals(s.advertiser.id,s.dataStart,s.dataEnd).then(function(a){s.totals.imp=a.imp.toString().split(/(?=(?:\d{3})+(?!\d))/).join(),s.totals.spent=a.spend.toFixed(2),s.totals.conv=a.conv,s.totals.cpc=a.cpc,s.totals.cpm=a.cpm,s.totals.cvr=a.cvr,s.totals.ctr=a.ctr}),s.onlyTwo=function(a){var e=0,t=[],i=[];for(e=0;e<s.Init.length;e++)1==s.Init[e]._options.value?t.push(s.Init[e]):i.push(s.Init[e]);if(1==a){if(2==t.length&&i.length>4)for(e=0;e<i.length;e++)i[e].option("disabled",!0)}else if(t.length<=2)for(e=0;e<i.length;e++)i[e].option("disabled",!1)},s.updateCharts=function(e,t,n){var o={};i.checkChart[t]=n;var r=0;if(n)for(s.chartOptionsFunc.getSeriesByName(e).show(),o=a.$(".chartMulti"),r=0;r<o.length;r++)a.$(o[r]).dxChart("instance").getSeriesByName(e).show();else for(s.chartOptionsFunc.getSeriesByName(e).hide(),o=a.$(".chartMulti"),r=0;r<o.length;r++)a.$(o[r]).dxChart("instance").getSeriesByName(e).hide()};var u={};s.Main.statsMap(s.advertiser.id,s.dataStart,s.dataEnd).then(function(e){u=e,a.$("#visualMap").dxVectorMap(s.UI.vectorMapOptions)}),s.chartStore=o.chartStore(s.advertiser.id,s.dataStart,s.dataEnd,s.by),s.multipleStore=o.multipleStore(s.advertiser.id,s.dataStart,s.dataEnd,s.by),s.UI={datePiker:{items:c,displayExpr:"Name",valueExpr:"ID",value:c[i.SelectedTime].ID,onValueChanged:function(a){i.SelectedTime=a.value,i.dataStart=c[a.value].dataStart,i.dataEnd=c[a.value].dataEnd,e.reload()}},dataGridOptionsMultiple:{bindingOptions:{dataSource:"main.multipleStore"},onInitialized:function(a){s.dataGridOptionsMultipleFunc=a.component},alignment:"left",headerFilter:{visible:!0},filterRow:{visible:!0,applyFilter:"auto"},"export":{enabled:!0,fileName:"Employees"},allowColumnReordering:!0,allowColumnResizing:!0,columnAutoWidth:!0,wordWrapEnabled:!0,columnChooser:{enabled:!0},columnFixing:{enabled:!0},paging:{pageSize:10},pager:{showPageSizeSelector:!0,allowedPageSizes:[10,30,50],visible:!0,showNavigationButtons:!0},showBorders:!0,showRowLines:!0,columns:[{caption:d("MAIN.CAMPAIGN.COLUMNS.CAMPAIGN"),dataField:"campaign",fixed:!0,cellTemplate:function(e,t){e.addClass("a-campaign"),a.angular.element('<a href="#/home/campaign/'+t.data.id+'">'+t.data.campaign+"</a>").appendTo(e)},alignment:"center"},{caption:d("MAIN.CAMPAIGN.COLUMNS.SPENT")+" ,$",dataField:"spend",alignment:"center",dataType:"number"},{caption:d("MAIN.CAMPAIGN.COLUMNS.CONV"),dataField:"conv",alignment:"center",dataType:"number"},{caption:d("MAIN.CAMPAIGN.COLUMNS.IMP"),dataField:"imp",sortOrder:"desc",alignment:"center",dataType:"number"},{caption:d("MAIN.CAMPAIGN.COLUMNS.CLICKS"),dataField:"clicks",alignment:"center",dataType:"number"},{caption:d("MAIN.CAMPAIGN.COLUMNS.CPC")+" ,$",dataField:"cpc",alignment:"center",dataType:"number"},{caption:d("MAIN.CAMPAIGN.COLUMNS.CPM")+" ,$",dataField:"cpm",alignment:"center",dataType:"number"},{caption:d("MAIN.CAMPAIGN.COLUMNS.CVR")+" ,%",dataField:"cvr",alignment:"center",dataType:"number"},{caption:d("MAIN.CAMPAIGN.COLUMNS.CTR")+" ,%",dataField:"ctr",alignment:"center",dataType:"number"},{caption:d("MAIN.CAMPAIGN.COLUMNS.IMPS_VIEWED"),dataField:"imps_viewed",alignment:"center",width:90,dataType:"number"},{caption:d("MAIN.CAMPAIGN.COLUMNS.VIEW_MEASURED_IMPS"),dataField:"view_measured_imps",alignment:"center",width:100,dataType:"number"},{caption:d("MAIN.CAMPAIGN.COLUMNS.VIEW_MEASUREMENT_RATE")+" ,%",dataField:"view_measurement_rate",alignment:"center",width:120,dataType:"number"},{caption:d("MAIN.CAMPAIGN.COLUMNS.VIEW_RATE")+" ,%",dataField:"view_rate",alignment:"center",width:80,dataType:"number"},{width:200,dataField:d("MAIN.CAMPAIGN.COLUMNS.STATS"),cellTemplate:function(e,t){if(t.data.chart){var i={onInitialized:function(a){s.chartOptionsFuncgrid[t.rowIndex]=a.component},dataSource:t.data.chart,size:{height:80,width:185},commonSeriesSettings:{argumentField:"day",type:"line",point:{size:2,hoverStyle:{border:{visible:!0,width:1},size:4}}},commonAxisSettings:{label:{visible:!1},grid:{visible:!1}},valueAxis:[{name:"imp"},{name:"cvr"},{name:"cpc"},{name:"clicks"},{name:"spend"},{name:"conv"},{name:"ctr"}],argumentAxis:{valueMarginsEnabled:!1,discreteAxisDivisionMode:"crossLabels",grid:{visible:!1},label:{visible:!1},minorGrid:{visible:!1},minorTick:{visible:!1},tick:{visible:!1}},series:l,legend:{visible:!1},tooltip:{enabled:!0,customizeTooltip:function(a){return"Cost"==a.seriesName||"CPC"==a.seriesName?{text:"$"+a.valueText+" "+a.seriesName}:"CTR"==a.seriesName||"CVR"==a.seriesName?{text:a.valueText+"% "+a.seriesName}:{text:a.valueText+" "+a.seriesName}}}};e.addClass("img-container");var n=a.$('<div class="chartMulti" ></div>');n.dxChart(i),n.appendTo(e)}else e.addClass("img-container"),a.$('<div id="chartMulti" ></div>').appendTo(e)}}],onSelectionChanged:function(a){s.selectedItems=a.selectedRowsData,s.disabled=!s.selectedItems.length}},chartOptions:{onDone:function(){var a=$("#chart").dxChart("instance");if(!s.charIsUpdating){var e=[],t="left";s.UI.chartOptions.valueAxis.forEach(function(n,o){var r=i.checkChart[n.name];e.push({name:n.name,position:t,label:{alignment:"center",customizeText:function(){s.charIsUpdating=!0;var e=a._valueAxes[o]._majorTicks,t=null;if(Array.isArray(e)&&t<e[e.length-1].value&&(t=e[e.length-1].value),this.value==t)switch(n.name){case"imp":return'<span style="color:black; font-weight: bolder; text-decoration:underline;">'+d("MAIN.CHECKBOX.IMPRESSIONS")+"</span><br>"+this.value;case"cvr":return'<span style="color:black; font-weight: bolder; text-decoration:underline;">'+d("MAIN.CHECKBOX.CVR")+"</span><br>"+this.value;case"cpc":return'<span style="color:black; font-weight: bolder; text-decoration:underline;">'+d("MAIN.CHECKBOX.CPC")+"</span><br>"+this.value;case"clicks":return'<span style="color:black; font-weight: bolder; text-decoration:underline;">'+d("MAIN.CHECKBOX.CLICKS")+"</span><br>"+this.value;case"spend":return'<span style="color:black; font-weight: bolder; text-decoration:underline;">'+d("MAIN.CHECKBOX.COST")+"</span><br>"+this.value;case"conv":return'<span style="color:black; font-weight: bolder; text-decoration:underline;">'+d("MAIN.CHECKBOX.CONVERSIONS")+"</span><br>"+this.value;case"ctr":return'<span style="color:black; font-weight: bolder; text-decoration:underline;">'+d("MAIN.CHECKBOX.CTR")+"</span><br>"+this.value;default:return'<span style="color:black; font-weight: bolder; text-decoration:underline;">'+n.name+"</span><br>"+this.value}return this.value}}}),r&&(t="left"==t?"right":"left")}),a.option("valueAxis",e)}},onInitialized:function(a){s.chartOptionsFunc=a.component},series:l,bindingOptions:{dataSource:"main.chartStore"},commonSeriesSettings:{argumentField:"day",type:"Line",point:{size:6,hoverStyle:{border:{visible:!0,width:2},size:5}}},crosshair:{enabled:!0,color:"deepskyblue",label:{visible:!0}},commonAxisSettings:{valueMarginsEnabled:!0},margin:{bottom:20},argumentAxis:{discreteAxisDivisionMode:"crossLabels",grid:{visible:!0}},valueAxis:[{name:"imp",position:"left"},{name:"cvr",position:"left"},{name:"cpc",position:"left"},{name:"clicks",position:"left"},{name:"spend",position:"left"},{name:"conv",position:"left"},{name:"ctr",position:"left"}],legend:{verticalAlignment:"bottom",horizontalAlignment:"center",itemTextPosition:"bottom"},tooltip:{enabled:!0,customizeTooltip:function(a){return"Cost"==a.seriesName||"CPC"==a.seriesName?{text:"$"+a.valueText}:"CTR"==a.seriesName?{text:a.valueText+"%"}:{text:a.valueText}}}},impressions:{text:d("MAIN.CHECKBOX.IMPRESSIONS"),value:i.checkChart.imp,onInitialized:function(a){s.Init.push(a.component)},onValueChanged:function(a){s.updateCharts("Impressions","imp",a.value),s.onlyTwo(a.value),s.charIsUpdating=!1,s.UI.chartOptions.onDone(),r()}},CVR:{text:d("MAIN.CHECKBOX.CVR"),value:i.checkChart.cvr,onInitialized:function(a){s.Init.push(a.component)},onValueChanged:function(a){s.updateCharts("CVR","cvr",a.value),s.onlyTwo(a.value),s.charIsUpdating=!1,s.UI.chartOptions.onDone(),r()}},CPC:{text:d("MAIN.CHECKBOX.CPC"),value:i.checkChart.cpc,onInitialized:function(a){s.Init.push(a.component)},onValueChanged:function(a){s.updateCharts("CPC","cpc",a.value),s.onlyTwo(a.value),s.charIsUpdating=!1,s.UI.chartOptions.onDone(),r()}},clicks:{text:d("MAIN.CHECKBOX.CLICKS"),value:i.checkChart.clicks,onInitialized:function(a){s.Init.push(a.component)},onValueChanged:function(a){s.updateCharts("Clicks","clicks",a.value),s.onlyTwo(a.value),s.charIsUpdating=!1,s.UI.chartOptions.onDone(),r()}},cost:{text:d("MAIN.CHECKBOX.COST"),value:i.checkChart.spend,onInitialized:function(a){s.Init.push(a.component)},onValueChanged:function(a){s.updateCharts("Cost","spend",a.value),s.onlyTwo(a.value),s.charIsUpdating=!1,s.UI.chartOptions.onDone(),r()}},conversions:{text:d("MAIN.CHECKBOX.CONVERSIONS"),value:i.checkChart.conv,onInitialized:function(a){s.Init.push(a.component)},onValueChanged:function(a){s.updateCharts("Conversions","conv",a.value),s.onlyTwo(a.value),s.charIsUpdating=!1,s.UI.chartOptions.onDone(),r()}},CTR:{text:d("MAIN.CHECKBOX.CTR"),value:i.checkChart.ctr,onInitialized:function(a){s.Init.push(a.component)},onValueChanged:function(a){s.updateCharts("CTR","ctr",a.value),s.onlyTwo(a.value),s.charIsUpdating=!1,s.UI.chartOptions.onDone(),r()}},vectorMapOptions:{size:{height:320},layers:[{name:"areas",dataSource:a.DevExpress.viz.map.sources.world,palette:"blue",colorGroups:[0,100,1e3,1e4,1e5,1e7],colorGroupingField:"clicks",label:{enabled:!0,dataField:"name"},customize:function(a){a.forEach(function(a){var e=a.attribute("name"),t=u[e];t&&a.attribute("clicks",t)})}}],tooltip:{enabled:!0,customizeTooltip:function(a){return a.attribute("clicks")?{text:a.attribute("name")+": "+a.attribute("clicks")}:{text:a.attribute("name")}}},legends:[{source:{layer:"areas",grouping:"color"},horizontalAlignment:"left",verticalAlignment:"bottom",customizeText:function(a){return a.start+" to "+a.end+" clicks"}}],bounds:[-180,85,180,-75]}},t(function(){var a=0,e=[],t=[];for(a=0;a<s.Init.length;a++)1==s.Init[a]._options.value?e.push(s.Init[a]):t.push(s.Init[a]);if(e.length>=2&&t.length>4)for(a=0;a<t.length;a++)t[a].option("disabled",!0)})}a.$inject=["$window","$state","$timeout","$localStorage","$translate","Main"],angular.module("pjtLayout").controller("MainController",a)}(),function(){"use strict";angular.module("pjtLayout").constant("RussianTranslations",{COMMON:{"GO-TO-ADMIN-PANEL":"Панель администратора",LOGOUT:"Выйти","TO-MAIN-PAGE":"Главная",CANCEL:"Отмена"},AUTH:{"EMAIL-OR-PASSWORD-EMPTY":"E-mail или пароль пуст",GO_BUTTON:"Дальше","MAIL-REQUIRED":"Введите ваш email","MAIL-VALID":"Некорректный адрес электронной почты","PASSWORD-REQUIRED":"Введите ваш пароль","MAIL-PLACEHOLDER":"Введите адрес электронной почты","MAIL-PASSWORD":"Введите ваш пароль","MAIL-SUBMIT":"Вход"},ADMIN:{ANU:{"ADD-NEW-USER":"Добавить нового пользователя",EMAIL:"Электронная почта",PASSWORD:"Пароль","CONFIRM-PASSWORD":"Подтвердите пароль","USER-NAME":"Имя пользователя","FIRST-NAME":"Имя","LAST-NAME":"Фамилия","MAIL-REQUIRED":"Введите ваш email","MAIL-VALID":"Некорректный адрес электронной почты","PASSWORD-REQUIRED":"Введите ваш пароль","CONFIRM-PASSWORD-REQUIRED":"Введите подтверждение пароля","CONFIRM-PASSWORD-INCORRECT":"Неверный пароль","USER-NAME-REQUIRED":"Введите имя пользователя","FIRST-NAME-REQUIRED":"Введите имя","LAST-NAME-REQUIRED":"Введите фамилию","SELECT-PERMISSION":"Выберите тип доступа","SELECT-NEXUS-USER":"Выберите пользователя с AppNexus",SUBMIT:"Создать"},"LIST-USER":{TITLE:"Список пользователей",EMAIL:"Электронная почта",PASSWORD:"Пароль","CONFIRM-PASSWORD":"Подтвердите пароль","USER-NAME":"Имя пользователя","FIRST-NAME":"Имя","LAST-NAME":"Фамилия","APNEXUS-ID":"Id пользователя AppNexus","APNEXUS-NAME":"Имя пользователя AppNexus",PERMISSION:"Разрешение"}},INDEX:{ADVERTISER_TITLE:"Статистика для",LEFT_NAV:{HOME:"Главная",CAMPAIGN:"Кампания",BILLING:"Биллинг",OPTIMIZER:"Оптимизатор",EXPERT:"Оценка экспертом"}},MAIN:{HOME:"Главная",DATE_PICKER:{YESTERDAY:"Вчера",LAST_3_DAYS:"Последние 3 дня",LAST_7_DAYS:"Последние 7 дней",LAST_14_DAYS:"Последние 14 дней",LAST_21_DAYS:"Последние 21 дней",CURRENT_MONTH:"Текущий месяц",LAST_MONTH:"Прошлый месяц",LAST_90_DAYS:"Последние 90 дней",ALL_TIME:"Все время"},TOTALS:{
COLUMNS:{TOTALS:"ИТОГИ",SPENT:"Потрачено",CONV:"Конв",IMP:"Показы",CLICKS:"Клики",CPC:"CPC",CPM:"CPM",CVR:"CVR",CTR:"CTR"}},CAMPAIGN:{COLUMNS:{CAMPAIGN:"Кампания",PLACEMENT:"Размещение",NETWORK:"Сеть_Издатель",SPENT:"Потрачено",CONV:"Конв",IMP:"Показы",CPA:"CPA",CLICKS:"Клики",CPC:"CPC",CPM:"CPM",CVR:"CVR",CTR:"CTR",IMPS_VIEWED:"Видимые показы",VIEW_MEASURED_IMPS:"Измерено видимость показов",VIEW_MEASUREMENT_RATE:"Измереная видимост",VIEW_RATE:"Видимость",STATS:"Стат"}},CHECKBOX:{IMPRESSIONS:"Показы",CVR:"CVR",CPC:"CPC",CLICKS:"Клики",COST:"$ Затраты",CONVERSIONS:"Конверсии",CTR:"CTR"}},CAMP:{NAME:"Кампания","GO-OPTIMISER":"Перейти к оптимизатору",CHECKBOX:{IMPRESSIONS:"Показы",CPA:"CPA",CPC:"CPC",CLICKS:"Клики",COST:"$ Затраты",CONVERSIONS:"Конверсии",CTR:"CTR"},CAMPAIGN:{COLUMNS:{CAMPAIGN:"Кампания",PLACEMENT:"Размещение",NETWORK:"Сеть_Издатель",SPENT:"Потрачено",CONV:"Конв",COST:"Стоимость",IMP:"Показы",CPA:"CPA",CLICKS:"Клики",CPC:"CPC",CPM:"CPM",CVR:"CVR",CTR:"CTR",IMPS_VIEWED:"Видимые показы",VIEW_MEASURED_IMPS:"Измерено видимость показов",VIEW_MEASUREMENT_RATE:"Измереная видимост",VIEW_RATE:"Видимость",STATS:"Стат"}}},CO:{"NO-ITEMS-CHOSEN":"Пожалуйста, выберите по крайней мере 1 пункт","SEND-TO-SUSPEND-LIST":"Приостановить , пока я не добрался до него","SPECIFIC-DATE":"Выбрать дату","7-DAYS":"7 дней","3-DAYS":"3 дня","24-HRS":"24 часа","TEMP-SUSPEND":"Приостановленые",BLACKLISTED:"Blacklisted",WHITELIST:"Whitelist",SUSPEND:"Приостановить",OPTIMIZER:"Оптимизатор",BLOCKING:"Блокировка","DEVICE-AND-SUPPLY-TYPE":"Устройство и тип",GEO:"Геоинформация",DOMAIN:"Домен","DOMAIN-LISTS":"Списки доменов",DOMAINS:"Домены",RULES:"Правила для всех доменов:","OPTIMISER-FOR":"Оптимизатор для","CAMPAIGN-HOME":"Вернуться к компании"}})}(),function(){"use strict";angular.module("pjtLayout").constant("EnglishTranslations",{COMMON:{"GO-TO-ADMIN-PANEL":"Admin panel",LOGOUT:"Log out","TO-MAIN-PAGE":"Main page",CANCEL:"Cancel"},AUTH:{"EMAIL-OR-PASSWORD-EMPTY":"Email or Password is empty",GO_BUTTON:"GO","MAIL-REQUIRED":"Your email is required","MAIL-VALID":"Your email is not valid.","PASSWORD-REQUIRED":"Your password is required.","MAIL-PLACEHOLDER":"Enter your email","MAIL-PASSWORD":"Enter your password","MAIL-SUBMIT":"Submit"},ADMIN:{ANU:{"ADD-NEW-USER":"Add new user",EMAIL:"Email",PASSWORD:"Password","CONFIRM-PASSWORD":"Confirm password","USER-NAME":"User name","FIRST-NAME":"First name","LAST-NAME":"Last name","MAIL-REQUIRED":"Your email is required","MAIL-VALID":"Your email is not valid","PASSWORD-REQUIRED":"Your password is required","CONFIRM-PASSWORD-REQUIRED":"Password confirmation is required","CONFIRM-PASSWORD-INCORRECT":"Incorrect password","USER-NAME-REQUIRED":"User name is required","FIRST-NAME-REQUIRED":"First name is required","LAST-NAME-REQUIRED":"Last name is required","SELECT-PERMISSION":"Select the type of permission","SELECT-NEXUS-USER":"Select the appnexus user",SUBMIT:"Create"},"LIST-USER":{TITLE:"List of users",EMAIL:"Email",PASSWORD:"Password","CONFIRM-PASSWORD":"Confirm password","USER-NAME":"User name","FIRST-NAME":"First name","LAST-NAME":"Last name","APNEXUS-ID":"AppNexus user id","APNEXUS-NAME":"AppNexus user name",PERMISSION:"Permission"}},INDEX:{ADVERTISER_TITLE:"Stats for",LEFT_NAV:{HOME:"Home",CAMPAIGN:"Campaign",BILLING:"Billing",OPTIMIZER:"Optimizer",EXPERT:"Valuation by expert"}},MAIN:{HOME:"Home",DATE_PICKER:{YESTERDAY:"Yesterday",LAST_3_DAYS:"Last 3 days",LAST_7_DAYS:"Last 7 days",LAST_14_DAYS:"Last 14 days",LAST_21_DAYS:"Last 21 days",CURRENT_MONTH:"Current month",LAST_MONTH:"Last month",LAST_90_DAYS:"Last 90 days",ALL_TIME:"All times"},TOTALS:{COLUMNS:{TOTALS:"TOTALS",SPENT:"Spent",CONV:"Conv",IMP:"Imp",CLICKS:"Clicks",CPC:"CPC",CPM:"CPM",CVR:"CVR",CTR:"CTR"}},CAMPAIGN:{COLUMNS:{CAMPAIGN:"Campaign",PLACEMENT:"Placement",NETWORK:"Network + Publisher",SPENT:"Spent",CONV:"Conv",IMP:"Imp",CPA:"CPA",CLICKS:"Clicks",CPC:"CPC",CPM:"CPM",CVR:"CVR",CTR:"CTR",IMPS_VIEWED:"Visible imp",VIEW_MEASURED_IMPS:"Measured imp",VIEW_MEASUREMENT_RATE:"Viewed measurement rate",VIEW_RATE:"Viewed rate",STATS:"Stats"}},CHECKBOX:{IMPRESSIONS:"Impressions",CVR:"CVR",CPC:"CPC",CLICKS:"Clicks",COST:"$ Cost",CONVERSIONS:"Conversions",CTR:"CTR"}},CAMP:{NAME:"Campaign","GO-OPTIMISER":"Go to the Optimiser",CHECKBOX:{IMPRESSIONS:"Impressions",CPA:"CPA",CPC:"CPC",CLICKS:"Clicks",COST:"$ Cost",CONVERSIONS:"Conversions",CTR:"CTR"},CAMPAIGN:{COLUMNS:{CAMPAIGN:"Campaign",PLACEMENT:"Placement",NETWORK:"Network + Seller",SPENT:"Spent",CONV:"Conv",COST:"Cost",IMP:"Imp",CPA:"CPA",CLICKS:"Clicks",CPC:"CPC",CPM:"CPM",CVR:"CVR",CTR:"CTR",IMPS_VIEWED:"Visible imp",VIEW_MEASURED_IMPS:"Measured imp",VIEW_MEASUREMENT_RATE:"Viewed measurement rate",VIEW_RATE:"Viewed rate",STATS:"Stats"}}},CO:{"NO-ITEMS-CHOSEN":"No items chosen. Please, choose at least 1 item","SEND-TO-SUSPEND-LIST":'Send to "Suspend list" until I get to it',"SPECIFIC-DATE":"Specific date","7-DAYS":"7 days","3-DAYS":"3 days","24-HRS":"24 hrs","TEMP-SUSPEND":"Temp. Suspend",BLACKLISTED:"Blacklisted",WHITELIST:"Whitelist",SUSPEND:"Suspend",OPTIMIZER:"Optimizer",BLOCKING:"Blocking","DEVICE-AND-SUPPLY-TYPE":"Device and Supply Type",GEO:"Geo",DOMAIN:"Domain","DOMAIN-LISTS":"Domain Lists",DOMAINS:"Domains",RULES:"Rules for All Domains:","OPTIMISER-FOR":"Optimiser for","CAMPAIGN-HOME":"back to Campaign Home"},VBE:{"PAGE-NAME":"Valuation by expert","CALCULATE-AUC":"CalculateAUC"}})}(),function(){"use strict";function a(a,e,t,i){function n(){e.go("admin")}var o=this;o.advertiser={},o.a=123,!t.get("token")||"adminfull"!=t.get("permission")&&"adminread"!=t.get("permission")||(o.isEven=!0),!t.get("token")||"userfull"!=t.get("permission")&&"userread"!=t.get("permission")||(o.isEven=!1),null==a.advertiser?e.go("auth"):o.advertiser.name=a.advertiser.name,o.checked=function(a){var e=angular.element(i.document.querySelector("#wrapper"))[0];a?e.classList.add("hidden-menu"):e.classList.remove("hidden-menu")},o.goToAdminPanel=n}a.$inject=["$localStorage","$state","$cookies","$window"],angular.module("pjtLayout").controller("HomeController",a)}(),function(){"use strict";function a(a,e,t){function i(e){return a({method:"GET",headers:{Authorization:"Token "+t.get("token")},url:"/api/v1/campaigns/"+encodeURI(e)}).then(function(a){return a.data})["catch"](function(a){return a})}function n(i,n,o,r){return a({method:"GET",url:"/api/v1/campaigns/"+encodeURI(i)+"/graphinfo",headers:{Authorization:"Token "+t.get("token")},params:{from_date:n,to_date:o,by:r}}).then(function(a){for(var t in a.data)a.data[t].ctr=+parseFloat(a.data[t].ctr).toFixed(4),a.data[t].conversions=+parseFloat(a.data[t].conversions).toFixed(4),a.data[t].impression=+parseFloat(a.data[t].impression).toFixed(4),a.data[t].cpa=+parseFloat(a.data[t].cpa).toFixed(4),a.data[t].cpc=+parseFloat(a.data[t].cpc).toFixed(4),a.data[t].clicks=+parseFloat(a.data[t].clicks).toFixed(4),a.data[t].cost=+parseFloat(a.data[t].mediaspent).toFixed(4),a.data[t].day=e.moment(a.data[t].day).format("DD/MM");return a.data})["catch"](function(a){return a})}function o(i,n,o){return a({method:"GET",url:"/api/v1/campaigns/"+encodeURI(i)+"/cpareport",headers:{Authorization:"Token "+t.get("token")},params:{from_date:n,to_date:o}}).then(function(a){for(var t in a.data)a.data[t].avg=+parseFloat(a.data[t].avg).toFixed(4),a.data[t].ctr=+parseFloat(a.data[t].ctr).toFixed(4),a.data[t].close=+parseFloat(a.data[t].close).toFixed(4),a.data[t].high=+parseFloat(a.data[t].high).toFixed(4),a.data[t].low=+parseFloat(a.data[t].low).toFixed(4),a.data[t].open=+parseFloat(a.data[t].open).toFixed(4),a.data[t].day=e.moment().locale("en").isoWeekday(a.data[t].date).format("ddd");return a.data})["catch"](function(a){return a})}function r(e,i,n,o,r,s,d,l,c){return s?(d=s[0].desc===!0?"desc":"asc",s=s[0].selector):(s="placement",d="DESC"),null==r&&(r=10),null==o&&(o=0),a({method:"GET",url:"/api/v1/campaigns/"+encodeURI(e)+"/domains",headers:{Authorization:"Token "+t.get("token")},params:{from_date:i,to_date:n,skip:o,take:r,sort:s,order:d,filter:l,totalSummary:c}}).then(function(a){var e=a.data.data.map(function(a){return{NetworkPublisher:a.NetworkPublisher,placement:a.placement,placement_name:a.placement_name,cvr:parseFloat((a.cvr||0).toFixed(4)),ctr:parseFloat((a.ctr||0).toFixed(4)),cpc:parseFloat((a.cpc||0).toFixed(4)),cpm:parseFloat((a.cpm||0).toFixed(4)),imp:parseFloat((a.imp||0).toFixed(4)),cpa:parseFloat((a.cpa||0).toFixed(4)),clicks:parseFloat((a.clicks||0).toFixed(4)),conv:parseFloat((a.conv||0).toFixed(4)),cost:parseFloat((a.cost||0).toFixed(2)),imps_viewed:parseFloat((a.imps_viewed||0).toFixed(4)),view_measured_imps:parseFloat((a.view_measured_imps||0).toFixed(4)),view_measurement_rate:parseFloat((a.view_measurement_rate||0).toFixed(1)),view_rate:parseFloat((a.view_rate||0).toFixed(1)),state:{blackList:2&a.state,suspended:1&a.state,whiteList:4&a.state}}});return p=a.data.totalCount,u.totalSummary=a.data.totalSummary,e})["catch"](function(a){return a})}function s(i,n,o,r){return a({method:"POST",url:"/api/v1/campaigns/"+encodeURI(i)+"/changestate",headers:{Authorization:"Token "+t.get("token")},data:{placement:n,activeState:o,suspendTimes:r}}).then(function(a){return a.data})["catch"](function(a){e.DevExpress.ui.notify(a.data.detail,"error",4e3)})}function d(a,t,i,o){return new e.DevExpress.data.CustomStore({totalCount:function(){return 0},load:function(){return n(a,t,i,o)}})}function l(a,t,i){return new e.DevExpress.data.CustomStore({totalCount:function(){return 0},load:function(){return o(a,t,i)}})}function c(a,t,i){return new e.DevExpress.data.CustomStore({totalCount:function(){return p},load:function(e){return e.searchOperation&&e.dataField&&(e.take=999999),r(a,t,i,e.skip,e.take,e.sort,e.order,e.filter,e.totalSummary)}})}var u=this,p=0;u.nameCampaigns=i,u.editCampaignDomains=s,u.getChartStore=d,u.getGridCampaignStore=c,u.getBoxPlotStore=l}a.$inject=["$http","$window","$cookies"],angular.module("pjtLayout").service("CampMain",a)}(),function(){"use strict";function a(a,e,t,i,n,o,r,s){function d(){for(var a in t.checkCharCamp)t.checkCharCamp[a]?("impression"==a&&c.gridCharts.getSeriesByName("Impressions").show(),"cpa"==a&&c.gridCharts.getSeriesByName("CPA").show(),"cpc"==a&&c.gridCharts.getSeriesByName("CPC").show(),"clicks"==a&&c.gridCharts.getSeriesByName("Clicks").show(),"cost"==a&&c.gridCharts.getSeriesByName("Cost").show(),"conversions"==a&&c.gridCharts.getSeriesByName("Conversions").show(),"ctr"==a&&c.gridCharts.getSeriesByName("CTR").show()):("impression"==a&&c.gridCharts.getSeriesByName("Impressions").hide(),"cpa"==a&&c.gridCharts.getSeriesByName("CPA").hide(),"cpc"==a&&c.gridCharts.getSeriesByName("CPC").hide(),"clicks"==a&&c.gridCharts.getSeriesByName("Clicks").hide(),"cost"==a&&c.gridCharts.getSeriesByName("Cost").hide(),"conversions"==a&&c.gridCharts.getSeriesByName("Conversions").hide(),"ctr"==a&&c.gridCharts.getSeriesByName("CTR").hide())}function l(e,t){return e.dataSource.postProcess=function(e){var i=a._.uniqBy(e,t);return i.map(function(a){return{text:a[t],value:a[t]}})}}var c=this,u=i.instant,p=null,m={};c.Camp=o;var h=new Date;c.checkChart=[],c.by="imp,cvr,cpc,clicks,spend,conv,ctr",c.campName=r.campaign,c.campId=r.id,c.Init=[],null==t.checkCharCamp&&(t.checkCharCamp={impression:!0,cpa:!1,cpc:!1,clicks:!1,cost:!1,conversions:!1,ctr:!1}),null==t.SelectedTime?(t.SelectedTime=0,t.dataStart=a.moment({hour:"00"}).subtract(1,"day").unix(),t.dataEnd=a.moment({hour:"00"}).subtract(1,"day").endOf("day").unix(),c.dataStart=a.moment({hour:"00"}).subtract(1,"day").unix(),c.dataEnd=a.moment({hour:"00"}).subtract(1,"day").endOf("day").unix()):null==t.dataStart||null==t.dataEnd?(t.SelectedTime=0,t.dataStart=a.moment({hour:"00"}).subtract(1,"day").unix(),t.dataEnd=a.moment({hour:"00"}).subtract(1,"day").endOf("day").unix(),c.dataStart=a.moment({hour:"00"}).subtract(1,"day").unix(),c.dataEnd=a.moment({hour:"00"}).subtract(1,"day").endOf("day").unix()):(c.dataStart=t.dataStart,c.dataEnd=t.dataEnd);var v=[{ID:0,Name:u("MAIN.DATE_PICKER.YESTERDAY"),dataStart:a.moment({hour:"00"}).subtract(1,"day").unix(),dataEnd:a.moment({hour:"00"}).subtract(1,"day").endOf("day").unix()},{ID:1,Name:u("MAIN.DATE_PICKER.LAST_3_DAYS"),dataStart:a.moment({hour:"00"}).subtract(3,"day").unix(),dataEnd:a.moment({hour:"00"}).unix()},{ID:2,Name:u("MAIN.DATE_PICKER.LAST_7_DAYS"),dataStart:a.moment({hour:"00"}).subtract(7,"day").unix(),dataEnd:a.moment({hour:"00"}).unix()},{ID:3,Name:u("MAIN.DATE_PICKER.LAST_14_DAYS"),dataStart:a.moment({hour:"00"}).subtract(14,"day").unix(),dataEnd:a.moment({hour:"00"}).unix()},{ID:4,Name:u("MAIN.DATE_PICKER.LAST_21_DAYS"),dataStart:a.moment({hour:"00"}).subtract(21,"day").unix(),dataEnd:a.moment({hour:"00"}).unix()},{ID:5,Name:u("MAIN.DATE_PICKER.CURRENT_MONTH"),dataStart:a.moment().startOf("month").unix(),dataEnd:a.moment().unix()},{ID:6,Name:u("MAIN.DATE_PICKER.LAST_MONTH"),dataStart:a.moment().subtract(1,"month").startOf("month").unix(),dataEnd:a.moment().subtract(1,"month").endOf("month").unix()},{ID:7,Name:u("MAIN.DATE_PICKER.LAST_90_DAYS"),dataStart:a.moment({hour:"00"}).subtract(90,"day").unix(),dataEnd:a.moment().unix()},{ID:8,Name:u("MAIN.DATE_PICKER.ALL_TIME"),dataStart:0,dataEnd:a.moment().unix()}];c.datePiker={items:v,displayExpr:"Name",valueExpr:"ID",value:v[t.SelectedTime].ID,onValueChanged:function(a){t.SelectedTime=a.value,t.dataStart=v[a.value].dataStart,t.dataEnd=v[a.value].dataEnd,e.reload()}},c.optimiser={text:u("CAMP.GO-OPTIMISER"),onClick:function(){e.go("home.campaignOptimiser",{id:c.campId})}},c.chartStore=o.getChartStore(c.campId,c.dataStart,c.dataEnd,c.by),c.boxPlotStore=o.getBoxPlotStore(c.campId,c.dataStart,c.dataEnd),c.gridStore=o.getGridCampaignStore(c.campId,c.dataStart,c.dataEnd),c.charIsUpdating=!1,c.chartOptionsFirst={onDone:function(){var a=$("#zoomedChartFirst").dxChart("instance");if(!c.charIsUpdating){var e=[],i="left";c.chartOptionsFirst.valueAxis.forEach(function(n,o){var r=t.checkCharCamp[n.name];e.push({name:n.name,position:i,label:{alignment:"center",customizeText:function(){c.charIsUpdating=!0;var e=a._valueAxes[o]._majorTicks,t=null;if(Array.isArray(e)&&t<e[e.length-1].value&&(t=e[e.length-1].value),this.value==t)switch(n.name){case"impression":return'<span style="color:black; font-weight: bolder; text-decoration:underline;">'+u("CAMP.CHECKBOX.IMPRESSIONS")+"</span><br>"+this.value;case"cpa":return'<span style="color:black; font-weight: bolder; text-decoration:underline;">'+u("CAMP.CHECKBOX.CPA")+"</span><br>"+this.value;case"cpc":return'<span style="color:black; font-weight: bolder; text-decoration:underline;">'+u("CAMP.CHECKBOX.CPC")+"</span><br>"+this.value;case"clicks":return'<span style="color:black; font-weight: bolder; text-decoration:underline;">'+u("CAMP.CHECKBOX.CLICKS")+"</span><br>"+this.value;case"cost":return'<span style="color:black; font-weight: bolder; text-decoration:underline;">'+u("CAMP.CHECKBOX.COST")+"</span><br>"+this.value;case"conversions":return'<span style="color:black; font-weight: bolder; text-decoration:underline;">'+u("CAMP.CHECKBOX.CONVERSIONS")+"</span><br>"+this.value;case"ctr":return'<span style="color:black; font-weight: bolder; text-decoration:underline;">'+u("CAMP.CHECKBOX.CTR")+"</span><br>"+this.value;default:return'<span style="color:black; font-weight: bolder; text-decoration:underline;">'+n.name+"</span><br>"+this.value}return this.value}}}),r&&(i="left"==i?"right":"left")}),a.option("valueAxis",e)}},onInitialized:function(a){c.chartOptionsFuncFirst=a.component},valueAxis:[{name:"impression",position:"left"},{name:"cpa",position:"left"},{name:"cpc",position:"left"},{name:"clicks",position:"left"},{name:"cost",position:"left"},{name:"conversions",position:"left"},{name:"ctr",position:"left"}],argumentAxis:{discreteAxisDivisionMode:"crossLabels",grid:{visible:!0}},crosshair:{enabled:!0,color:"deepskyblue",label:{visible:!0}},legend:{verticalAlignment:"top",horizontalAlignment:"center",itemTextPosition:"top"},commonSeriesSettings:{point:{size:7,hoverStyle:{border:{visible:!0,width:2},size:5}}},bindingOptions:{dataSource:"campmain.chartStore"},series:[{name:"Impressions",argumentField:"day",valueField:"impression",axis:"impression",visible:t.checkCharCamp.impression},{argumentField:"day",valueField:"cpa",name:"CPA",axis:"cpa",visible:t.checkCharCamp.cpa},{argumentField:"day",valueField:"cpc",name:"CPC",axis:"cpc",visible:t.checkCharCamp.cpc},{argumentField:"day",valueField:"clicks",name:"Clicks",axis:"clicks",visible:t.checkCharCamp.clicks},{argumentField:"day",valueField:"cost",name:"Cost",axis:"cost",visible:t.checkCharCamp.cost},{argumentField:"day",valueField:"conversions",name:"Conversions",axis:"conversions",visible:t.checkCharCamp.conversions},{argumentField:"day",valueField:"ctr",name:"CTR",axis:"ctr",visible:t.checkCharCamp.ctr}],loadingIndicator:{show:!0,text:"Creating a chart..."}},c.rangeOptionsFirst={size:{height:80},scale:{minorTickInterval:"day",tickInterval:{days:1},minRange:"day",maxRange:"year",minorTick:{visible:!0}},bindingOptions:{dataSource:"campmain.chartStore"},dataSourceField:"day",sliderMarker:{format:"monthAndDay"},behavior:{callSelectedRangeChanged:"onMoving"},onSelectedRangeChanged:function(e){var t=a.$("#zoomedContainerFirst #zoomedChartFirst").dxChart("instance");t.zoomArgument(e.startValue,e.endValue)}},c.updateCharts=function(e,i,n){t.checkCharCamp[i]=n,c.gridCharts=a.$("#zoomedChartFirst").dxChart("instance"),c.rangeChartFirst=a.$("#rangeChartFirst").dxRangeSelector("instance"),n?c.gridCharts.getSeriesByName(e).show():c.chartOptionsFuncFirst.getSeriesByName(e).hide()},c.onlyTwo=function(a){var e=0,t=[],i=[];for(e=0;e<c.Init.length;e++)1==c.Init[e]._options.value?t.push(c.Init[e]):i.push(c.Init[e]);if(1==a){if(2==t.length&&i.length>4)for(e=0;e<i.length;e++)i[e].option("disabled",!0)}else if(t.length<=2)for(e=0;e<i.length;e++)i[e].option("disabled",!1)},c.impressions={text:u("CAMP.CHECKBOX.IMPRESSIONS"),value:t.checkCharCamp.impression,onInitialized:function(a){c.Init.push(a.component)},onValueChanged:function(a){c.updateCharts("Impressions","impression",a.value),c.onlyTwo(a.value),c.charIsUpdating=!1,c.chartOptionsFirst.onDone(),d()}},c.CPA={text:u("CAMP.CHECKBOX.CPA"),value:t.checkCharCamp.cpa,onInitialized:function(a){c.Init.push(a.component)},onValueChanged:function(a){c.updateCharts("CPA","cpa",a.value),c.onlyTwo(a.value),c.charIsUpdating=!1,c.chartOptionsFirst.onDone(),d()}},c.CPC={text:u("CAMP.CHECKBOX.CPC"),value:t.checkCharCamp.cpc,onInitialized:function(a){c.Init.push(a.component)},onValueChanged:function(a){c.updateCharts("CPC","cpc",a.value),c.onlyTwo(a.value),c.charIsUpdating=!1,c.chartOptionsFirst.onDone(),d()}},c.clicks={text:u("CAMP.CHECKBOX.CLICKS"),value:t.checkCharCamp.clicks,onInitialized:function(a){c.Init.push(a.component)},onValueChanged:function(a){c.updateCharts("Clicks","clicks",a.value),c.onlyTwo(a.value),c.charIsUpdating=!1,c.chartOptionsFirst.onDone(),d()}},c.cost={text:u("CAMP.CHECKBOX.COST"),value:t.checkCharCamp.cost,onInitialized:function(a){c.Init.push(a.component)},onValueChanged:function(a){c.updateCharts("Cost","cost",a.value),c.onlyTwo(a.value),c.charIsUpdating=!1,c.chartOptionsFirst.onDone(),d()}},c.conversions={text:u("CAMP.CHECKBOX.CONVERSIONS"),value:t.checkCharCamp.conversions,onInitialized:function(a){c.Init.push(a.component)},onValueChanged:function(a){c.updateCharts("Conversions","conversions",a.value),c.onlyTwo(a.value),c.charIsUpdating=!1,c.chartOptionsFirst.onDone(),d()}},c.CTR={text:u("CAMP.CHECKBOX.CTR"),value:t.checkCharCamp.ctr,onInitialized:function(a){c.Init.push(a.component)},onValueChanged:function(a){c.updateCharts("CTR","ctr",a.value),c.onlyTwo(a.value),c.charIsUpdating=!1,c.chartOptionsFirst.onDone(),d()}},n(function(){var a=0,e=[],t=[];for(a=0;a<c.Init.length;a++)1==c.Init[a]._options.value?e.push(c.Init[a]):t.push(c.Init[a]);if(e.length>=2&&t.length>4)for(a=0;a<t.length;a++)t[a].option("disabled",!0)}),c.chartOptionsSecond={bindingOptions:{dataSource:"campmain.boxPlotStore"},valueAxis:{title:"CPA, $"},argumentAxis:{grid:{visible:!0},label:{visible:!0},discreteAxisDivisionMode:"crossLabels"},tooltip:{enabled:!0,customizeTooltip:function(a){return"Series 2"===a.seriesName?{text:"Average: $"+a.originalValue}:"Series 1"===a.seriesName?{text:"Q1: $"+a.openValue+"<br/>Q3: $"+a.closeValue+"<br/>High: $"+a.highValue+"<br/>Low: $"+a.lowValue+"<br/>"}:void 0}},legend:{visible:!1},loadingIndicator:{show:!0,text:"Creating a chart..."},useAggregation:!0,commonSeriesSettings:{candlestick:{openValueField:"open",closeValueField:"close",highValueField:"high",lowValueField:"low"},argumentField:"day",point:{size:6,hoverStyle:{border:{visible:!0,width:1},size:4}}},series:[{type:"candlestick"},{valueField:"avg",color:"silver"}]},c.rangeOptionsSecond={size:{height:80},bindingOptions:{dataSource:"campmain.boxPlotStore"},scale:{minorTickInterval:"day",tickInterval:{days:1},minRange:"day",maxRange:"year",minorTick:{visible:!0}},dataSourceField:"day",sliderMarker:{format:"week"},behavior:{callSelectedRangeChanged:"onMoving"},onSelectedRangeChanged:function(e){var t=a.$("#zoomedContainerSecond #zoomedChartSecond").dxChart("instance");t.zoomArgument(new Date(e.startValue),new Date(e.endValue))}},c.selectedItems=[],c.chartOptionsFuncgrid=[],null==t.boxPlotData&&(t.boxPlotData=c.boxPlotData),c.state="",c.selectCell={dataSource:[{name:"White List",state:"whiteList"},{name:"Black List",state:"blackList"},{name:"Suspended",state:"suspended"}],disabled:!0,placeholder:"Select a state",displayExpr:"name",valueExpr:c.state,onSelectionChanged:function(){var e=a.$("#gridContainer2")[0].querySelectorAll('[aria-selected="true"]');if(e[0])for(var t=[],i=0;i<e.length;i++)t.push(e[i].firstChild.innerText)}},c.UI={dateFormatPop:{disabled:!0,type:"date",value:h,onValueChanged:function(a){p=a.value}},radioGroupMain:{items:[u("CO.24-HRS"),u("CO.3-DAYS"),u("CO.7-DAYS"),u("CO.SPECIFIC-DATE")],value:u("CO.24-HRS"),onValueChanged:function(a){var e=$("#radioGroupSend").dxRadioGroup("instance");if(a.value)if(e.option("value",!1),a.value==u("CO.SPECIFIC-DATE")){var t=$("#dateFormatPop").dxDateBox("instance");t.option("disabled",!1)}else{var t=$("#dateFormatPop").dxDateBox("instance");t.option("disabled",!0),p=null}}},radioGroupSend:{items:[u("CO.SEND-TO-SUSPEND-LIST")],onValueChanged:function(a){p=null;var e=$("#dateFormatPop").dxDateBox("instance");e.option("disabled",!0);var t=$("#radioGroupMain").dxRadioGroup("instance");a.value&&t.option("value",!1)}},confirmPopup:{onInitialized:function(a){c.confirmPopup=a.component},bindingOptions:{visible:"crc.confirmPopupVisible"},showTitle:!1,width:320,height:300},confirmPopupOk:{width:110,text:"OK",disabled:!1,onClick:function(){var e,t=$("#radioGroupMain").dxRadioGroup("instance"),i=$("#radioGroupSend").dxRadioGroup("instance");t._options.value!==!1&&(t._options.value==u("CO.24-HRS")&&(e=a.moment().add(1,"day").unix()),t._options.value==u("CO.3-DAYS")&&(e=a.moment().add(3,"day").unix()),t._options.value==u("CO.7-DAYS")&&(e=a.moment().add(7,"day").unix())),i._options.value!==!1&&(e="unlimited"),null!==p&&(e=a.moment(p).unix()),null==i._options.value&&t._options.value==u("CO.24-HRS")&&(e=a.moment().add(1,"day").unix()),o.editCampaignDomains(c.campId,m.placement,1,e).then(function(){for(var e=0;e<m.placement.length;e++)a.$("div.state-black"+m.placement[e]).removeClass("active"),a.$("div.state-white"+m.placement[e]).removeClass("active"),a.$("div.state-suspended"+m.placement[e]).addClass("active")}),c.confirmPopupVisible=!1,c.confirmPopup.option("visible",!1),s.$apply()}},confirmPopupCancel:{width:120,text:u("COMMON.CANCEL"),onClick:function(){c.confirmPopup.option("visible",!1),s.$apply()}}},c.dataGridOptionsCampaign={onInitialized:function(a){c.dataGridOptionsMultipleFunc=a.component,c.dataGridOptionsMultipleFunc._controllers.columns._commandColumns[1].visibleIndex=9,c.dataGridOptionsMultipleFunc._controllers.columns._commandColumns[1].width=35},onRowPrepared:function(a){if(c.objectData=a,"data"==c.objectData.rowType){var e=a.rowElement[0].childNodes[11],t=a.data.state;"true"==t.whiteList&&e.classList.add("active-white"),"true"==t.blackList&&e.classList.add("active-black"),"true"==t.suspended&&e.classList.add("active-suspended")}},alignment:"left",headerFilter:{visible:!0},filterRow:{visible:!0,applyFilter:"auto"},bindingOptions:{dataSource:"campmain.gridStore"},paging:{pageSize:10},remoteOperations:!0,pager:{showPageSizeSelector:!0,allowedPageSizes:[10,30,50],visible:!0,showNavigationButtons:!0},allowColumnReordering:!0,allowColumnResizing:!0,columnAutoWidth:!0,wordWrapEnabled:!0,showBorders:!0,showRowLines:!0,columns:[{caption:u("CAMP.CAMPAIGN.COLUMNS.PLACEMENT"),dataField:"placement",alignment:"center",dataType:"number",headerFilter:{dataSource:function(a){return l(a,"placement")}}},{caption:u("CAMP.CAMPAIGN.COLUMNS.NETWORK"),dataField:"NetworkPublisher",alignment:"center",dataType:"string",headerFilter:{dataSource:function(a){return l(a,"NetworkPublisher")}}},{caption:u("CAMP.CAMPAIGN.COLUMNS.CONV"),dataField:"conv",alignment:"center",dataType:"number",headerFilter:{dataSource:function(a){return l(a,"conv")}}},{caption:u("CAMP.CAMPAIGN.COLUMNS.IMP"),dataField:"imp",dataType:"number",sortOrder:"desc",alignment:"center",headerFilter:{dataSource:function(a){return l(a,"imp")}}},{caption:u("CAMP.CAMPAIGN.COLUMNS.CPA")+" ,$",dataField:"cpa",dataType:"number",alignment:"center",headerFilter:{dataSource:function(a){return l(a,"cpa")}}},{caption:u("CAMP.CAMPAIGN.COLUMNS.COST")+" ,$",dataField:"cost",alignment:"center",dataType:"number",headerFilter:{dataSource:function(a){return l(a,"cost")}}},{caption:u("CAMP.CAMPAIGN.COLUMNS.CLICKS"),dataField:"clicks",alignment:"center",dataType:"number",headerFilter:{dataSource:function(a){return l(a,"clicks")}}},{caption:u("CAMP.CAMPAIGN.COLUMNS.CPC")+" ,$",dataField:"cpc",alignment:"center",dataType:"number",headerFilter:{dataSource:function(a){return l(a,"cpc")}}},{caption:u("CAMP.CAMPAIGN.COLUMNS.CPM")+" ,$",dataField:"cpm",alignment:"center",dataType:"number",headerFilter:{dataSource:function(a){return l(a,"cpm")}}},{caption:u("CAMP.CAMPAIGN.COLUMNS.CVR")+" ,%",dataField:"cvr",alignment:"center",dataType:"number",headerFilter:{dataSource:function(a){return l(a,"cvr")}}},{caption:u("CAMP.CAMPAIGN.COLUMNS.CTR")+" ,%",dataField:"ctr",alignment:"center",dataType:"number",headerFilter:{dataSource:function(a){return l(a,"ctr")}}},{caption:u("CAMP.CAMPAIGN.COLUMNS.IMPS_VIEWED"),dataField:"imps_viewed",alignment:"center",visible:!1,width:80,dataType:"number",headerFilter:{dataSource:function(a){return l(a,"imps_viewed")}}},{caption:u("CAMP.CAMPAIGN.COLUMNS.VIEW_MEASURED_IMPS"),dataField:"view_measured_imps",alignment:"center",visible:!1,width:100,dataType:"number",headerFilter:{dataSource:function(a){return l(a,"view_measured_imps")}}},{caption:u("CAMP.CAMPAIGN.COLUMNS.VIEW_MEASUREMENT_RATE")+" ,%",dataField:"view_measurement_rate",alignment:"center",visible:!1,width:120,dataType:"number",headerFilter:{dataSource:function(a){return l(a,"view_measurement_rate")}}},{caption:u("CAMP.CAMPAIGN.COLUMNS.VIEW_RATE")+" ,%",dataField:"view_rate",alignment:"center",visible:!1,width:80,dataType:"number",headerFilter:{dataSource:function(a){return l(a,"view_rate")}}},{caption:"State",width:300,columnIndex:16,dataField:"state",allowEditing:!1,headerFilter:{dataSource:[{text:"White",value:["state","=",4]},{text:"Black",value:["state","=",2]},{text:"Suspended",value:["state","=",1]}]},cellTemplate:function(e,t){var i=a.$("<div />").dxButton({text:"white",height:30,width:89,disabled:!1,onClick:function(e){o.editCampaignDomains(c.campId,[t.data.placement],4).then(function(e){return a.$("div.state-white"+t.data.placement).addClass("active"),a.$("div.state-black"+t.data.placement).removeClass("active"),a.$("div.state-suspended"+t.data.placement).removeClass("active"),e})["catch"](function(a){return a})}});4==t.data.state.whiteList?i.addClass("state-white"+t.data.placement).addClass("active").appendTo(e):i.addClass("state-white"+t.data.placement).appendTo(e);var n=a.$("<div />").dxButton({text:"black",height:30,width:89,disabled:!1,onClick:function(e){o.editCampaignDomains(c.campId,[t.data.placement],2).then(function(e){return a.$("div.state-black"+t.data.placement).addClass("active"),a.$("div.state-white"+t.data.placement).removeClass("active"),a.$("div.state-suspended"+t.data.placement).removeClass("active"),e})["catch"](function(a){return a})}});2==t.data.state.blackList?n.addClass("state-black"+t.data.placement).addClass("active").appendTo(e):n.addClass("state-black"+t.data.placement).appendTo(e);var r=a.$("<div />").dxButton({text:"suspend",height:30,width:95,disabled:!1,onClick:function(){m.placement=[t.data.placement],m.suspend=1,c.confirmPopup.option("visible",!0)}});1==t.data.state.suspended?r.addClass("state-suspended"+t.data.placement).addClass("active").appendTo(e):r.addClass("state-suspended"+t.data.placement).appendTo(e)}}],summary:{totalItems:[{column:"placement",summaryType:"count",customizeText:function(a){return a.valueText="Count: "+c.dataGridOptionsMultipleFunc.totalCount(),a.valueText}},{column:"conv",summaryType:"sum",customizeText:function(a){return a.valueText="Conv: "+c.Camp.totalSummary.conv,a.valueText}},{column:"imp",summaryType:"sum",customizeText:function(a){return a.valueText="Imp: "+c.Camp.totalSummary.imp,a.valueText}},{column:"cpa",summaryType:"sum",valueFormat:"currency",customizeText:function(a){return a.valueText="CPA: $"+c.Camp.totalSummary.cpa.toFixed(4),a.valueText}},{column:"cost",summaryType:"sum",valueFormat:"currency",customizeText:function(a){return a.valueText="Cost: $"+c.Camp.totalSummary.cost.toFixed(2),a.valueText}},{column:"clicks",summaryType:"sum",customizeText:function(a){return a.valueText="Clicks: "+c.Camp.totalSummary.clicks,a.valueText}},{column:"cpc",summaryType:"sum",customizeText:function(a){return a.valueText="CPC: $"+c.Camp.totalSummary.cpc.toFixed(4),a.valueText}},{column:"cpm",summaryType:"sum",customizeText:function(a){return a.valueText="CPM: $"+c.Camp.totalSummary.cpm.toFixed(4),a.valueText}},{column:"cvr",summaryType:"sum",customizeText:function(a){return a.valueText="CVR: "+c.Camp.totalSummary.cvr.toFixed(4),a.valueText}},{column:"ctr",summaryType:"sum",customizeText:function(a){return a.valueText="CTR: "+c.Camp.totalSummary.ctr.toFixed(4),a.valueText}}]},columnChooser:{enabled:!0,height:180,width:400,emptyPanelText:"A place to hide the columns"},selection:{mode:"multiple",allowSelectAll:!1,showCheckBoxesMode:"always"},onEditorPreparing:function(e){"filterRow"==e.parentType&&"State"==e.caption&&(e.editorElement.dxSelectBox({dataSource:[{name:"White List",state:4},{name:"Black List",state:2},{name:"Suspended",state:1}],placeholder:"Select a state",displayExpr:"name",valueExpr:c.state,onSelectionChanged:function(e){var t=a.$("#gridContainer2")[0].querySelectorAll('[aria-selected="true"]');if(t[0]){for(var i=[],n=0;n<t.length;n++)i.push(t[n].firstChild.innerText);1==e.selectedItem.state?"[]"!=i&&(m.placement=i,m.suspend="suspend",c.confirmPopupVisible=!0,c.confirmPopup.option("visible",!0)):"[]"!=i&&o.editCampaignDomains(c.campId,i,e.selectedItem.state).then(function(a){$("#gridContainer2").dxDataGrid("instance").refresh()})["catch"](function(){$("#gridContainer2").dxDataGrid("instance").refresh()})}else a.DevExpress.ui.notify(u("CO.NO-ITEMS-CHOSEN"),"warning",4e3)}}),e.cancel=!0)},onSelectionChanged:function(a){c.selectedItems=a.selectedRowsData,c.disabled=!c.selectedItems.length}},c.rangeFirstChartOptions={margin:{left:50},scale:{startValue:new Date(t.dataStart),endValue:new Date(t.dataEnd),minorTickInterval:"day",minRange:"hour",maxRange:"month",minorTick:{visible:!1}},sliderMarker:{format:"monthAndDay"}},c.rangeSecondChartOptions={margin:{left:50,top:12},size:{height:150,width:450},scale:{startValue:new Date(t.dataStart),endValue:new Date(t.dataEnd),minorTickInterval:"day",minRange:"day",maxRange:"month",minorTick:{visible:!1}},sliderMarker:{format:"monthAndDay"}},c.ctrlBbtns={placement:{btn:"Placement",
header:"Placement"},creativeId:{btn:"creative_id",header:"creative_id"},creativeSize:{btn:"creative_size",header:"creative_size"},viewability:{btn:"viewability",header:"viewability"},os:{btn:"OS",header:"Operating System used"},carrier:{btn:"carrier",header:"carrier"},networkSeller:{btn:"network(seller)",header:"network (seller)"},connectionType:{btn:"connection_type",header:"connection_type"},device:{btn:"device",header:"device"},seller:{btn:"seller",header:"Seller"}},c.pieChartHeader=t.pieChartHeader||c.ctrlBbtns.os.header}a.$inject=["$window","$state","$localStorage","$translate","$timeout","CampMain","Campaign","$scope"],angular.module("pjtLayout").controller("CampaignMainController",a)}(),function(){"use strict";function a(a,e){function t(t){return a({method:"GET",headers:{Authorization:"Token "+e.get("token")},url:"/api/v1/campaigns/"+encodeURI(t)}).then(function(a){return a.data})}function i(t,i,n,o){return a({method:"GET",url:"/api/v1/campaigns/"+encodeURI(t)+"/details",headers:{Authorization:"Token "+e.get("token")},params:{from_date:i,to_date:n,section:o}}).then(function(a){for(var e in a.data.all)a.data.all[e].data=+parseFloat(a.data.all[e].data).toFixed(4);for(var e in a.data.conversions)a.data.conversions[e].data=+parseFloat(a.data.conversions[e].data).toFixed(4);return a.data})}function n(t,i,n,o){return a({method:"GET",url:"/api/v1/campaigns/"+encodeURI(t)+"/cpabuckets",headers:{Authorization:"Token "+e.get("token")},params:{id:t,from_date:i,to_date:n,category:o}}).then(function(a){for(var e in a.data)a.data[e].cpa=+parseFloat(a.data[e].cpa).toFixed(3);return a.data})}var o=this;o.nameCampaigns=t,o.bucketsCpa=n,o.detailsStoreAll=i}a.$inject=["$http","$cookies"],angular.module("pjtLayout").service("CampDetails",a)}(),function(){"use strict";function a(a,e,t,i,n,o,r,s){var d=this;d.Camp=n,d.multipleTotalCount=0,d.checkChart=[],d.by="imp,cvr,cpc,clicks,spend,conv,ctr";i.instant;d.campName=s.campaign,d.campId=s.id,d.cpaResult=[],d.selectedSection=t.selectedSection,d.detailsStoreAll=new a.DevExpress.data.CustomStore({totalCount:function(){return 0},load:function(){return o.all}}),d.detailsStoreConversion=new a.DevExpress.data.CustomStore({totalCount:function(){return 0},load:function(){return o.conversions}}),d.cpaBucketRequestFirst=new a.DevExpress.data.CustomStore({totalCount:function(){return 0},load:function(){d.cpaResult=r;for(var a=[],e=0;e<d.cpaResult.length;e++)+d.cpaResult[e].cpa>=d.backetsRanges.first.min&&+d.cpaResult[e].cpa<d.backetsRanges.first.max&&a.push(d.cpaResult[e]);return a}}),d.cpaBucketRequestSecond=new a.DevExpress.data.CustomStore({totalCount:function(){return 0},load:function(){for(var a=[],e=0;e<d.cpaResult.length;e++)+d.cpaResult[e].cpa>=d.backetsRanges.second.min&&+d.cpaResult[e].cpa<d.backetsRanges.second.max&&a.push(d.cpaResult[e]);return a}}),d.cpaBucketRequestThird=new a.DevExpress.data.CustomStore({totalCount:function(){return 0},load:function(){for(var a=[],e=0;e<d.cpaResult.length;e++)+d.cpaResult[e].cpa>=d.backetsRanges.third.min&&+d.cpaResult[e].cpa<d.backetsRanges.third.max&&a.push(d.cpaResult[e]);return a}}),d.cpaBucketRequestFourth=new a.DevExpress.data.CustomStore({totalCount:function(){return 0},load:function(){for(var a=[],e=0;e<d.cpaResult.length;e++)+d.cpaResult[e].cpa>=d.backetsRanges.fourth.min&&+d.cpaResult[e].cpa<d.backetsRanges.fourth.max&&a.push(d.cpaResult[e]);return a}}),d.ctrlBbtns={placement:{btn:"Placement",header:"Placement"},creativeId:{btn:"creative_id",header:"creative_id"},creativeSize:{btn:"creative_size",header:"creative_size"},os:{btn:"OS",header:"Operating System used"},carrier:{btn:"carrier",header:"carrier"},networkSeller:{btn:"network(seller)",header:"network (seller)"},connectionType:{btn:"connection_type",header:"connection_type"},device:{btn:"device",header:"device"}},d.pieChartHeader=t.pieChartHeader||d.ctrlBbtns.placement.header,d.btnsNodesArray=a.$(".label-container")[0].children;for(var l in d.ctrlBbtns)d.ctrlBbtns[l].header==d.pieChartHeader&&(d.selectedSection=d.ctrlBbtns[l].btn,t.selectedSection=d.selectedSection);Array.prototype.forEach.call(d.btnsNodesArray,function(a){a.name==d.selectedSection&&a.classList.add("nav-btn-active")}),d.selectInfoBtn=function(a,i){d.pieChartHeader=i,t.pieChartHeader=d.pieChartHeader,Array.prototype.forEach.call(d.btnsNodesArray,function(a){a.classList.contains("nav-btn-active")&&a.classList.remove("nav-btn-active")}),t.pieChartHeader=d.pieChartHeader,a.currentTarget.classList.add("nav-btn-active");for(var n in d.ctrlBbtns)d.ctrlBbtns[n].header==d.pieChartHeader&&(t.selectedSection=d.ctrlBbtns[n].btn);e.reload()},d.targetCpa||(d.targetCpa=t.targetCpa||1,t.targetCpa=d.targetCpa),d.backetsRanges={first:{min:0,max:Number(d.targetCpa).toFixed(2)},second:{min:Number(d.targetCpa).toFixed(2),max:Number(2*d.targetCpa).toFixed(2)},third:{min:Number(2*d.targetCpa).toFixed(2),max:Number(3*d.targetCpa).toFixed(2)},fourth:{min:Number(3*d.targetCpa).toFixed(2),max:Number(1e5*d.targetCpa).toFixed(2)}},d.targetCpaChange=function(e){var i=Number(e.currentTarget.value);return t.targetCpa=i,d.backetsRanges={first:{min:0,max:i.toFixed(2)},second:{min:i.toFixed(2),max:(2*i).toFixed(2)},third:{min:(2*i).toFixed(2),max:(3*i).toFixed(2)},fourth:{min:(3*i).toFixed(2),max:(1e5*i).toFixed(2)}},a.$("#backets-1").dxDataGrid("instance").refresh(),a.$("#backets-2").dxDataGrid("instance").refresh(),a.$("#backets-3").dxDataGrid("instance").refresh(),a.$("#backets-4").dxDataGrid("instance").refresh(),d.backetsRanges},d.pieChartAll={title:{text:"All",font:{size:20},margin:{bottom:1}},bindingOptions:{dataSource:"campdetails.detailsStoreAll"},legend:{visible:!1},tooltip:{enabled:!0,format:{type:"millions",percentPrecision:2},customizeTooltip:function(a){return{text:a.argument+" - "+a.value+"%"}}},series:[{argumentField:"section",valueField:"data",smallValuesGrouping:{mode:"topN",topCount:25}}]},d.pieChartConversions={title:{text:"Conversions",font:{size:20},margin:{bottom:1}},bindingOptions:{dataSource:"campdetails.detailsStoreConversion"},legend:{visible:!1},tooltip:{enabled:!0,customizeTooltip:function(a){return{text:a.argument+" - "+a.value+"%"}}},series:[{argumentField:"section",valueField:"data",smallValuesGrouping:{mode:"topN",topCount:25}}]},d.columnsPlacement=[{caption:"sellerid",dataField:"sellerid"},{caption:"sellername",dataField:"sellername"},{caption:"placementid",dataField:"placementid"},{caption:"placementname",dataField:"placementname"},{caption:"cpa, $",dataField:"cpa",sortOrder:"desc"}],d.columnsCreativeId=[{caption:"creative id",dataField:"creative"},{caption:"creative name",dataField:"creative_name"},{caption:"cpa, $",dataField:"cpa",sortOrder:"desc"}],d.columnsCreativeSize=[{caption:"size",dataField:"size"},{caption:"cpa, $",dataField:"cpa",sortOrder:"desc"}],d.columnsOs=[{caption:"operating system id",dataField:"operating_system"},{caption:"operating system",dataField:"operating_system_name"},{caption:"cpa, $",dataField:"cpa",sortOrder:"desc"}],d.columnsCarrier=[{caption:"carrier id",dataField:"carrier"},{caption:"carrier name",dataField:"carrier_name"},{caption:"cpa, $",dataField:"cpa",sortOrder:"desc"}],d.columnsNetworkSeller=[{caption:"seller member",dataField:"seller_member"},{caption:"seller member name",dataField:"seller_member_name"},{caption:"cpa, $",dataField:"cpa",sortOrder:"desc"}],d.columnsConnectionType=[{caption:"connection type",dataField:"connection_type"},{caption:"cpa, $",dataField:"cpa",sortOrder:"desc"}],d.columnsDevice=[{caption:"device model",dataField:"device_model"},{caption:"device model name",dataField:"device_model_name"},{caption:"cpa, $",dataField:"cpa",sortOrder:"desc"}],"Placement"==t.selectedSection?d.columnsSelected=d.columnsPlacement:"creative_id"==t.selectedSection?d.columnsSelected=d.columnsCreativeId:"creative_size"==t.selectedSection?d.columnsSelected=d.columnsCreativeSize:"OS"==t.selectedSection?d.columnsSelected=d.columnsOs:"carrier"==t.selectedSection?d.columnsSelected=d.columnsCarrier:"network(seller)"==t.selectedSection?d.columnsSelected=d.columnsNetworkSeller:"connection_type"==t.selectedSection?d.columnsSelected=d.columnsConnectionType:"device"==t.selectedSection&&(d.columnsSelected=d.columnsDevice),d.cpaBucketFirst={showBorders:!0,alignment:"left",bindingOptions:{dataSource:"campdetails.cpaBucketRequestFirst"},howBorders:!0,showRowLines:!0,paging:{enabled:!0,pageSize:10},remoteOperations:!1,allowColumnReordering:!0,allowColumnResizing:!0,columnAutoWidth:!0,pager:{showPageSizeSelector:!0,allowedPageSizes:[10,30,50],visible:!0,showNavigationButtons:!0},columns:d.columnsSelected,"export":{enabled:!0,fileName:"cpa_first"}},d.cpaBucketSecond={showBorders:!0,alignment:"left",bindingOptions:{dataSource:"campdetails.cpaBucketRequestSecond"},howBorders:!0,showRowLines:!0,paging:{enabled:!0,pageSize:10},remoteOperations:!1,allowColumnReordering:!0,allowColumnResizing:!0,columnAutoWidth:!0,pager:{showPageSizeSelector:!0,allowedPageSizes:[10,30,50],visible:!0,showNavigationButtons:!0},columns:d.columnsSelected,"export":{enabled:!0,fileName:"cpa_second"}},d.cpaBucketThird={showBorders:!0,alignment:"left",bindingOptions:{dataSource:"campdetails.cpaBucketRequestThird"},howBorders:!0,showRowLines:!0,paging:{enabled:!0,pageSize:10},remoteOperations:!1,allowColumnReordering:!0,allowColumnResizing:!0,columnAutoWidth:!0,pager:{showPageSizeSelector:!0,allowedPageSizes:[10,30,50],visible:!0,showNavigationButtons:!0},columns:d.columnsSelected,"export":{enabled:!0,fileName:"cpa_third"}},d.cpaBucketFourth={showBorders:!0,alignment:"left",bindingOptions:{dataSource:"campdetails.cpaBucketRequestFourth"},howBorders:!0,showRowLines:!0,paging:{enabled:!0,pageSize:10},remoteOperations:!1,allowColumnReordering:!0,allowColumnResizing:!0,columnAutoWidth:!0,pager:{showPageSizeSelector:!0,allowedPageSizes:[10,30,50],visible:!0,showNavigationButtons:!0},columns:d.columnsSelected,"export":{enabled:!0,fileName:"cpa_fourth"}}}a.$inject=["$window","$state","$localStorage","$translate","CampDetails","ChartDetails","CpaBucketsAll","Campaign"],angular.module("pjtLayout").controller("CampaignDetailsController",a)}(),function(){"use strict";function a(a,e,t){function i(a,e,i){return new t.DevExpress.data.CustomStore({totalCount:function(){return p},load:function(t){return t.searchOperation&&t.dataField&&(t.take=999999),n(a,e,i,t.skip,t.take,t.sort,t.order,t.filter,t.totalSummary)}})}function n(i,n,o,r,s,d,l,c,m){return d?(l=d[0].desc===!0?"desc":"asc",d=d[0].selector):(d="placement",l="DESC"),null==s&&(s=10),null==r&&(r=0),a({method:"GET",url:"/api/v1/campaigns/"+encodeURI(i)+"/domains",headers:{Authorization:"Token "+e.get("token")},params:{from_date:n,to_date:o,skip:r,take:s,sort:d,order:l,filter:c,totalSummary:m}}).then(function(a){for(var e in a.data.data){var t=[];if(-1==a.data.data[e].analitics.good||-2==a.data.data[e].analitics.good||-3==a.data.data[e].analitics.good)t=null;else{var i=a.data.data[e].analitics.bad,n=a.data.data[e].analitics.good,o=1,r=1,s=+(100*i/(i+n));(.5>=s/100&&s/100>.45||.5>=(100-s)/100&&(100-s)/100>.45)&&(o=.03,r=.03),(.45>s/100&&s/100>.4||.45>(100-s)/100&&(100-s)/100>.4)&&(o=.09,r=.09),(.4>s/100&&s/100>.3||.4>(100-s)/100&&(100-s)/100>.3)&&(o=.2,r=.2),(.3>s/100&&s/100>.2||.3>(100-s)/100&&(100-s)/100>.2)&&(o=.5,r=.5),(.2>s/100&&s/100>.1||.2>(100-s)/100&&(100-s)/100>.1)&&(o=.7,r=.7),(.1>s/100&&s/100>0||.1>(100-s)/100&&(100-s)/100>0)&&(o=1,r=1);var d=100-s+"%",l=s+"%";t={good:a.data.data[e].analitics.good,bad:a.data.data[e].analitics.bad,checked:a.data.data[e].analitics.checked,badDiagram:l,goodDiagram:d,badOpasity:o,goodOpasity:r,k:s}}a.data.data[e].cvr=parseFloat((a.data.data[e].cvr||0).toFixed(4)),a.data.data[e].ctr=parseFloat((a.data.data[e].ctr||0).toFixed(4)),a.data.data[e].cpc=parseFloat((a.data.data[e].cpc||0).toFixed(4)),a.data.data[e].cpm=parseFloat((a.data.data[e].cpm||0).toFixed(4)),a.data.data[e].imp=parseFloat((a.data.data[e].imp||0).toFixed(4)),a.data.data[e].cpa=parseFloat((a.data.data[e].cpa||0).toFixed(4)),a.data.data[e].clicks=parseFloat((a.data.data[e].clicks||0).toFixed(4)),a.data.data[e].conv=parseFloat((a.data.data[e].conv||0).toFixed(4)),a.data.data[e].cost=parseFloat((a.data.data[e].cost||0).toFixed(2)),a.data.data[e].analitics=t,a.data.data[e].imps_viewed=parseFloat((a.data.data[e].imps_viewed||0).toFixed(4)),a.data.data[e].view_measured_imps=parseFloat((a.data.data[e].view_measured_imps||0).toFixed(4)),a.data.data[e].view_measurement_rate=parseFloat((a.data.data[e].view_measurement_rate||0).toFixed(1)),a.data.data[e].view_rate=parseFloat((a.data.data[e].view_rate||0).toFixed(1)),a.data.data[e].state={blackList:2&a.data.data[e].state,suspended:1&a.data.data[e].state,whiteList:4&a.data.data[e].state}}return p=a.data.totalCount,u.totalSummary=a.data.totalSummary,a.data.data})["catch"](function(a){t.DevExpress.ui.notify(a.data.detail,"error",4e3)})}function o(a,e,t){return{domains:["about.com","celebritytoob.com","lotto.pch.com","verywell.com"],geo:["US","UK","NZ"],device:["Desktops & Laptops","AND","Web"],block:["Phones","Tablets","Mobile web","Apps"]}}function r(i,n,o,r){return a({method:"POST",url:"/api/v1/campaigns/"+encodeURI(i)+"/changestate",headers:{Authorization:"Token "+e.get("token")},data:{placement:n,activeState:o,suspendTimes:r}}).then(function(a){return a.data})["catch"](function(a){t.DevExpress.ui.notify(a.data.detail,"error",4e3)})}function s(i,n,o){return a({method:"POST",url:"/api/v1/campaigns/"+i+"/MLPlacement",headers:{Authorization:"Token "+e.get("token")},data:{placementId:n,checked:o}}).then(function(a){return a.data})["catch"](function(a){t.DevExpress.ui.notify(a.statusText,"error",4e3)})}function d(i,n){return a({method:"GET",url:"/api/v1/campaigns/"+i+"/MLPlacement",headers:{Authorization:"Token "+e.get("token")},params:{placementId:n}}).then(function(a){var e=[];for(var t in a.data.analitics)if(-1==a.data.analitics[t].good)e[t]=!1;else{"0"==a.data.analitics[t].day&&(a.data.analitics[t].day="Sunday"),"1"==a.data.analitics[t].day&&(a.data.analitics[t].day="Monday"),"2"==a.data.analitics[t].day&&(a.data.analitics[t].day="Tuesday"),"3"==a.data.analitics[t].day&&(a.data.analitics[t].day="Wednesday"),"4"==a.data.analitics[t].day&&(a.data.analitics[t].day="Thursday"),"5"==a.data.analitics[t].day&&(a.data.analitics[t].day="Friday"),"6"==a.data.analitics[t].day&&(a.data.analitics[t].day="Saturday"),"7"==a.data.analitics[t].day&&(a.data.analitics[t].day="All week");var i=a.data.analitics[t].bad,n=a.data.analitics[t].good,o=1,r=1,s=+(100*i/(i+n));(.5>=s/100&&s/100>=.45||.5>=(100-s)/100&&(100-s)/100>.45)&&(o=.03,r=.03),(.45>s/100&&s/100>.4||.45>=(100-s)/100&&(100-s)/100>.4)&&(o=.09,r=.09),(.4>=s/100&&s/100>.3||.4>=(100-s)/100&&(100-s)/100>.3)&&(o=.2,r=.2),(.3>=s/100&&s/100>.2||.3>=(100-s)/100&&(100-s)/100>.2)&&(o=.5,r=.5),(.2>=s/100&&s/100>.1||.2>=(100-s)/100&&(100-s)/100>.1)&&(o=.7,r=.7),(.1>=s/100&&s/100>0||.1>=(100-s)/100&&(100-s)/100>0)&&(o=1,r=1);var d=100-s+"%",l=s+"%";e.push({day:a.data.analitics[t].day,good:a.data.analitics[t].good,bad:a.data.analitics[t].bad,checked:a.data.analitics[t].checked,badDiagram:l,goodDiagram:d,badOpasity:o,goodOpasity:r,k:s})}return e})["catch"](function(a){t.DevExpress.ui.notify(a.statusText,"error",4e3)})}function l(i,n){return a({method:"POST",url:"/api/v1/campaigns/"+i+"/rules",headers:{Authorization:"Token "+e.get("token")},data:{ruleObj:n}}).then(function(a){return a.data})["catch"](function(a){t.DevExpress.ui.notify(a.statusText,"error",4e3)})}function c(i){return a({method:"GET",url:"/api/v1/campaigns/"+i+"/rules",headers:{Authorization:"Token "+e.get("token")}}).then(function(a){return[{id:"rule","if":[{id_rule:"NewRule1",type:"condition",target:"Placement/App",payment:"CPA",compare:">",value:0}],then:"Blacklist"}]})["catch"](function(a){return t.DevExpress.ui.notify(a.statusText,"error",4e3),[{id:"rule","if":[{id_rule:"NewRule1",type:"condition",target:"Placement/App",payment:"CPA",compare:">",value:0}],then:"Blacklist"}]})}var u=this,p=0;u.showAllMLDiagram=d,u.decisionML=s,u.saveRules=l,u.getRules=c,u.campaignTargeting=o,u.editCampaignDomains=r,u.getGridCampaignStore=i}a.$inject=["$http","$cookies","$window"],angular.module("pjtLayout").service("CampaignOptimiser",a)}(),function(){"use strict";function a(a,e,t,i,n,o,r,s){function d(){p.popUpIf=!1}function l(a,e){"Suspend for review"==e.then?(C=!0,S=a,p.confirmPopup.option("visible",!0)):delete e.time}function c(){s.saveRules(r.id,p.rulesArray)}function u(e,t){return e.dataSource.postProcess=function(e){var i=a._.uniqBy(e,t);return i.map(function(a){return{text:a[t],value:a[t]}})}}var p=this,m=n.instant,h=null,v={},C=!1,g="",S="";p.campName=r.campaign,p.campId=r.id,p.object=s.campaignTargeting(1,1,1),p.popUpIf=!1,p.arrayDiagram=[],p.saveRules=c,p.popUpHide=d,p.checkTime=l,s.getRules(r.id).then(function(a){a&&(p.rulesArray=a)}),p.addField=function(a){if(a.$parent.$parent.$parent.$parent.rule){var e=p.rulesArray.length+1;a.$parent.$parent.$parent.$parent.rule.push({id_logic:"NewRule"+e,type:"logic",logicOrAnd:!0},{id_rule:"NewRule"+e,type:"condition",target:"Placement/App",payment:"CPA",compare:">",value:0})}else{var e=p.rulesArray.length+1;a.$parent.$parent.rules["if"].push({id_logic:"NewRule"+e,type:"logic",logicOrAnd:!0},{id_rule:"NewRule"+e,type:"condition",target:"Placement/App",payment:"CPA",compare:">",value:0})}},p.addGroup=function(a,e){if(a.$parent.$parent.$parent.rule){var t=p.rulesArray.length+1;a.$parent.$parent.$parent.rule.push({id_logic:"NewRule"+t,type:"logic",logicOrAnd:!0},[{id_rule:"NewGroup"+t,type:"condition",target:"Placement/App",payment:"CPA",compare:">",value:0}])}else{var t=p.rulesArray.length+1;a.$parent.rules["if"].push({id_logic:"NewRule"+t,type:"logic",logicOrAnd:!0},[{id_rule:"NewGroup"+t,type:"condition",target:"Placement/App",payment:"CPA",compare:">",value:0}])}},p.addNewRule=function(){var a=p.rulesArray.length+1;p.rulesArray.push({id:"rule"+a,"if":[{id_rule:"NewRule"+a,type:"condition",target:"Placement/App",payment:"CPA",compare:">",value:0}],then:"Blacklist"})},p.deleteRule=function(a){p.rulesArray.splice(a,1)},p.deleteFilds=function(a,e){a.$parent.$parent.$parent.$parent.rule?a.$parent.$parent.$parent.$parent.rule.splice(e,2):a.$parent.$parent.rules["if"].splice(e,2)},p.typeOfLogic=function(a){return"logic"===a.type?!0:!1},p.typeOfThen=function(a){return"Blacklist"===a.then?!0:!1},p.typeOfObject=function(a){return"condition"==a.type?!0:!1},p.typeOfArray=function(a){return 1==Array.isArray(a)?!0:!1},null==t.SelectedTime?(t.SelectedTime=0,t.dataStart=a.moment({hour:"00"}).subtract(1,"day").unix(),t.dataEnd=a.moment({hour:"00"}).subtract(1,"day").endOf("day").unix(),p.dataStart=a.moment({hour:"00"}).subtract(1,"day").unix(),p.dataEnd=a.moment({hour:"00"}).subtract(1,"day").endOf("day").unix()):null==t.dataStart||null==t.dataEnd?(t.SelectedTime=0,t.dataStart=a.moment({hour:"00"}).subtract(1,"day").unix(),t.dataEnd=a.moment({hour:"00"}).subtract(1,"day").endOf("day").unix(),p.dataStart=a.moment({hour:"00"}).subtract(1,"day").unix(),p.dataEnd=a.moment({hour:"00"}).subtract(1,"day").endOf("day").unix()):(p.dataStart=t.dataStart,p.dataEnd=t.dataEnd);var A=[{ID:0,Name:m("MAIN.DATE_PICKER.YESTERDAY"),dataStart:a.moment({hour:"00"}).subtract(1,"day").unix(),dataEnd:a.moment({hour:"00"}).subtract(1,"day").endOf("day").unix()},{ID:1,Name:m("MAIN.DATE_PICKER.LAST_3_DAYS"),dataStart:a.moment({hour:"00"}).subtract(3,"day").unix(),dataEnd:a.moment({hour:"00"}).unix()},{ID:2,Name:m("MAIN.DATE_PICKER.LAST_7_DAYS"),dataStart:a.moment({hour:"00"}).subtract(7,"day").unix(),dataEnd:a.moment({hour:"00"}).unix()},{ID:3,Name:m("MAIN.DATE_PICKER.LAST_14_DAYS"),dataStart:a.moment({hour:"00"}).subtract(14,"day").unix(),dataEnd:a.moment({hour:"00"}).unix()},{ID:4,Name:m("MAIN.DATE_PICKER.LAST_21_DAYS"),dataStart:a.moment({hour:"00"}).subtract(21,"day").unix(),dataEnd:a.moment({hour:"00"}).unix()},{ID:5,Name:m("MAIN.DATE_PICKER.CURRENT_MONTH"),dataStart:a.moment().startOf("month").unix(),dataEnd:a.moment().unix()},{ID:6,Name:m("MAIN.DATE_PICKER.LAST_MONTH"),dataStart:a.moment().subtract(1,"month").startOf("month").unix(),dataEnd:a.moment().subtract(1,"month").endOf("month").unix()},{ID:7,Name:m("MAIN.DATE_PICKER.LAST_90_DAYS"),dataStart:a.moment({hour:"00"}).subtract(90,"day").unix(),dataEnd:a.moment().unix()},{ID:8,Name:m("MAIN.DATE_PICKER.ALL_TIME"),dataStart:0,dataEnd:a.moment().unix()}];p.selectedItems=[],p.state="",p.gridStore=s.getGridCampaignStore(p.campId,p.dataStart,p.dataEnd);var f=(new Date(1981,3,27),new Date);p.UI={showGridWhiteList:{text:m("CO.WHITELIST"),onClick:function(a){p.grindIf=1,i.$apply()}},showGridBlackList:{text:m("CO.BLACKLISTED"),onClick:function(a){p.grindIf=2,i.$apply()}},showGridTempSuspendList:{text:m("CO.TEMP-SUSPEND"),onClick:function(a){p.grindIf=3,i.$apply()}},dateFormatPop:{disabled:!0,type:"date",value:f,onValueChanged:function(a){h=a.value}},radioGroupMain:{items:[m("CO.24-HRS"),m("CO.3-DAYS"),m("CO.7-DAYS"),m("CO.SPECIFIC-DATE")],value:m("CO.24-HRS"),onValueChanged:function(a){var e=$("#radioGroupSend").dxRadioGroup("instance");if(a.value)if(e.option("value",!1),a.value==m("CO.SPECIFIC-DATE")){var t=$("#dateFormatPop").dxDateBox("instance");t.option("disabled",!1)}else{var t=$("#dateFormatPop").dxDateBox("instance");t.option("disabled",!0),h=null}}},radioGroupSend:{items:[m("CO.SEND-TO-SUSPEND-LIST")],onValueChanged:function(a){h=null;var e=$("#dateFormatPop").dxDateBox("instance");e.option("disabled",!0);var t=$("#radioGroupMain").dxRadioGroup("instance");a.value&&t.option("value",!1)}},confirmPopup:{onInitialized:function(a){p.confirmPopup=a.component},bindingOptions:{visible:"crc.confirmPopupVisible"},showTitle:!1,width:320,height:300},confirmPopupOk:{width:110,text:"OK",disabled:!1,onClick:function(){if(1==C){var e=$("#radioGroupMain").dxRadioGroup("instance"),t=$("#radioGroupSend").dxRadioGroup("instance");return e._options.value!==!1&&(e._options.value==m("CO.24-HRS")&&(g=a.moment().add(1,"day").unix()),e._options.value==m("CO.3-DAYS")&&(g=a.moment().add(3,"day").unix()),e._options.value==m("CO.7-DAYS")&&(g=a.moment().add(7,"day").unix())),t._options.value!==!1&&(g="unlimited"),null!==h&&(g=a.moment(h).unix()),null==t._options.value&&e._options.value==m("CO.24-HRS")&&(g=a.moment().add(1,"day").unix()),p.rulesArray[S].time=g,C=!1,p.confirmPopupVisible=!1,p.confirmPopup.option("visible",!1),i.$apply(),0}var n,e=$("#radioGroupMain").dxRadioGroup("instance"),t=$("#radioGroupSend").dxRadioGroup("instance");e._options.value!==!1&&(e._options.value==m("CO.24-HRS")&&(n=a.moment().add(1,"day").unix()),e._options.value==m("CO.3-DAYS")&&(n=a.moment().add(3,"day").unix()),e._options.value==m("CO.7-DAYS")&&(n=a.moment().add(7,"day").unix())),t._options.value!==!1&&(n="unlimited"),null!==h&&(n=a.moment(h).unix()),null==t._options.value&&e._options.value==m("CO.24-HRS")&&(n=a.moment().add(1,"day").unix()),s.editCampaignDomains(p.campId,v.placement,1,n).then(function(){for(var e=0;e<v.placement.length;e++)a.$("div.state-black"+v.placement[e]).removeClass("active"),a.$("div.state-white"+v.placement[e]).removeClass("active"),a.$("div.state-suspended"+v.placement[e]).addClass("active")}),p.confirmPopupVisible=!1,p.confirmPopup.option("visible",!1),i.$apply()}},confirmPopupCancel:{width:120,text:m("COMMON.CANCEL"),onClick:function(){p.confirmPopup.option("visible",!1),i.$apply()}},navCamp:{text:m("CO.CAMPAIGN-HOME"),onClick:function(){e.go("home.campaign.details",{id:p.campId})}},datePiker:{items:A,displayExpr:"Name",valueExpr:"ID",value:A[t.SelectedTime].ID,onValueChanged:function(a){t.SelectedTime=a.value,t.dataStart=A[a.value].dataStart,t.dataEnd=A[a.value].dataEnd,e.reload()}},dataGridOptionsCampaign:{editing:{mode:"batch",allowUpdating:!0},alignment:"left",headerFilter:{visible:!0},filterRow:{visible:!0,applyFilter:"auto"},bindingOptions:{dataSource:"CO.gridStore"},paging:{pageSize:10},remoteOperations:!0,pager:{showPageSizeSelector:!0,allowedPageSizes:[10,30,50],visible:!0,showNavigationButtons:!0},allowColumnReordering:!0,allowColumnResizing:!0,columnAutoWidth:!0,wordWrapEnabled:!0,showBorders:!0,showRowLines:!0,columns:[{caption:m("CAMP.CAMPAIGN.COLUMNS.PLACEMENT"),dataField:"placement",alignment:"center",dataType:"number",allowEditing:!1,headerFilter:{dataSource:function(a){return u(a,"placement")}}},{caption:m("CAMP.CAMPAIGN.COLUMNS.NETWORK"),dataField:"NetworkPublisher",alignment:"center",dataType:"string",allowEditing:!1,headerFilter:{dataSource:function(a){return u(a,"NetworkPublisher")}}},{caption:m("CAMP.CAMPAIGN.COLUMNS.CONV"),dataField:"conv",alignment:"center",dataType:"number",allowEditing:!1,headerFilter:{dataSource:function(a){return u(a,"conv")}}},{caption:m("CAMP.CAMPAIGN.COLUMNS.IMP"),dataField:"imp",dataType:"number",sortOrder:"desc",alignment:"center",allowEditing:!1,headerFilter:{dataSource:function(a){return u(a,"imp")}}},{caption:m("CAMP.CAMPAIGN.COLUMNS.CPA")+" ,$",dataField:"cpa",dataType:"number",alignment:"center",allowEditing:!1,headerFilter:{dataSource:function(a){return u(a,"cpa")}}},{caption:m("CAMP.CAMPAIGN.COLUMNS.COST")+" ,$",dataField:"cost",alignment:"center",dataType:"number",allowEditing:!1,headerFilter:{dataSource:function(a){return u(a,"cost")}}},{caption:m("CAMP.CAMPAIGN.COLUMNS.CLICKS"),dataField:"clicks",alignment:"center",dataType:"number",allowEditing:!1,headerFilter:{dataSource:function(a){return u(a,"clicks")}}},{caption:m("CAMP.CAMPAIGN.COLUMNS.CPC")+" ,$",dataField:"cpc",alignment:"center",dataType:"number",allowEditing:!1,headerFilter:{dataSource:function(a){return u(a,"cpc")}}},{caption:m("CAMP.CAMPAIGN.COLUMNS.CPM")+" ,$",dataField:"cpm",alignment:"center",dataType:"number",allowEditing:!1,headerFilter:{dataSource:function(a){return u(a,"cpm")}}},{caption:m("CAMP.CAMPAIGN.COLUMNS.CVR")+" ,%",dataField:"cvr",alignment:"center",dataType:"number",allowEditing:!1,headerFilter:{dataSource:function(a){return u(a,"cvr")}}},{caption:m("CAMP.CAMPAIGN.COLUMNS.CTR")+" ,%",dataField:"ctr",alignment:"center",dataType:"number",allowEditing:!1,headerFilter:{dataSource:function(a){return u(a,"ctr")}}},{caption:m("CAMP.CAMPAIGN.COLUMNS.IMPS_VIEWED"),dataField:"imps_viewed",alignment:"center",visible:!1,width:80,dataType:"number",allowEditing:!1,headerFilter:{dataSource:function(a){return u(a,"imps_viewed")}}},{caption:m("CAMP.CAMPAIGN.COLUMNS.VIEW_MEASURED_IMPS"),dataField:"view_measured_imps",alignment:"center",visible:!1,width:100,dataType:"number",headerFilter:{dataSource:function(a){return u(a,"view_measured_imps")}}},{caption:m("CAMP.CAMPAIGN.COLUMNS.VIEW_MEASUREMENT_RATE")+" ,%",dataField:"view_measurement_rate",alignment:"center",visible:!1,width:120,dataType:"number",headerFilter:{dataSource:function(a){return u(a,"view_measurement_rate")}}},{caption:m("CAMP.CAMPAIGN.COLUMNS.VIEW_RATE")+" ,%",dataField:"view_rate",alignment:"center",visible:!1,width:80,dataType:"number",headerFilter:{dataSource:function(a){return u(a,"view_rate")}}},{caption:"Prediction 1",width:115,columnIndex:16,dataField:"analytics",allowEditing:!1,cellTemplate:function(e,t){if(p.arrayDiagram.push(t.data),null===t.data.analitics);else{var n=(t.data.analitics.bad,t.data.analitics.good,t.data.analitics.badOpasity),r=t.data.analitics.goodOpasity,d=t.data.analitics.k,l=t.data.analitics.goodDiagram,c=t.data.analitics.badDiagram,u=o('<div class="analiticCO"><div class="diagramCO" ng-click="CO.showAllDiagram('+t.data.placement+')"><div class="badDiagramCO" style="width:'+c+";opacity:"+n+';"></div><div class="goodDiagramCO" style="width:'+l+";opacity:"+r+';"></div><p class="textBadDiagramCO" >'+d.toFixed(1)+'%</p><p class="textGoodDiagramCO">'+(100-d).toFixed(1)+'%</p></div><div class="buttonAnaliticCO'+t.data.placement+'"><div class="trueButtonAnaliticCO'+t.data.placement+'"></div><div class="falseButtonAnaliticCO'+t.data.placement+'"></div></div></div>;')(i);u.appendTo(e);var m=a.$(".trueButtonAnaliticCO"+t.data.placement).dxButton({text:"True",disabled:!1,onClick:function(){a.$(".falseButtonAnaliticCO"+t.data.placement).removeClass("active-white"),a.$(".trueButtonAnaliticCO"+t.data.placement).addClass("active-white"),s.decisionML(p.campId,t.data.placement,!0).then(function(a){return a})}}),h=a.$(".falseButtonAnaliticCO"+t.data.placement).dxButton({text:"False",disabled:!1,onClick:function(){a.$(".falseButtonAnaliticCO"+t.data.placement).addClass("active-white"),a.$(".trueButtonAnaliticCO"+t.data.placement).removeClass("active-white"),s.decisionML(p.campId,t.data.placement,!1).then(function(a){return a})}});1==t.data.analitics.checked?m.addClass("active-white").append():m.append(),0==t.data.analitics.checked?h.addClass("active-white").append():h.append(),p.showAllDiagram=function(a){p.popUpIf=!0,s.showAllMLDiagram(p.campId,a).then(function(a){p.arraytoPopup=a})}}}},{caption:"State",width:300,columnIndex:16,dataField:"state",allowEditing:!1,headerFilter:{dataSource:[{text:"White",value:["state","=",4]},{text:"Black",value:["state","=",2]},{text:"Suspended",value:["state","=",1]}]},cellTemplate:function(e,t){var i=a.$("<div />").dxButton({text:"white",height:30,width:89,disabled:!1,onClick:function(e){s.editCampaignDomains(p.campId,[t.data.placement],4).then(function(e){return a.$("div.state-white"+t.data.placement).addClass("active"),a.$("div.state-black"+t.data.placement).removeClass("active"),a.$("div.state-suspended"+t.data.placement).removeClass("active"),e})["catch"](function(a){return a})}});4==t.data.state.whiteList?i.addClass("state-white"+t.data.placement).addClass("active").appendTo(e):i.addClass("state-white"+t.data.placement).appendTo(e);var n=a.$("<div />").dxButton({text:"black",height:30,width:89,disabled:!1,onClick:function(e){s.editCampaignDomains(p.campId,[t.data.placement],2).then(function(e){return a.$("div.state-black"+t.data.placement).addClass("active"),a.$("div.state-white"+t.data.placement).removeClass("active"),a.$("div.state-suspended"+t.data.placement).removeClass("active"),e})["catch"](function(a){return a})}});2==t.data.state.blackList?n.addClass("state-black"+t.data.placement).addClass("active").appendTo(e):n.addClass("state-black"+t.data.placement).appendTo(e);var o=a.$("<div />").dxButton({text:"suspend",height:30,width:95,disabled:!1,onClick:function(){v.placement=[t.data.placement],v.suspend=1,p.confirmPopup.option("visible",!0)}});1==t.data.state.suspended?o.addClass("state-suspended"+t.data.placement).addClass("active").appendTo(e):o.addClass("state-suspended"+t.data.placement).appendTo(e)}}],summary:{totalItems:[{column:"placement",summaryType:"count",customizeText:function(a){return a.valueText="Count: "+p.dataGridOptionsMultipleFunc.totalCount(),a.valueText}},{column:"conv",summaryType:"sum",customizeText:function(a){return a.valueText="Conv: "+s.totalSummary.conv,a.valueText}},{column:"imp",summaryType:"sum",customizeText:function(a){return a.valueText="Imp: "+s.totalSummary.imp,a.valueText}},{column:"cpa",summaryType:"sum",valueFormat:"currency",customizeText:function(a){return a.valueText="CPA: $"+s.totalSummary.cpa.toFixed(4),a.valueText}},{column:"cost",summaryType:"sum",valueFormat:"currency",customizeText:function(a){return a.valueText="Cost: $"+s.totalSummary.cost.toFixed(2),a.valueText}},{column:"clicks",summaryType:"sum",customizeText:function(a){return a.valueText="Clicks: "+s.totalSummary.clicks,a.valueText}},{column:"cpc",summaryType:"sum",customizeText:function(a){return a.valueText="CPC: $"+s.totalSummary.cpc.toFixed(4),a.valueText}},{column:"cpm",summaryType:"sum",customizeText:function(a){return a.valueText="CPM: $"+s.totalSummary.cpm.toFixed(4),a.valueText}},{column:"cvr",summaryType:"sum",customizeText:function(a){return a.valueText="CVR: "+s.totalSummary.cvr.toFixed(4),a.valueText}},{column:"ctr",summaryType:"sum",customizeText:function(a){return a.valueText="CTR: "+s.totalSummary.ctr.toFixed(4),a.valueText}}]},columnChooser:{enabled:!0,height:180,width:400,emptyPanelText:"A place to hide the columns"},selection:{mode:"multiple",allowSelectAll:!1,showCheckBoxesMode:"always"},onInitialized:function(a){p.dataGridOptionsMultipleFunc=a.component,
p.dataGridOptionsMultipleFunc._controllers.columns._commandColumns[1].visibleIndex=9,p.dataGridOptionsMultipleFunc._controllers.columns._commandColumns[1].width=35},onEditorPreparing:function(e){"filterRow"==e.parentType&&"State"==e.caption&&(e.editorElement.dxSelectBox({dataSource:[{name:"White List",state:4},{name:"Black List",state:2},{name:"Suspended",state:1}],placeholder:"Select a state",displayExpr:"name",valueExpr:p.state,onSelectionChanged:function(e){var t=a.$(".gridContainerWhite")[0].querySelectorAll('[aria-selected="true"]');if(t[0]){for(var i=[],n=0;n<t.length;n++)i.push(t[n].firstChild.innerText);1==e.selectedItem.state?"[]"!=i&&(v.placement=i,v.suspend="suspend",p.confirmPopupVisible=!0,p.confirmPopup.option("visible",!0)):"[]"!=i&&s.editCampaignDomains(p.campId,i,e.selectedItem.state).then(function(a){$(".gridContainerWhite").dxDataGrid("instance").refresh()})["catch"](function(){$(".gridContainerWhite").dxDataGrid("instance").refresh()})}else a.DevExpress.ui.notify(m("CO.NO-ITEMS-CHOSEN"),"warning",4e3)}}),e.cancel=!0)},onSelectionChanged:function(a){p.selectedItems=a.selectedRowsData,p.disabled=!p.selectedItems.length}}}}a.$inject=["$window","$state","$localStorage","$scope","$translate","$compile","Campaign","CampaignOptimiser"],angular.module("pjtLayout").controller("CampaignOptimiserController",a)}(),function(){"use strict";function a(){}angular.module("pjtLayout").controller("CampaignController",a)}(),function(){"use strict";function a(a,e,t){function i(){return a({method:"GET",headers:{Authorization:"Token "+e.get("token")},url:"/api/v1/advertisers"}).then(function(a){return a.data})["catch"](function(a){t.DevExpress.ui.notify(a.statusText,"error",4e3)})}function n(){return new t.DevExpress.data.CustomStore({totalCount:function(){return s},load:function(){return i()}})}function o(e){return a({method:"POST",url:"/api/v1/login/",data:{email:e.email,password:e.password}}).then(function(a){return a})["catch"](function(a){t.DevExpress.ui.notify(a.statusText,"error",4e3)})}var r=this,s=0;r.authorization=o,r.selectAdvertisersStore=n}a.$inject=["$http","$cookies","$window"],angular.module("pjtLayout").service("Auth",a)}(),function(){"use strict";function a(a,e,t,i,n,o){var r=this,s=i.instant;!o.get("token")||"adminfull"!=o.get("permission")&&"adminread"!=o.get("permission")||(a.$(".reg-form-wrapper")[0].classList.add("hide"),a.$(".advertiser-wrapper")[0].classList.add("show"),a.$(".admin-btn")[0].classList.add("show"),a.$(".admin-btn")[1].classList.add("show")),!o.get("token")||"userfull"!=o.get("permission")&&"userread"!=o.get("permission")||(a.$(".reg-form-wrapper")[0].classList.add("hide"),a.$(".advertiser-wrapper")[0].classList.add("show"),a.$(".admin-btn")[0].classList.remove("show"),a.$(".admin-btn")[1].classList.add("show")),r.selectAdvertisersStore=n.selectAdvertisersStore(),r.submitForm=function(e){return void 0!=e&&void 0!=e.email&&void 0!=e.password?(o.remove("permission"),o.remove("token"),n.authorization(e).then(function(e){200==e.status?(t.$reset(),o.put("token",e.data.token),o.put("permission",e.data.permission),!e.data.token||"adminfull"!=e.data.permission&&"adminread"!=e.data.permission||(a.$(".reg-form-wrapper")[0].classList.add("hide"),a.$(".advertiser-wrapper")[0].classList.add("show"),a.$(".admin-btn")[0].classList.add("show"),a.$(".admin-btn")[1].classList.add("show")),!e.data.token||"userfull"!=e.data.permission&&"userread"!=e.data.permission||(a.$(".reg-form-wrapper")[0].classList.add("hide"),a.$(".advertiser-wrapper")[0].classList.add("show"),a.$(".admin-btn")[0].classList.remove("show"),a.$(".admin-btn")[1].classList.add("show"))):(o.remove("permission"),o.remove("token"))})):void a.DevExpress.ui.notify(s("AUTH.EMAIL-OR-PASSWORD-EMPTY"),"error",4e3)},r.goToAdminPanel=function(){e.go("admin")},r.logout=function(){o.remove("permission"),o.remove("token"),e.reload()},r.UI={addButton:{text:s("AUTH.GO_BUTTON"),onClick:function(){t.advertiser=r.selectedService,e.go("home.main")}},selectAdvertisers:{bindingOptions:{dataSource:"auth.selectAdvertisersStore",value:"auth.selectedService"},displayExpr:"name",width:"200px"}}}a.$inject=["$window","$state","$localStorage","$translate","Auth","$cookies"],angular.module("pjtLayout").controller("AuthController",a)}(),function(){"use strict";function a(a,e,t){function i(){return new t.DevExpress.data.CustomStore({totalCount:function(){return c},load:function(){return n()}})}function n(){return a({method:"GET",headers:{Authorization:"Token "+e.get("token")},url:"/api/v1/appnexus/user"}).then(function(a){return a.data})["catch"](function(a){t.DevExpress.ui.notify(a.data.detail,"error",4e3)})}function o(){return new t.DevExpress.data.CustomStore({totalCount:function(){return 0},load:function(){return r().then(function(a){return a})},remove:function(a){return s(a.id)}})}function r(){return a({method:"GET",headers:{Authorization:"Token "+e.get("token")},url:"/api/v1/user/"}).then(function(a){return a.data})["catch"](function(a){t.DevExpress.ui.notify(a.data.detail,"error",4e3)})}function s(i){return a({method:"DELETE",url:"/api/v1/user/"+i,headers:{Authorization:"Token "+e.get("token")}}).then(function(a){return a.data})["catch"](function(a){t.DevExpress.ui.notify(a.data.detail,"error",4e3)})}function d(i){return a({method:"POST",url:"/api/v1/user/",headers:{Authorization:"Token "+e.get("token")},data:i}).then(function(a){return a.data})["catch"](function(a){t.DevExpress.ui.notify(a.data.detail,"error",4e3)})}var l=this,c=0;l.selectNexusUsersStore=i,l.usersStore=o,l.addUser=d}a.$inject=["$http","$cookies","$window"],angular.module("pjtLayout").service("AdminService",a)}(),function(){"use strict";function a(a,e,t,i){var n=this,o=t.instant;n.goToMainPage=function(){e.go("auth")},n.submitForm=function(e){return n.selectedService?(e.apnexus_user=n.selectedService.id,e.apnexusname=n.selectedService.username):(e.apnexus_user=null,e.apnexusname=null),("adminfull"==e.permission||"adminread"==e.permission)&&(e.apnexus_user=null),e.username=e.email,i.addUser(e).then(function(){n.user={},n.userForm.$setPristine(),a.$("#usersList").dxDataGrid("instance").refresh()})},n.usersStore=i.usersStore(),n.selectNexusUsersStore=i.selectNexusUsersStore(),n.UI={listOfUsers:{remoteOperations:!1,showBorders:!0,alignment:"left",bindingOptions:{dataSource:"admin.usersStore"},headerFilter:{visible:!0},filterRow:{visible:!0,applyFilter:"auto"},pager:{showPageSizeSelector:!0,allowedPageSizes:[10,30,50],visible:!0,showNavigationButtons:!0},allowColumnReordering:!0,allowColumnResizing:!0,columnAutoWidth:!0,wordWrapEnabled:!0,howBorders:!0,showRowLines:!0,align:"left",editing:{allowDeleting:!0},columns:[{caption:"id",dataField:"id",alignment:"center"},{caption:o("ADMIN.LIST-USER.EMAIL"),dataField:"email",alignment:"center"},{caption:o("ADMIN.LIST-USER.FIRST-NAME"),dataField:"first_name",alignment:"center"},{caption:o("ADMIN.LIST-USER.LAST-NAME"),dataField:"last_name",alignment:"center"},{caption:o("ADMIN.LIST-USER.APNEXUS-ID"),dataField:"apnexusname",alignment:"center"},{caption:o("ADMIN.LIST-USER.APNEXUS-NAME"),dataField:"apnexus_user",alignment:"center"},{caption:o("ADMIN.LIST-USER.PERMISSION"),dataField:"permission",alignment:"center"}]},selectAppNexusUser:{bindingOptions:{dataSource:"admin.selectNexusUsersStore",value:"admin.selectedService"},placeholder:o("ADMIN.ANU.SELECT-NEXUS-USER"),displayExpr:"username"}}}a.$inject=["$window","$state","$translate","AdminService"],angular.module("pjtLayout").controller("AdminController",a)}(),function(){"use strict";function a(a,e,t,i,n,o,r,s){i.$state=e,i.$stateParams=n;var d=i.$on("$stateChangeStart",function(a,e){"auth"!=e.name&&(s.get("token")||s.get("permission")||(o.$reset(),r.location="/")),"admin"==e.name&&("userfull"==s.get("permission")||"userread"==s.get("permission"))&&(o.$reset(),r.location="/")});i.$on("$destroy",d),a.debug("runBlock end")}a.$inject=["$log","$state","$http","$rootScope","$stateParams","$localStorage","$window","$cookies"],angular.module("pjtLayout").run(a)}(),function(){"use strict";function a(a,e){a.state("auth",{url:"/",templateUrl:"app/auth/auth.html",controller:"AuthController",controllerAs:"auth"}).state("home",{url:"/home",templateUrl:"app/home/home.html",controller:"HomeController",controllerAs:"home"}).state("home.main",{url:"/main",templateUrl:"app/main/main.html",controller:"MainController",controllerAs:"main"}).state("home.campaign",{templateUrl:"app/campaign/camp.html","abstract":!0}).state("home.campaign.details",{url:"/campaign/:id",views:{details:{templateUrl:"app/campaignmain/campmain.html",controller:"CampaignMainController",controllerAs:"campmain",resolve:{Campaign:["CampMain","$stateParams","$state",function(a,e,t){return e.id||t.go("home.main"),a.nameCampaigns(e.id).then(function(a){return a})}]}},info:{templateUrl:"app/campaigndetails/campdetails.html",controller:"CampaignDetailsController",controllerAs:"campdetails",resolve:{Campaign:["CampMain","$stateParams","$state",function(a,e,t){return e.id||t.go("home.main"),a.nameCampaigns(e.id).then(function(a){return a})}],ChartDetails:["CampDetails","$stateParams","$state","$localStorage",function(a,e,t,i){return e.id||t.go("home.main"),a.detailsStoreAll(e.id,i.dataStart,i.dataEnd,i.selectedSection).then(function(a){return a})["catch"](function(a){return a})}],CpaBucketsAll:["CampDetails","$stateParams","$state","$localStorage",function(a,e,t,i){return e.id||t.go("home.main"),a.bucketsCpa(e.id,i.dataStart,i.dataEnd,i.selectedSection).then(function(a){return a})["catch"](function(a){return a})}]}}}}).state("home.campaignOptimiser",{url:"/campaignOptimiser/:id",templateUrl:"app/campaignOptimiser/campaignOptimiser.html",controller:"CampaignOptimiserController",controllerAs:"CO",resolve:{Campaign:["CampMain","$stateParams","$state",function(a,e,t){return e.id||t.go("home.main"),a.nameCampaigns(e.id).then(function(a){return a})}]}}).state("home.valuationByExpert",{url:"/valuationByExpert/",templateUrl:"app/valuationByExpert/valuationByExpert.html",controller:"valuationByExpertController",controllerAs:"VBE"}).state("admin",{url:"/admin/",templateUrl:"app/admin/admin.html",controller:"AdminController",controllerAs:"admin"}),e.otherwise("/")}a.$inject=["$stateProvider","$urlRouterProvider"],angular.module("pjtLayout").config(a)}(),function(){"use strict";angular.module("pjtLayout")}(),function(){"use strict";function a(a,e,t,i,n){a.debugEnabled(!0),t.translations("en",n),t.translations("ru",i),t.useSanitizeValueStrategy("escape"),t.preferredLanguage("ru"),t.useLocalStorage(),t.storageKey("TRANSLATE_LANG_KEY"),e.allowHtml=!0,e.timeOut=3e3,e.positionClass="toast-top-right",e.preventDuplicates=!0,e.progressBar=!0}a.$inject=["$logProvider","toastrConfig","$translateProvider","RussianTranslations","EnglishTranslations"],angular.module("pjtLayout").config(a)}(),angular.module("pjtLayout").run(["$templateCache",function(a){a.put("app/admin/admin.html",'<div class=admin><div class=location><div class=location-language><a ng-click="root.changeLang(\'ru\')"><i class="fa fa-globe fa-fw"></i> Русский </a>/ <a ng-click="root.changeLang(\'en\')"><i class="fa fa-globe fa-fw"></i> English</a></div><input type=button class="btn btn-danger admin-btn" ng-click=root.logout() value="{{ \'COMMON.LOGOUT\' | translate }}"> <input type=button class="btn btn-primary admin-btn" ng-click=admin.goToMainPage() value="{{ \'COMMON.TO-MAIN-PAGE\' | translate }}"></div><div class=row><div class="col-lg-3 col-md-3 col-sm-12 form-add-user"><h3>{{ \'ADMIN.ANU.ADD-NEW-USER\' | translate }}</h3><form name=admin.userForm ng-submit=admin.submitForm(admin.user) novalidate><div class=form-group ng-class="{ \'has-error\' : admin.userForm.email.$invalid && !admin.userForm.email.$pristine }"><input type=email name=email class="form-control input-item-login" placeholder="{{ \'ADMIN.ANU.EMAIL\' | translate }}" ng-model=admin.user.email required><p ng-show="admin.userForm.email.$invalid && !admin.userForm.email.$pristine && admin.userForm.email.$error.required" class=help-block>{{ \'ADMIN.ANU.MAIL-REQUIRED\' | translate }}</p><p ng-show="!admin.userForm.email.$error.required && admin.userForm.email.$invalid && !admin.userForm.email.$pristine" class=help-block>{{ \'ADMIN.ANU.MAIL-VALID\' | translate }}</p></div><div class=form-group ng-class="{ \'has-error\' : admin.userForm.password.$invalid && !admin.userForm.password.$pristine }"><input type=password class=form-control name=password ng-model=admin.user.password placeholder="{{ \'ADMIN.ANU.PASSWORD\' | translate }}" required><p ng-show="admin.userForm.password.$invalid && !admin.userForm.password.$pristine && admin.userForm.password.$error.required" class=help-block>{{ \'ADMIN.ANU.PASSWORD-REQUIRED\' | translate }}</p></div><div class=form-group ng-class="{ \'has-error\' : (admin.userForm.passwordconfirm.$invalid && !admin.userForm.passwordconfirm.$pristine) || ((admin.user.passwordconfirm !== admin.user.password) && !auth.userForm.password.$pristine)}"><input type=password class=form-control name=passwordconfirm ng-model=admin.user.passwordconfirm required placeholder="{{ \'ADMIN.ANU.CONFIRM-PASSWORD\' | translate }}"><p ng-show="!admin.userForm.passwordconfirm.$error.required && (admin.user.passwordconfirm !== admin.user.password) && !admin.userForm.passwordconfirm.$pristine" class=help-block>{{ \'ADMIN.ANU.CONFIRM-PASSWORD-INCORRECT\' | translate }}</p><p ng-show="admin.userForm.passwordconfirm.$invalid && !admin.userForm.passwordconfirm.$pristine && admin.userForm.passwordconfirm.$error.required" class=help-block>{{ \'ADMIN.ANU.CONFIRM-PASSWORD-REQUIRED\' | translate }}</p></div><div class=form-group ng-class="{ \'has-error\' : admin.userForm.first_name.$invalid && !admin.userForm.first_name.$pristine }"><input type=text name=first_name class="form-control input-item-login" placeholder="{{ \'ADMIN.ANU.FIRST-NAME\' | translate }}" ng-model=admin.user.first_name required><p ng-show="admin.userForm.first_name.$invalid && !admin.userForm.first_name.$pristine && admin.userForm.first_name.$error.required" class=help-block>{{ \'ADMIN.ANU.FIRST-NAME-REQUIRED\' | translate }}</p></div><div class=form-group ng-class="{ \'has-error\' : admin.userForm.last_name.$invalid && !admin.userForm.last_name.$pristine }"><input type=text name=last_name class="form-control input-item-login" placeholder="{{ \'ADMIN.ANU.LAST-NAME\' | translate }}" ng-model=admin.user.last_name required><p ng-show="admin.userForm.last_name.$invalid && !admin.userForm.last_name.$pristine && admin.userForm.last_name.$error.required" class=help-block>{{ \'ADMIN.ANU.LAST-NAME-REQUIRED\' | translate }}</p></div><div class=form-group><select ng-model=admin.user.permission name=permission class="select-user-type form-control" title=user><option value="" disabled selected>{{ \'ADMIN.ANU.SELECT-PERMISSION\' | translate }}</option><option value=adminfull>admin full</option><option value=adminread>admin read-only</option><option value=userfull>user full</option><option value=userread>user read-only</option></select></div><div ng-show="admin.user.permission==\'userfull\' || admin.user.permission==\'userread\'" class=form-group><div dx-select-box=admin.UI.selectAppNexusUser></div></div><button type=submit class="btn btn-primary" ng-disabled=admin.userForm.$invalid>{{ \'ADMIN.ANU.SUBMIT\' | translate }}</button></form></div><div class="col-lg-9 col-md-9 col-sm-12"><h3>{{ \'ADMIN.LIST-USER.TITLE\' | translate }}</h3><div dx-data-grid=admin.UI.listOfUsers id=usersList></div></div></div></div>'),a.put("app/auth/auth.html",'<div class=location><div class=location-language><a ng-click="root.changeLang(\'ru\')"><i class="fa fa-globe fa-fw"></i> Русский </a>/ <a ng-click="root.changeLang(\'en\')"><i class="fa fa-globe fa-fw"></i> English</a></div><input type=button class="btn btn-primary admin-btn hide" ng-click=auth.goToAdminPanel() value="{{ \'COMMON.GO-TO-ADMIN-PANEL\' | translate }}"> <input type=button class="btn btn-danger admin-btn hide" ng-click=auth.logout() value="{{ \'COMMON.LOGOUT\' | translate }}"></div><div class="authorization container"><div class=row><div class="Absolute-Center is-Responsive reg-form-wrapper"><form name=auth.userForm ng-submit=auth.submitForm(auth.user) novalidate><div class=col-sm-10><div class=form-group ng-class="{ \'has-error\' : auth.userForm.email.$invalid && !auth.userForm.email.$pristine }"><i class="fa fa-user fa-2x icon-for-user"></i> <input type=email name=email class="form-control input-item-login" placeholder="{{ \'AUTH.MAIL-PLACEHOLDER\' | translate }}" ng-model=auth.user.email required><p ng-show="auth.userForm.email.$invalid && !auth.userForm.email.$pristine && auth.userForm.email.$error.required" class=help-block>{{ \'AUTH.MAIL-REQUIRED\' | translate }}</p><p ng-show="!auth.userForm.email.$error.required && auth.userForm.email.$invalid && !auth.userForm.email.$pristine" class=help-block>{{ \'AUTH.MAIL-VALID\' | translate }}</p></div></div><div class=col-sm-10><div class=form-group ng-class="{ \'has-error\' : auth.userForm.password.$invalid && !auth.userForm.password.$pristine }"><i class="fa fa-unlock fa-2x icon-for-user"></i> <input type=password name=password class="input-item-password form-control input-item-password" ng-model=auth.user.password placeholder="{{ \'AUTH.MAIL-PASSWORD\' | translate }}" required max-length=10 min-length=4><p ng-show="auth.userForm.password.$invalid && !auth.userForm.password.$pristine" class=help-block>{{ \'AUTH.PASSWORD-REQUIRED\' | translate }}</p></div></div><div class=form-group><div class=col-sm-10><button type=submit class="submitting-button btn btn-success">{{ \'AUTH.MAIL-SUBMIT\' | translate }}</button></div></div></form></div><div class=advertiser-wrapper><div class="Absolute-Center is-Responsive"><div class="col-sm-12 col-md-10 col-md-offset-1"><div class=mode-button><div dx-select-box=auth.UI.selectAdvertisers></div><div dx-button=auth.UI.addButton class=add-advertisers></div></div></div></div></div></div></div>'),a.put("app/campaign/camp.html","<div ui-view=details></div><div ui-view=info></div>"),a.put("app/campaignOptimiser/campaignOptimiser.html",'<div class="container-fluid optimiser-camp col-lg-12 col-md-12 col-sm-12"><div class="row stats-header"><div dx-button=CO.UI.navCamp></div><div class=groupHeadOpti><span class="glyphicon glyphicon-cog iconOpti"></span> <span translate=CO.OPTIMISER-FOR class=camp-header></span>:<span class=camp-header> <a href="" ui-sref="home.campaign.details({id: CO.campId})">{{CO.campName}}</a><div class="control pull-right" dx-select-box=CO.UI.datePiker></div></span></div></div><div class="row camp-content1"><div class=transformable ng-class="{\'smallTargeting\':isSmall, \'bigTargeting\':!isSmall}"><table class="table table-bordered"><tr><td class=col-md-3><h5>{{ \'CO.DOMAIN-LISTS\' | translate }} & {{ \'CO.DOMAINS\' | translate}}</h5><p ng-repeat="domain in CO.object.domains">{{domain}} - {{ \'CO.DOMAIN\' | translate }}</p></td><td class=col-md-2><h5>{{ \'CO.GEO\' | translate }}</h5><p ng-repeat="geo in CO.object.geo">{{geo}}</p></td><td class=col-md-5><div class=col-md-6><h5>{{ \'CO.DEVICE-AND-SUPPLY-TYPE\' | translate }}</h5><p ng-repeat="device in CO.object.device">{{device}}</p></div><div class=col-md-6><h5>{{ \'CO.BLOCKING\' | translate }}</h5><p ng-repeat="block in CO.object.block">{{block}}</p></div></td><td class=col-md-2></td></tr></table></div><h3 class=titleRules translate=CO.RULES>Rules for All Domains:</h3><fieldset data-ng-repeat="(Index,rules) in CO.rulesArray" class="container-fluid-rule rule"><div class=all-if-rule><div class=chek><p class=onoff><input class=onoff2 type=checkbox ng-model=hideRules id=checkboxID1 value=1><label for=checkboxID1></label></p><div class=DeleteRule><button class="btn btn-danger" ng-click=CO.deleteRule(Index)>RULE DELETE</button></div></div><div class=if-rule data-ng-repeat="(IndexF,rule) in rules.if" ng-include="\'app/campaignOptimiser/rule.html\'"></div><div class=then ng-hide=hideRules><div class=thentext>Then:</div><input type=radio class=r-optionc ng-model=rules.then id=r-option value=Blacklist ng-click="CO.checkTime(Index, rules)"><label class=lr-option for=r-option>Blacklist</label><input type=radio class=r1-optionc ng-model=rules.then id=r1-option value=Whitelist ng-click="CO.checkTime(Index, rules)"><label class=lr1-option for=r1-option>Whitelist</label><input type=radio class=r2-optionc id=r2-option ng-model=rules.then value="Suspend for review" ng-click="CO.checkTime(Index, rules)"><label class=lr2-option for=r2-option>Suspend for review</label></div><div class=then-little ng-show=hideRules><div class=thentext-little>Then:</div><input type=radio class=r-optionc-little ng-model=rules.then id=r-option-little value=Blacklist ng-click="CO.checkTime(Index, rules)"><label class=lr-option-little for=r-option-little>Blacklist</label><input type=radio class=r1-optionc-little ng-model=rules.then id=r1-option-little value=Whitelist ng-click="CO.checkTime(Index, rules)"><label class=lr1-option-little for=r1-option-little>Whitelist</label><input type=radio class=r2-optionc-little ng-model=rules.then id=r2-option-little value="Suspend for review" ng-click="CO.checkTime(Index, rules)"><label class=lr2-option-little for=r2-option-little>Suspend for review</label></div></div></fieldset><button class="btn btn-primary" ng-click=CO.addNewRule()>Add rule</button> <button class="btn btn-success" ng-click=CO.saveRules()>Save rule</button><hr class=lineMiddle><span class=optimizerTitle>{{ \'CO.OPTIMIZER\' | translate }}</span><div class=gridContainerWhite dx-data-grid=CO.UI.dataGridOptionsCampaign></div><div class=counter-popup-group dx-popup=CO.UI.confirmPopup><div class=title>{{ \'CO.SUSPEND\' | translate }}</div><div id=radioGroupMain dx-radio-group=CO.UI.radioGroupMain></div><div id=dateFormatPop style="margin-left: 35px" dx-date-box=CO.UI.dateFormatPop></div><br><div id=radioGroupSend dx-radio-group=CO.UI.radioGroupSend></div><div class=button id=buttonOk dx-button=CO.UI.confirmPopupOk></div><div class=button dx-button=CO.UI.confirmPopupCancel></div></div><div class=b-popup id=popup1 ng-if="CO.popUpIf==true"><div class=b-popup-content><div id=btn-close class=btn-close ng-click=CO.popUpHide() title=Закрыть></div><h4 class=title>Prediction 1</h4><table class=table><tr ng-repeat="item in CO.arraytoPopup track by $index" class=repitDiagram style="display: block; position: relative"><td ng-if=item>{{item.day}}</td><td ng-if=item><div class=analiticCO style="text-align: center"><div class=diagramCO><div class=badDiagramCO style="width:{{item.badDiagram}}; opacity: {{item.badOpasity}}"></div><div class=goodDiagramCO style=width:{{item.goodDiagram}};opacity:{{item.goodOpasity}}></div><p class=textBadDiagramCO>{{ item.k.toFixed(1)}}%</p><p class=textGoodDiagramCO>{{(100-item.k).toFixed(1)}}%</p></div><div class=buttonAnaliticCO><div class=trueButtonAnaliticCO></div><div class=falseButtonAnaliticCO></div></div></div></td></tr></table></div></div></div></div>'),a.put("app/campaignOptimiser/rule.html",'<div class=logic-rule ng-if=CO.typeOfLogic(rule) ng-hide=hideRules><button class="btn-danger removeF" ng-click=CO.deleteFilds($parent,IndexF)>X</button><div class=RadioRule><div class=ORback><input class=RadioRuleOr id=orlogic type=radio data-ng-model=rule.logicOrAnd ng-value=true ng-checked=rule.logicOrAnd><label class=OrLogic for=orlogic><div calss=verticalOr>OR</div></label></div><div class=ANDback><input class=RadioRuleAnd id=andlogic type=radio data-ng-model=rule.logicOrAnd ng-value=false ng-checked=rule.logicOrAnd><label class=AndLogic for=andlogic><div calss=verticalAnd>AND</div></label></div></div></div><div class=RuleString ng-show=hideRules><div ng-if="$index == 0"><button class="btn green addfieldsG" ng-click=CO.addField($parent)>F+</button> <button class="btn green addgroupG" ng-click="CO.addGroup($parent, IndexF)">G+</button></div><div class=AllRule ng-if="rule.type == \'condition\'"><div class=chek><p class=onoff><input type=checkbox class=onoff1 ng-model=hideGroup id=hideGroup><label class=hideGroup for=hideGroup></label></p></div><div class=infoRule><div class=infotarget>{{rule.target}}</div><div class=info>{{rule.payment}}{{rule.compare}}{{rule.value}}</div></div><div class=RuleShow ng-show=hideGroup><div class=dropdown ng-show=hideGroup><span><select class=select0 data-ng-model=rule.target><option ng-selected="rule.target == \'Placement/App\'">Placement/App</option><option ng-selected="rule.target == \'Carrier\'">Carrier</option><option ng-selected="rule.target == \'Device\'">Device</option><option ng-selected="rule.target == \'OS\'">OS</option><option ng-selected="rule.target == \'Ad exchange\'">Ad exchange</option></select></span></div><div class=dropdown1 ng-show=hideGroup>if <span><select class=select1 data-ng-model=rule.payment><option ng-selected="rule.payment == \'CPA\'">CPA</option><option ng-selected="rule.payment == \'Spend\'">Spend</option><option ng-selected="rule.payment == \'Imressions\'">Imressions</option><option ng-selected="rule.payment == \'Cliks\'">Cliks</option><option ng-selected="rule.payment == \'CRM%\'">CRM%</option><option ng-selected="rule.payment == \'CPC\'">CPC</option><option ng-selected="rule.payment == \'CVR%\'">CVR%</option></select></span></div><div class=dropdown2 ng-show=hideGroup>compare <span><select class=select2 data-ng-model=rule.compare><option ng-selected="rule.compare == \'>\'">&#x3e;</option><option ng-selected="rule.compare == \'<\'">&#x3c;</option><option ng-selected="rule.compare == \'=\'">=</option><option ng-selected="rule.compare == \'>=\'">&#x3e;=</option><option ng-selected="rule.compare == \'<=\'">&#x3c;=</option></select></span></div><div class=inputm ng-show=hideGroup><label>Value <input class=money type=number ng-model=rule.value min=0></label></div></div></div><div class=Infologic ng-if="rule.type == \'logic\'"><button class="btn-danger removeInfo" ng-click=CO.deleteFilds($parent,IndexF)>X</button><div class=InfoOr ng-if="rule.logicOrAnd == true">OR</div><div class=InfoAnd ng-if="rule.logicOrAnd == false">AND</div></div></div><div class=object-rule ng-if=CO.typeOfObject(rule) ng-hide=hideRules><div ng-if="$index == 0" ng-hide=hideRules><button class="btn green addfields" ng-click=CO.addField($parent)>F+</button> <button class="btn green addgroup" ng-click="CO.addGroup($parent, IndexF)">G+</button></div><div class=RuleShow><div class=dropdown><span><select class=select3 data-ng-model=rule.target><option ng-selected="rule.target == \'Placement/App\'">Placement/App</option><option ng-selected="rule.target == \'Carrier\'">Carrier</option><option ng-selected="rule.target == \'Device\'">Device</option><option ng-selected="rule.target == \'OS\'">OS</option><option ng-selected="rule.target == \'Ad exchange\'">Ad exchange</option></select></span></div><div class=dropdown1>if <span><select class=select1 data-ng-model=rule.payment><option ng-selected="rule.payment == \'CPA\'">CPA</option><option ng-selected="rule.payment == \'Spend\'">Spend</option><option ng-selected="rule.payment == \'Imressions\'">Imressions</option><option ng-selected="rule.payment == \'Cliks\'">Cliks</option><option ng-selected="rule.payment == \'CRM%\'">CRM%</option><option ng-selected="rule.payment == \'CPC\'">CPC</option><option ng-selected="rule.payment == \'CVR%\'">CVR%</option></select></span></div><div class=dropdown2>compare <span><select class=select2 data-ng-model=rule.compare><option ng-selected="rule.compare == \'>\'">&#x3e;</option><option ng-selected="rule.compare == \'<\'">&#x3c;</option><option ng-selected="rule.compare == \'=\'">=</option><option ng-selected="rule.compare == \'>=\'">&#x3e;=</option><option ng-selected="rule.compare == \'<=\'">&#x3c;=</option></select></span></div><div class=inputm><label>Value <input class=money type=number ng-model=rule.value min=0></label></div></div></div><div class=GroupShow><!----><!--  --><div class=object-group ng-if="CO.typeOfArray(rule) "><div class=bracet-begin></div><div class=GroupRepeat ng-repeat="(IndexF,rule) in rule" ng-include="\'app/campaignOptimiser/rule.html\'" ng-hide=hideGroup></div><div class=bracet-end></div></div></div>'),a.put("app/campaigndetails/campdetails.html",'<div class="container-fluid container-camp-second col-lg-12 col-md-12 col-sm-12"><div class="second-container-details row"><div class=label-container><input type=button ng-click="campdetails.selectInfoBtn($event, campdetails.ctrlBbtns.placement.header)" name=Placement value={{campdetails.ctrlBbtns.placement.btn}} class=nav-btn> <input type=button ng-click="campdetails.selectInfoBtn($event, campdetails.ctrlBbtns.creativeId.header)" name=creative_id value={{campdetails.ctrlBbtns.creativeId.btn}} class=nav-btn> <input type=button ng-click="campdetails.selectInfoBtn($event, campdetails.ctrlBbtns.creativeSize.header)" name=creative_size value={{campdetails.ctrlBbtns.creativeSize.btn}} class=nav-btn> <input type=button ng-click="campdetails.selectInfoBtn($event, campdetails.ctrlBbtns.os.header)" name=OS value={{campdetails.ctrlBbtns.os.btn}} class=nav-btn> <input type=button ng-click="campdetails.selectInfoBtn($event, campdetails.ctrlBbtns.carrier.header)" name=carrier value={{campdetails.ctrlBbtns.carrier.btn}} class=nav-btn> <input type=button ng-click="campdetails.selectInfoBtn($event, campdetails.ctrlBbtns.networkSeller.header)" name=network(seller) value={{campdetails.ctrlBbtns.networkSeller.btn}} class=nav-btn> <input type=button ng-click="campdetails.selectInfoBtn($event, campdetails.ctrlBbtns.connectionType.header)" name=connection_type value={{campdetails.ctrlBbtns.connectionType.btn}} class=nav-btn> <input type=button ng-click="campdetails.selectInfoBtn($event, campdetails.ctrlBbtns.device.header)" name=device value={{campdetails.ctrlBbtns.device.btn}} class=nav-btn></div><div class=pie-chart-container><div class=header-pie-chart><div class=pie-chart-header><h4>{{campdetails.pieChartHeader}}</h4></div><div class=target-cpa-container><div class=input-target-cpa-text>target CPA</div><input class=input-target-cpa type=text ng-blur=campdetails.targetCpaChange($event) ng-keyup="$event.keyCode == 13 && campdetails.targetCpaChange($event)" ng-model=campdetails.targetCpa maxlength=4></div></div><div class=pie-charts><div class=chart-container dx-pie-chart=campdetails.pieChartAll></div><div class=chart-container dx-pie-chart=campdetails.pieChartConversions></div></div><div class=row><div class="col-lg-6 cpa-buckets-container"><span class=first>${{campdetails.backetsRanges.first.min}}-${{campdetails.backetsRanges.first.max}}</span><div id=backets-1 dx-data-grid=campdetails.cpaBucketFirst></div></div><div class="col-lg-6 cpa-buckets-container"><span class=first>${{campdetails.backetsRanges.second.min}}-${{campdetails.backetsRanges.second.max}}</span><div id=backets-2 dx-data-grid=campdetails.cpaBucketSecond></div></div></div><div class=row><div class="col-lg-6 cpa-buckets-container"><span class=first>${{campdetails.backetsRanges.third.min}}-${{campdetails.backetsRanges.third.max}}</span><div id=backets-3 dx-data-grid=campdetails.cpaBucketThird></div></div><div class="col-lg-6 cpa-buckets-container"><span class=first>${{campdetails.backetsRanges.fourth.min}}+</span><div id=backets-4 dx-data-grid=campdetails.cpaBucketFourth></div></div></div></div></div></div>'),a.put("app/campaignmain/campmain.html",'<div class="container-fluid container-camp col-lg-12 col-md-12 col-sm-12"><div class="row stats-header"><span translate=CAMP.NAME class=camp-header></span><span class=camp-header>: {{campmain.campName}}</span><div class=control dx-button=campmain.optimiser></div><div class="control pull-right" dx-select-box=campmain.datePiker></div></div><div class="row camp-content1"><div class="row-fluid charts-block"><div id=zoomedContainerFirst class="first-chart col-lg-5 col-md-9 col-sm-9 col-xs-9"><div id=zoomedChartFirst dx-chart=campmain.chartOptionsFirst></div><div dx-range-selector=campmain.rangeOptionsFirst id=rangeChartFirst></div></div><div class=checkbox-container><div><label class=label-checkbox><div dx-check-box=campmain.impressions></div></label><label class=label-checkbox><div dx-check-box=campmain.CPA></div></label><label class=label-checkbox><div dx-check-box=campmain.CPC></div></label><label class=label-checkbox><div dx-check-box=campmain.clicks></div></label><label class=label-checkbox><div dx-check-box=campmain.cost></div></label><label class=label-checkbox><div dx-check-box=campmain.conversions></div></label><label class=label-checkbox><div dx-check-box=campmain.CTR></div></label></div></div><div id=zoomedContainerSecond class="first-chart col-lg-5 col-md-10 col-sm-10"><div id=zoomedChartSecond dx-chart=campmain.chartOptionsSecond></div><!--<div dx-range-selector="campmain.rangeOptionsSecond"></div>--></div></div><div class=counter-popup-group dx-popup=campmain.UI.confirmPopup><div class=title>{{ \'campmain.SUSPEND\' | translate }}</div><div id=radioGroupMain dx-radio-group=campmain.UI.radioGroupMain></div><div id=dateFormatPop style="margin-left: 35px" dx-date-box=campmain.UI.dateFormatPop></div><br><div id=radioGroupSend dx-radio-group=campmain.UI.radioGroupSend></div><div class=button id=buttonOk dx-button=campmain.UI.confirmPopupOk></div><div class=button dx-button=campmain.UI.confirmPopupCancel></div></div></div><div class="row first-grid"><div id=gridContainer2 dx-data-grid=campmain.dataGridOptionsCampaign></div></div></div>'),
a.put("app/home/home.html",'<div id=wrapper><!-- Brand and toggle get grouped for better mobile display --><div class=row><div class="left-nav col-lg-1 col-md-2 col-sm-2 col-xs-2"><ul class="nav nav-list"><li class=nav-header><a href=# translate=INDEX.LEFT_NAV.HOME></a></li><li class=active><a ui-sref=home.campaign.details translate=INDEX.LEFT_NAV.CAMPAIGN>Campaign</a></li><li><a href=#/ translate=INDEX.LEFT_NAV.OPTIMIZER>Optimizer</a></li><li><a href=#/ translate=INDEX.LEFT_NAV.BILLING>Billing</a></li><li ng-if="home.isEven == true"><a ui-sref=home.valuationByExpert translate=INDEX.LEFT_NAV.EXPERT>Valuation by expert</a></li></ul></div><input class=open id=top-box ng-model=home.value ng-click=home.checked(home.value) type=checkbox value=true hidden><label class=btn for=top-box></label><div class="main-nav navbar-header col-lg-11 col-md-10 col-sm-10 col-xs-10 col-lg-offset-1 col-md-offset-2 col-sm-offset-2 col-xs-offset-2"><div class=row><div class="col-lg-12 col-md-12 col-sm-12"><button type=button data-target=#navbarCollapse data-toggle=collapse class=navbar-toggle><span class=sr-only>Toggle navigation</span> <span class=icon-bar></span> <span class=icon-bar></span> <span class=icon-bar></span></button> <a ui-sref=home.main class=navbar-brand>{{ \'INDEX.ADVERTISER_TITLE\' | translate }} {{ home.advertiser.name }}</a><div class=location><div class=location-language><a ng-click="root.changeLang(\'ru\')"><i class="fa fa-globe fa-fw"></i> Русский </a>/ <a ng-click="root.changeLang(\'en\')"><i class="fa fa-globe fa-fw"></i> English</a></div><input type=button class="btn btn-danger admin-btn" ng-click=root.logout() value="{{ \'COMMON.LOGOUT\' | translate }}"> <input type=button id=homeAdm ng-show=home.isEven class="btn btn-primary admin-btn" ng-click=home.goToAdminPanel() value="{{ \'COMMON.GO-TO-ADMIN-PANEL\' | translate }}"></div></div></div></div><ui-view class="page-view col-lg-11 col-md-10 col-sm-10 col-xs-10 col-lg-offset-1 col-md-offset-2 col-sm-offset-2 col-xs-offset-2"></ui-view></div></div>'),a.put("app/main/main.html",'<div class="container-home col-lg-12 col-md-12 col-sm-12 col-xs-12"><h1 translate=MAIN.HOME>Home</h1><div class="col-md-3 col-md-offset-8 piker col-sm-3 col-sm-offset-8 col-xs-5 col-xs-offset-6"><div dx-select-box=main.UI.datePiker></div></div><div class="row charts-block"><div class="col-lg-5 col-md-9 col-sm-9 col-xs-9 chart"><div dx-chart=main.UI.chartOptions id=chart></div></div><div class=checkbox-container><label class=label-checkbox><div class=checkboxchart dx-check-box=main.UI.impressions></div></label><label class=label-checkbox><div class=checkboxchart dx-check-box=main.UI.CVR></div></label><label class=label-checkbox><div class=checkboxchart dx-check-box=main.UI.CPC></div></label><label class=label-checkbox><div class=checkboxchart dx-check-box=main.UI.clicks></div></label><label class=label-checkbox><div class=checkboxchart dx-check-box=main.UI.cost></div></label><label class=label-checkbox><div class=checkboxchart dx-check-box=main.UI.conversions></div></label><label class=label-checkbox><div class=checkboxchart dx-check-box=main.UI.CTR></div></label></div><div class="col-lg-5 col-md-12 col-sm-12 chart"><div id=visualMap></div></div></div><div class="row first-grid table-responsive"><table class="table table-bordered"><tr><td translate=MAIN.TOTALS.COLUMNS.TOTALS></td><td translate=MAIN.TOTALS.COLUMNS.SPENT></td><td translate=MAIN.TOTALS.COLUMNS.CONV></td><td translate=MAIN.TOTALS.COLUMNS.IMP></td><td translate=MAIN.TOTALS.COLUMNS.CPC></td><td translate=MAIN.TOTALS.COLUMNS.CPM></td><td translate=MAIN.TOTALS.COLUMNS.CVR></td><td translate=MAIN.TOTALS.COLUMNS.CTR></td></tr><tr><td></td><td>${{main.totals.spent}}</td><td>{{main.totals.conv}}</td><td>{{main.totals.imp}}</td><td>${{main.totals.cpc}}</td><td>${{main.totals.cpm}}</td><td>{{main.totals.cvr}}%</td><td>{{main.totals.ctr}}%</td></tr></table></div><div class="row second-grid"><div id=gridContainer2 dx-data-grid=main.UI.dataGridOptionsMultiple></div></div></div>'),a.put("app/valuationByExpert/valuationByExpert.html",'<div class="container-fluid expert-camp col-lg-12 col-md-12 col-sm-12"><div class="row stats-header"><div class=groupHeadOpti><span class="glyphicon glyphicon-tasks iconOpti"></span> <span translate=VBE.PAGE-NAME class=camp-header></span>:<span class=camp-header><div class="control pull-right" dx-select-box=VBE.UI.datePiker></div></span></div></div><div class="row camp-content1"><div class=gridContainerWhite dx-button=VBE.UI.calculateAUC></div><div class=gridContainerWhite dx-data-grid=VBE.UI.dataGridOptionsExpert></div><div class="content poed" ng-if="VBE.culcReady == true"><h1>Poed 1</h1><h2>AUC = 0.8</h2><div class=imgGraf><img src=../../assets/images/auc.jpg alt=""></div></div><h3 ng-if="VBE.culcReady == true">Confidence interval - 95%</h3><h3 ng-if="VBE.culcReady == true">Confidence error - 5%</h3><div class=b-popup id=popup1 ng-if="VBE.popUpIf==true"><div class=b-popup-content><div id=btn-close class=btn-close ng-click=VBE.popUpHide() title=Закрыть></div><h4 class=title>Prediction 1</h4><table class=table><tr ng-repeat="item in VBE.arraytoPopup track by $index" class=repitDiagram style="display: block; position: relative"><td ng-if=item>{{item.day}}</td><td ng-if=item><div class=analiticCO style="text-align: center"><div class=diagramCO><div class=badDiagramCO style="width:{{item.badDiagram}}; opacity: {{item.badOpasity}}"></div><div class=goodDiagramCO style=width:{{item.goodDiagram}};opacity:{{item.goodOpasity}}></div><p class=textBadDiagramCO>{{ item.k.toFixed(1)}}%</p><p class=textGoodDiagramCO>{{(100-item.k).toFixed(1)}}%</p></div><div class=buttonAnaliticCO><div class=trueButtonAnaliticCO></div><div class=falseButtonAnaliticCO></div></div></div></td></tr></table></div></div></div></div>')}]);