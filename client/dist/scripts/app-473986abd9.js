function RootController(e,t,a,n,i){function o(){i.remove("permission"),i.remove("token"),t.go("auth")}var r=this;e.Globalize.culture(n.get("TRANSLATE_LANG_KEY")),r.changeLang=function(n){a.use(n),e.Globalize.culture(n),t.reload()},r.logout=o}RootController.$inject=["$window","$state","$translate","$translateLocalStorage","$cookies"],function(){"use strict";angular.module("pjtLayout",["ngAnimate","ngCookies","ngTouch","ngSanitize","ngMessages","ngAria","ui.router","ui.bootstrap","toastr","dx","pascalprecht.translate","chart.js","ngStorage"])}(),function(){"use strict";function e(e,t,a){function n(e,a,n,o){return new t.DevExpress.data.CustomStore({totalCount:function(){return 0},load:function(){return i(e,a,n,o).then(function(e){return e})}})}function i(n,i,o,r){return e({method:"GET",url:"/api/v1/videostatistics",headers:{Authorization:"Token "+a.get("token")},params:{advertiser_id:n,from_date:i,to_date:o,by:r}}).then(function(e){for(var a in e.data)e.data[a].day=t.moment(e.data[a].day).format("DD/MM");return e.data})["catch"](function(e){t.DevExpress.ui.notify(e.data.detail,"error",4e3)})}function o(e,a,n,i){return new t.DevExpress.data.CustomStore({totalCount:function(){return l},load:function(t){return t.searchOperation&&t.dataField&&(t.take=99999999),r(e,a,n,t.skip,t.take,t.sort,t.order,i,t.filter,t.totalSummary).then(function(e){return l=e.total_count,e.campaigns})}})}function r(n,i,o,r,s,l,c,u,m,p){return l?(c=l[0].desc===!0?"desc":"asc",l=l[0].selector):(l="campaign",c="DESC"),null==s&&(s=20),null==r&&(r=0),e({method:"GET",url:"/api/v1/videocampaigns",headers:{Authorization:"Token "+a.get("token")},params:{advertiser_id:n,from_date:i,to_date:o,skip:r,take:s,sort:l,order:c,stat_by:u,filter:m,totalSummary:p}}).then(function(e){return d.totalSummary={campaign:e.data.total_count||0,ad_starts:e.data.total_ad_starts,cpm:e.data.total_cpm,fill_rate:e.data.total_fill_rate,fill_rate_hour:e.data.total_fill_rate_hour,profit_loss:e.data.total_profit_loss,profit_loss_hour:e.data.total_profit_loss_hour,spent:e.data.total_spent,sum_imps:e.data.total_sum_imps},e.data})["catch"](function(e){t.DevExpress.ui.notify(e.data.detail,"error",4e3)})}function s(n,i,o){return e({method:"GET",url:"/api/v1/map/imps",headers:{Authorization:"Token "+a.get("token")},params:{advertiser_id:n,from_date:i,to_date:o}}).then(function(e){return e.data})["catch"](function(e){t.DevExpress.ui.notify(e.data.detail,"error",4e3)})}var d=this,l=0;d.multipleStore=o,d.chartStore=n,d.statsMap=s}e.$inject=["$http","$window","$cookies"],angular.module("pjtLayout").service("VideoMain",e)}(),function(){"use strict";function e(e,t,a,n,i,o,r){function s(t,a){return t.dataSource.postProcess=function(t){var n=e._.uniqBy(t,a);return n.map(function(e){return{text:e[a],value:e[a]}})}}function d(){for(var e in n.checkChartVideo)n.checkChartVideo[e]?("imp"==e&&l.chartOptionsFunc.getSeriesByName("Impressions").show(),"ad_starts"==e&&l.chartOptionsFunc.getSeriesByName("ad_starts").show(),"fill_rate"==e&&l.chartOptionsFunc.getSeriesByName("fill_rate").show(),"profit_loss"==e&&l.chartOptionsFunc.getSeriesByName("profit_loss").show(),"spend"==e&&l.chartOptionsFunc.getSeriesByName("Cost").show()):("imp"==e&&l.chartOptionsFunc.getSeriesByName("Impressions").hide(),"ad_starts"==e&&l.chartOptionsFunc.getSeriesByName("ad_starts").hide(),"fill_rate"==e&&l.chartOptionsFunc.getSeriesByName("fill_rate").hide(),"profit_loss"==e&&l.chartOptionsFunc.getSeriesByName("profit_loss").hide(),"spend"==e&&l.chartOptionsFunc.getSeriesByName("Cost").hide())}var l=this;l.advertiser=n.advertiser,l.VideoMain=o,l.multipleTotalCount=0,l.Init=[],l.by=["imp","spend","ad_starts","fill_rate","profit_loss"],l.selectedItems=[],l.chartOptionsFuncgrid=[],l.charIsUpdating=!1,r.id=null;var c=i.instant;null==n.checkChartVideo&&(n.checkChartVideo={imp:!0,ad_starts:!1,fill_rate:!1,profit_loss:!1,spend:!1});var u=[{valueField:"imp",name:"Impressions",axis:"imp",visible:n.checkChartVideo.imp},{valueField:"ad_starts",name:"ad_starts",axis:"ad_starts",visible:n.checkChartVideo.ad_starts},{valueField:"fill_rate",name:"fill_rate",axis:"fill_rate",visible:n.checkChartVideo.fill_rate},{valueField:"profit_loss",name:"profit_loss",axis:"profit_loss",visible:n.checkChartVideo.profit_loss},{valueField:"spend",name:"Cost",axis:"spend",visible:n.checkChartVideo.spend}];null==n.SelectedTime?(n.SelectedTime=0,n.dataStart=e.moment({hour:"00"}).subtract(1,"day").unix(),n.dataEnd=e.moment({hour:"00"}).subtract(1,"day").endOf("day").unix(),l.dataStart=e.moment({hour:"00"}).subtract(1,"day").unix(),l.dataEnd=e.moment({hour:"00"}).subtract(1,"day").endOf("day").unix()):null==n.dataStart||null==n.dataEnd?(n.SelectedTime=0,n.dataStart=e.moment({hour:"00"}).subtract(1,"day").unix(),n.dataEnd=e.moment({hour:"00"}).subtract(1,"day").endOf("day").unix(),l.dataStart=e.moment({hour:"00"}).subtract(1,"day").unix(),l.dataEnd=e.moment({hour:"00"}).subtract(1,"day").endOf("day").unix()):(l.dataStart=n.dataStart,l.dataEnd=n.dataEnd);var m=angular.element(e.document.querySelector("#wrapper"))[0];m.classList.add("hidden-menu");var p=[{ID:0,Name:c("MAIN.DATE_PICKER.YESTERDAY"),dataStart:e.moment({hour:"00"}).subtract(1,"day").unix(),dataEnd:e.moment({hour:"00"}).subtract(1,"day").endOf("day").unix()},{ID:1,Name:c("MAIN.DATE_PICKER.LAST_3_DAYS"),dataStart:e.moment({hour:"00"}).subtract(3,"day").unix(),dataEnd:e.moment({hour:"00"}).unix()},{ID:2,Name:c("MAIN.DATE_PICKER.LAST_7_DAYS"),dataStart:e.moment({hour:"00"}).subtract(7,"day").unix(),dataEnd:e.moment({hour:"00"}).unix()},{ID:3,Name:c("MAIN.DATE_PICKER.LAST_14_DAYS"),dataStart:e.moment({hour:"00"}).subtract(14,"day").unix(),dataEnd:e.moment({hour:"00"}).unix()},{ID:4,Name:c("MAIN.DATE_PICKER.LAST_21_DAYS"),dataStart:e.moment({hour:"00"}).subtract(21,"day").unix(),dataEnd:e.moment({hour:"00"}).unix()},{ID:5,Name:c("MAIN.DATE_PICKER.CURRENT_MONTH"),dataStart:e.moment().startOf("month").unix(),dataEnd:e.moment().unix()},{ID:6,Name:c("MAIN.DATE_PICKER.LAST_MONTH"),dataStart:e.moment().subtract(1,"month").startOf("month").unix(),dataEnd:e.moment().subtract(1,"month").endOf("month").unix()},{ID:7,Name:c("MAIN.DATE_PICKER.LAST_90_DAYS"),dataStart:e.moment({hour:"00"}).subtract(90,"day").unix(),dataEnd:e.moment().unix()},{ID:8,Name:c("MAIN.DATE_PICKER.ALL_TIME"),dataStart:0,dataEnd:e.moment().unix()}];l.checkBoxState=!0,l.onlyTwo=function(e){var t=0,a=[],n=[];for(t=0;t<l.Init.length;t++)1==l.Init[t]._options.value?a.push(l.Init[t]):n.push(l.Init[t]);if(1==e){if(2==a.length&&n.length>2)for(t=0;t<n.length;t++)n[t].option("disabled",!0)}else if(a.length<=2)for(t=0;t<n.length;t++)n[t].option("disabled",!1)},l.updateCharts=function(t,a,i){var o={};n.checkChartVideo[a]=i;var r=0;if(i)for(l.chartOptionsFunc.getSeriesByName(t).show(),o=e.$(".chartMulti"),r=0;r<o.length;r++)e.$(o[r]).dxChart("instance").getSeriesByName(t).show();else for(l.chartOptionsFunc.getSeriesByName(t).hide(),o=e.$(".chartMulti"),r=0;r<o.length;r++)e.$(o[r]).dxChart("instance").getSeriesByName(t).hide()};var h={};l.VideoMain.statsMap(l.advertiser.id,l.dataStart,l.dataEnd).then(function(t){h=t,e.$("#visualMap").dxVectorMap(l.UI.vectorMapOptions)}),l.chartStore=o.chartStore(l.advertiser.id,l.dataStart,l.dataEnd,["imp","spend","ad_starts","fill_rate","profit_loss"]),l.multipleStore=o.multipleStore(l.advertiser.id,l.dataStart,l.dataEnd,["imp","spend","ad_starts","fill_rate","profit_loss"]),l.UI={datePiker:{items:p,displayExpr:"Name",valueExpr:"ID",value:p[n.SelectedTime].ID,onValueChanged:function(e){n.SelectedTime=e.value,n.dataStart=p[e.value].dataStart,n.dataEnd=p[e.value].dataEnd,t.reload()}},dataGridOptionsMultiple:{bindingOptions:{dataSource:"vmain.multipleStore"},onInitialized:function(e){l.dataGridOptionsMultipleFunc=e.component},loadPanel:{shadingColor:"rgba(0,0,0,0.4)",visible:!1,showIndicator:!0,showPane:!0,shading:!0,closeOnOutsideClick:!1},remoteOperations:!0,pager:{showPageSizeSelector:!0,allowedPageSizes:[10,30,50],visible:!0,showNavigationButtons:!0},alignment:"left",headerFilter:{visible:!0},filterRow:{visible:!0,applyFilter:"auto"},"export":{enabled:!0,fileName:"Employees"},allowColumnReordering:!0,allowColumnResizing:!0,columnAutoWidth:!0,wordWrapEnabled:!0,loadingIndicator:{show:!1},columnChooser:{enabled:!0},columnFixing:{enabled:!0},showBorders:!0,showRowLines:!0,summary:{totalItems:[{column:"campaign",summaryType:"sum",customizeText:function(e){return e.valueText="Count: "+o.totalSummary.campaign,e.valueText}},{column:"spent",summaryType:"sum",customizeText:function(e){return e.valueText="Spent: $"+o.totalSummary.spent.toFixed(2),e.valueText}},{column:"sum_imps",summaryType:"sum",customizeText:function(e){return e.valueText="Imp: "+o.totalSummary.sum_imps.toString().split(/(?=(?:\d{3})+(?!\d))/).join(),e.valueText}},{column:"cpm",summaryType:"sum",customizeText:function(e){return e.valueText="CPM: $"+o.totalSummary.cpm.toFixed(2),e.valueText}},{column:"ad_starts",summaryType:"sum",customizeText:function(e){return e.valueText="Ad starts: "+o.totalSummary.ad_starts.toString().split(/(?=(?:\d{3})+(?!\d))/).join(),e.valueText}},{column:"fill_rate",summaryType:"sum",customizeText:function(e){return e.valueText="Fill rate: "+o.totalSummary.fill_rate.toFixed(4)+"%",e.valueText}},{column:"profit_loss",summaryType:"sum",customizeText:function(e){return e.valueText="Profit loss: $"+o.totalSummary.profit_loss.toFixed(2),e.valueText}},{column:"fill_rate_hour",summaryType:"sum",customizeText:function(e){return e.valueText="Delta fill rate: "+o.totalSummary.fill_rate_hour.toFixed(4)+"%",e.valueText}},{column:"profit_loss_hour",summaryType:"sum",customizeText:function(e){return e.valueText="Delta profit loss: $"+o.totalSummary.profit_loss_hour.toFixed(2),e.valueText}}]},columns:[{caption:c("MAIN.CAMPAIGN.COLUMNS.CAMPAIGN"),dataField:"campaign",fixed:!0,cellTemplate:function(t,a){t.addClass("a-campaign"),e.angular.element('<a href="#/video/campaign/'+a.data.campaign_id+'">'+a.data.campaign_name+" ("+a.data.campaign_id+")</a>").appendTo(t)},headerFilter:{dataSource:function(e){return s(e,"campaign_name")}},alignment:"center"},{caption:c("MAIN.CAMPAIGN.COLUMNS.SPENT")+" ,$",dataField:"spent",alignment:"center",dataType:"number",format:"currency",allowFiltering:!1,precision:2,headerFilter:{dataSource:function(e){return s(e,"spent")}}},{caption:c("MAIN.CAMPAIGN.COLUMNS.IMP"),dataField:"sum_imps",sortOrder:"desc",alignment:"center",format:"fixedPoint",dataType:"number",allowFiltering:!1,headerFilter:{dataSource:function(e){return s(e,"sum_imps")}}},{caption:c("MAIN.CAMPAIGN.COLUMNS.CPM")+" ,$",dataField:"cpm",alignment:"center",dataType:"number",precision:2,format:"currency",allowFiltering:!1,headerFilter:{dataSource:function(e){return s(e,"cpm")}}},{caption:c("MAIN.CAMPAIGN.COLUMNS.AD-STARTS"),dataField:"ad_starts",alignment:"center",format:"fixedPoint",dataType:"number",allowFiltering:!1,headerFilter:{dataSource:function(e){return s(e,"ad_starts")}}},{caption:c("MAIN.CAMPAIGN.COLUMNS.FILL-RATE"),dataField:"fill_rate",alignment:"center",dataType:"number",format:"percent",precision:2,allowFiltering:!1,headerFilter:{dataSource:function(e){return s(e,"fill_rate")}}},{caption:c("MAIN.CAMPAIGN.COLUMNS.PROFIT-LOSS"),dataField:"profit_loss",alignment:"center",dataType:"number",precision:2,format:"fixedPoint",allowFiltering:!1,headerFilter:{dataSource:function(e){return s(e,"profit_loss")}}},{caption:c("MAIN.CAMPAIGN.COLUMNS.FILL-RATE-HOUR"),dataField:"fill_rate_hour",alignment:"center",dataType:"number",format:"percent",precision:1,allowFiltering:!1,headerFilter:{dataSource:function(e){return s(e,"fill_rate_hour")}}},{caption:c("MAIN.CAMPAIGN.COLUMNS.PROFIT-LOSS-HOUR"),dataField:"profit_loss_hour",alignment:"center",dataType:"number",precision:2,format:"currency",allowFiltering:!1,headerFilter:{dataSource:function(e){return s(e,"profit_loss_hour")}}},{width:200,dataField:c("MAIN.CAMPAIGN.COLUMNS.STATS"),allowFiltering:!1,cellTemplate:function(t,a){if(a.data.chart){var n={onInitialized:function(e){l.chartOptionsFuncgrid[a.rowIndex]=e.component},dataSource:a.data.chart,size:{height:80,width:185},commonSeriesSettings:{argumentField:"day",type:"line",point:{size:2,hoverStyle:{border:{visible:!0,width:1},size:4}}},commonAxisSettings:{label:{visible:!1},grid:{visible:!1}},valueAxis:[{name:"imp"},{name:"ad_starts"},{name:"fill_rate"},{name:"profit_loss"},{name:"spend"}],argumentAxis:{valueMarginsEnabled:!1,discreteAxisDivisionMode:"crossLabels",grid:{visible:!1},label:{visible:!1},minorGrid:{visible:!1},minorTick:{visible:!1},tick:{visible:!1}},series:u,legend:{visible:!1},tooltip:{enabled:!0,customizeTooltip:function(e){return"Cost"==e.seriesName||"CPC"==e.seriesName?{text:"$"+e.valueText+" "+e.seriesName}:"Impressions"==e.seriesName?{text:e.value.toString().split(/(?=(?:\d{3})+(?!\d))/).join()}:"CTR"==e.seriesName||"CVR"==e.seriesName?{text:e.valueText+"% "+e.seriesName}:{text:e.valueText+" "+e.seriesName}}}};t.addClass("img-container");var i=e.$('<div class="chartMulti" ></div>');i.dxChart(n),i.appendTo(t)}else t.addClass("img-container"),e.$('<div id="chartMulti" ></div>').appendTo(t)}}],onSelectionChanged:function(e){l.selectedItems=e.selectedRowsData,l.disabled=!l.selectedItems.length}},chartOptions:{onDone:function(){var e=$("#chart").dxChart("instance");if(!l.charIsUpdating){var t=[],a="left";l.UI.chartOptions.valueAxis.forEach(function(i,o){var r=n.checkChartVideo[i.name];t.push({name:i.name,position:a,label:{format:"percent",alignment:"center",customizeText:function(){l.charIsUpdating=!0;var t=e._valueAxes[o]._majorTicks,a=null;if(Array.isArray(t)&&a<t[t.length-1].value&&(a=t[t.length-1].value),this.value==a)switch(i.name){case"imp":return'<span style="color:black; font-weight: bolder; text-decoration:underline;">'+c("MAIN.CHECKBOX.IMPRESSIONS")+"</span><br>"+this.value.toString().split(/(?=(?:\d{3})+(?!\d))/).join();case"ad_starts":return'<span style="color:black; font-weight: bolder; text-decoration:underline;">'+c("MAIN.CHECKBOX.fill_rate")+"</span><br>"+this.value;case"fill_rate":return'<span style="color:black; font-weight: bolder; text-decoration:underline;">'+c("MAIN.CHECKBOX.fill_rate")+"</span><br>"+this.value;case"profit_loss":return'<span style="color:black; font-weight: bolder; text-decoration:underline;">'+c("MAIN.CHECKBOX.profit_loss")+"</span><br>"+this.value;case"spend":return'<span style="color:black; font-weight: bolder; text-decoration:underline;">'+c("MAIN.CHECKBOX.COST")+"</span><br>"+this.value;default:return'<span style="color:black; font-weight: bolder; text-decoration:underline;">'+i.name+"</span><br>"+this.value}else switch(i.name){case"imp":return this.value.toString().split(/(?=(?:\d{3})+(?!\d))/).join()}return this.value}}}),r&&(a="left"==a?"right":"left")}),e.option("valueAxis",t)}},onInitialized:function(e){l.chartOptionsFunc=e.component},series:u,bindingOptions:{dataSource:"vmain.chartStore"},commonSeriesSettings:{argumentField:"day",type:"Line",point:{size:6,hoverStyle:{border:{visible:!0,width:2},size:5}}},tooltip:{enabled:!0,customizeTooltip:function(e){return{text:e.valueText}}},crosshair:{enabled:!0,color:"deepskyblue",visible:!0,horizontalLine:{label:{visible:!0,customizeText:function(e){return"Cost"==e.point.series.name||"CPC"==e.point.series.name?"$"+this.value:"Impressions"==e.point.series.name?this.value.toString().split(/(?=(?:\d{3})+(?!\d))/).join():"CTR"==e.point.series.name||"CVR"==e.point.series.name?this.value+"%":void 0}}},verticalLine:{label:{visible:!0}}},commonAxisSettings:{valueMarginsEnabled:!0},margin:{bottom:20},argumentAxis:{discreteAxisDivisionMode:"crossLabels",grid:{visible:!0}},valueAxis:[{name:"imp",position:"left",label:{format:"percent"}},{name:"ad_starts",position:"left"},{name:"fill_rate",position:"left"},{name:"spend",position:"left"},{name:"profit_loss",position:"left"}],legend:{verticalAlignment:"bottom",horizontalAlignment:"center",itemTextPosition:"bottom"}},impressions:{text:c("MAIN.CHECKBOX.IMPRESSIONS"),value:n.checkChartVideo.imp,onInitialized:function(e){l.Init.push(e.component)},onValueChanged:function(e){l.updateCharts("Impressions","imp",e.value),l.onlyTwo(e.value),l.charIsUpdating=!1,l.UI.chartOptions.onDone(),d()}},ad_starts:{text:c("MAIN.CHECKBOX.ad_starts"),value:n.checkChartVideo.ad_starts,onInitialized:function(e){l.Init.push(e.component)},onValueChanged:function(e){l.updateCharts("ad_starts","ad_starts",e.value),l.onlyTwo(e.value),l.charIsUpdating=!1,l.UI.chartOptions.onDone(),d()}},fill_rate:{text:c("MAIN.CHECKBOX.fill_rate"),value:n.checkChartVideo.fill_rate,onInitialized:function(e){l.Init.push(e.component)},onValueChanged:function(e){l.updateCharts("fill_rate","fill_rate",e.value),l.onlyTwo(e.value),l.charIsUpdating=!1,l.UI.chartOptions.onDone(),d()}},profit_loss:{text:c("MAIN.CHECKBOX.profit_loss"),value:n.checkChartVideo.profit_loss,onInitialized:function(e){l.Init.push(e.component)},onValueChanged:function(e){l.updateCharts("profit_loss","profit_loss",e.value),l.onlyTwo(e.value),l.charIsUpdating=!1,l.UI.chartOptions.onDone(),d()}},cost:{text:c("MAIN.CHECKBOX.COST"),value:n.checkChartVideo.spend,onInitialized:function(e){l.Init.push(e.component)},onValueChanged:function(e){l.updateCharts("Cost","spend",e.value),l.onlyTwo(e.value),l.charIsUpdating=!1,l.UI.chartOptions.onDone(),d()}},vectorMapOptions:{size:{height:320},layers:[{name:"areas",dataSource:e.DevExpress.viz.map.sources.world,palette:"blue",colorGroups:[0,100,1e7],colorGroupingField:"imps",label:{enabled:!0,dataField:"name"},customize:function(e){e.forEach(function(e){var t=e.attribute("name"),a=h[t];a&&e.attribute("imps",a)})}}],tooltip:{enabled:!0,customizeTooltip:function(e){return e.attribute("imps")?{text:e.attribute("name")+": "+e.attribute("imps")}:{text:e.attribute("name")}}},legends:[{source:{layer:"areas",grouping:"color"},horizontalAlignment:"left",verticalAlignment:"bottom",customizeText:function(e){return e.start+" to "+e.end+" impressions"}}],bounds:[-180,85,180,-75]}},a(function(){var e=0,t=[],a=[];for(e=0;e<l.Init.length;e++)1==l.Init[e]._options.value?t.push(l.Init[e]):a.push(l.Init[e]);if(t.length>=2&&a.length>2)for(e=0;e<a.length;e++)a[e].option("disabled",!0)})}e.$inject=["$window","$state","$timeout","$localStorage","$translate","VideoMain","$rootScope"],angular.module("pjtLayout").controller("VideoMainController",e)}(),function(){"use strict";function e(e,t,a){function n(t){return e({method:"GET",headers:{Authorization:"Token "+a.get("token")},url:"/api/v1/campaigns/"+encodeURI(t)}).then(function(e){return e.data})["catch"](function(e){return e})}function i(n,i,o,r){return e({method:"GET",url:"/api/v1/videocampaigns/"+encodeURI(n)+"/graphinfo",headers:{Authorization:"Token "+a.get("token")},params:{from_date:i,to_date:o,by:r}}).then(function(e){for(var a in e.data)e.data[a].ctr=+parseFloat(e.data[a].ctr).toFixed(4),e.data[a].conversions=+parseFloat(e.data[a].conversions).toFixed(4),e.data[a].impression=+parseFloat(e.data[a].impression).toFixed(4),e.data[a].cpa=+parseFloat(e.data[a].cpa).toFixed(4),e.data[a].cpc=+parseFloat(e.data[a].cpc).toFixed(4),e.data[a].clicks=+parseFloat(e.data[a].clicks).toFixed(4),e.data[a].cost=+parseFloat(e.data[a].mediaspent).toFixed(4),e.data[a].day=t.moment(e.data[a].day).format("DD/MM");return e.data})["catch"](function(e){return e})}function o(e,a,n,o){return new t.DevExpress.data.CustomStore({totalCount:function(){return 0},load:function(){return i(e,a,n,o)}})}var r=this;r.nameCampaigns=n,r.getChartStore=o}e.$inject=["$http","$window","$cookies"],angular.module("pjtLayout").service("VideoCampMain",e)}(),function(){"use strict";function e(e,t,a,n,i,o,r,s){function d(){for(var e in a.checkChartVideo)a.checkChartVideo[e]?("imp"==e&&l.chartOptionsFunc.getSeriesByName("Impressions").show(),"ad_starts"==e&&l.chartOptionsFunc.getSeriesByName("ad_starts").show(),"fill_rate"==e&&l.chartOptionsFunc.getSeriesByName("fill_rate").show(),"profit_loss"==e&&l.chartOptionsFunc.getSeriesByName("profit_loss").show(),"spend"==e&&l.chartOptionsFunc.getSeriesByName("Cost").show()):("imp"==e&&l.chartOptionsFunc.getSeriesByName("Impressions").hide(),"ad_starts"==e&&l.chartOptionsFunc.getSeriesByName("ad_starts").hide(),"fill_rate"==e&&l.chartOptionsFunc.getSeriesByName("fill_rate").hide(),"profit_loss"==e&&l.chartOptionsFunc.getSeriesByName("profit_loss").hide(),"spend"==e&&l.chartOptionsFunc.getSeriesByName("Cost").hide())}var l=this,c=n.instant;new Date;s.id=r.id,s.name=r.campaign,s.line_item=r.line_item,s.line_item_id=r.line_item_id,null==a.campaign&&t.go("home.main"),l.campName=r.campaign,l.campId=r.id,l.line_item=r.line_item,l.line_item_id=r.line_item_id,l.Init=[],null==a.checkChartVideo&&(a.checkChartVideo={imp:!0,ad_starts:!1,fill_rate:!1,profit_loss:!1,spend:!1}),l.onlyTwo=function(e){var t=0,a=[],n=[];for(t=0;t<l.Init.length;t++)1==l.Init[t]._options.value?a.push(l.Init[t]):n.push(l.Init[t]);if(1==e){if(2==a.length&&n.length>2)for(t=0;t<n.length;t++)n[t].option("disabled",!0)}else if(a.length<=2)for(t=0;t<n.length;t++)n[t].option("disabled",!1)},l.updateCharts=function(t,n,i){var o={};a.checkChartVideo[n]=i;var r=0;if(i)for(l.chartOptionsFunc.getSeriesByName(t).show(),o=e.$(".chartMulti"),r=0;r<o.length;r++)e.$(o[r]).dxChart("instance").getSeriesByName(t).show();else for(l.chartOptionsFunc.getSeriesByName(t).hide(),o=e.$(".chartMulti"),r=0;r<o.length;r++)e.$(o[r]).dxChart("instance").getSeriesByName(t).hide()},angular.element(e.document.querySelector("#wrapper"))[0].classList.remove("hidden-menu"),null==a.SelectedTime?(a.SelectedTime=0,a.dataStart=e.moment({hour:"00"}).subtract(1,"day").unix(),a.dataEnd=e.moment({hour:"00"}).subtract(1,"day").endOf("day").unix(),l.dataStart=e.moment({hour:"00"}).subtract(1,"day").unix(),l.dataEnd=e.moment({hour:"00"}).subtract(1,"day").endOf("day").unix()):null==a.dataStart||null==a.dataEnd?(a.SelectedTime=0,a.dataStart=e.moment({hour:"00"}).subtract(1,"day").unix(),a.dataEnd=e.moment({hour:"00"}).subtract(1,"day").endOf("day").unix(),l.dataStart=e.moment({hour:"00"}).subtract(1,"day").unix(),l.dataEnd=e.moment({hour:"00"}).subtract(1,"day").endOf("day").unix()):(l.dataStart=a.dataStart,l.dataEnd=a.dataEnd);var u=[{ID:0,Name:c("MAIN.DATE_PICKER.YESTERDAY"),dataStart:e.moment({hour:"00"}).subtract(1,"day").unix(),dataEnd:e.moment({hour:"00"}).subtract(1,"day").endOf("day").unix()},{ID:1,Name:c("MAIN.DATE_PICKER.LAST_3_DAYS"),dataStart:e.moment({hour:"00"}).subtract(3,"day").unix(),dataEnd:e.moment({hour:"00"}).unix()},{ID:2,Name:c("MAIN.DATE_PICKER.LAST_7_DAYS"),dataStart:e.moment({hour:"00"}).subtract(7,"day").unix(),dataEnd:e.moment({hour:"00"}).unix()},{ID:3,Name:c("MAIN.DATE_PICKER.LAST_14_DAYS"),dataStart:e.moment({hour:"00"}).subtract(14,"day").unix(),dataEnd:e.moment({hour:"00"}).unix()},{ID:4,Name:c("MAIN.DATE_PICKER.LAST_21_DAYS"),dataStart:e.moment({hour:"00"}).subtract(21,"day").unix(),dataEnd:e.moment({hour:"00"}).unix()},{ID:5,Name:c("MAIN.DATE_PICKER.CURRENT_MONTH"),dataStart:e.moment().startOf("month").unix(),dataEnd:e.moment().unix()},{ID:6,Name:c("MAIN.DATE_PICKER.LAST_MONTH"),dataStart:e.moment().subtract(1,"month").startOf("month").unix(),dataEnd:e.moment().subtract(1,"month").endOf("month").unix()},{ID:7,Name:c("MAIN.DATE_PICKER.LAST_90_DAYS"),dataStart:e.moment({hour:"00"}).subtract(90,"day").unix(),dataEnd:e.moment().unix()},{ID:8,Name:c("MAIN.DATE_PICKER.ALL_TIME"),dataStart:0,dataEnd:e.moment().unix()}],m=[{valueField:"imp",name:"Impressions",axis:"imp",visible:a.checkChartVideo.imp},{valueField:"ad_starts",name:"ad_starts",axis:"ad_starts",visible:a.checkChartVideo.ad_starts},{valueField:"fill_rate",name:"fill_rate",axis:"fill_rate",visible:a.checkChartVideo.fill_rate},{valueField:"profit_loss",name:"profit_loss",axis:"profit_loss",visible:a.checkChartVideo.profit_loss},{valueField:"spend",name:"Cost",axis:"spend",visible:a.checkChartVideo.spend}];l.chartStore=o.getChartStore(r.id,l.dataStart,l.dataEnd,["imp","spend","ad_starts","fill_rate","profit_loss"]),l.UI={datePiker:{items:u,displayExpr:"Name",valueExpr:"ID",value:u[a.SelectedTime].ID,onValueChanged:function(e){a.SelectedTime=e.value,a.dataStart=u[e.value].dataStart,a.dataEnd=u[e.value].dataEnd,t.reload()}},chartOptions:{onDone:function(){var e=$("#chart").dxChart("instance");if(!l.charIsUpdating){var t=[],n="left";l.UI.chartOptions.valueAxis.forEach(function(i,o){var r=a.checkChartVideo[i.name];t.push({name:i.name,position:n,label:{format:"percent",alignment:"center",customizeText:function(){l.charIsUpdating=!0;var t=e._valueAxes[o]._majorTicks,a=null;if(Array.isArray(t)&&a<t[t.length-1].value&&(a=t[t.length-1].value),this.value==a)switch(i.name){case"imp":return'<span style="color:black; font-weight: bolder; text-decoration:underline;">'+c("MAIN.CHECKBOX.IMPRESSIONS")+"</span><br>"+this.value.toString().split(/(?=(?:\d{3})+(?!\d))/).join();case"ad_starts":return'<span style="color:black; font-weight: bolder; text-decoration:underline;">'+c("MAIN.CHECKBOX.fill_rate")+"</span><br>"+this.value;case"fill_rate":return'<span style="color:black; font-weight: bolder; text-decoration:underline;">'+c("MAIN.CHECKBOX.fill_rate")+"</span><br>"+this.value;case"profit_loss":return'<span style="color:black; font-weight: bolder; text-decoration:underline;">'+c("MAIN.CHECKBOX.profit_loss")+"</span><br>"+this.value;case"spend":return'<span style="color:black; font-weight: bolder; text-decoration:underline;">'+c("MAIN.CHECKBOX.COST")+"</span><br>"+this.value;default:return'<span style="color:black; font-weight: bolder; text-decoration:underline;">'+i.name+"</span><br>"+this.value}else switch(i.name){case"imp":return this.value.toString().split(/(?=(?:\d{3})+(?!\d))/).join()}return this.value}}}),r&&(n="left"==n?"right":"left")}),e.option("valueAxis",t)}},onInitialized:function(e){l.chartOptionsFunc=e.component},series:m,bindingOptions:{dataSource:"videocamp.chartStore"},commonSeriesSettings:{argumentField:"day",type:"Line",point:{size:6,hoverStyle:{border:{visible:!0,width:2},size:5}}},tooltip:{enabled:!0,customizeTooltip:function(e){return{text:e.valueText}}},crosshair:{enabled:!0,color:"deepskyblue",visible:!0,horizontalLine:{label:{visible:!0,customizeText:function(e){return"Cost"==e.point.series.name||"CPC"==e.point.series.name?"$"+this.value:"Impressions"==e.point.series.name?this.value.toString().split(/(?=(?:\d{3})+(?!\d))/).join():"CTR"==e.point.series.name||"CVR"==e.point.series.name?this.value+"%":void 0}}},verticalLine:{label:{visible:!0}}},commonAxisSettings:{valueMarginsEnabled:!0},margin:{bottom:20},argumentAxis:{discreteAxisDivisionMode:"crossLabels",grid:{visible:!0}},valueAxis:[{name:"imp",position:"left",label:{format:"percent"}},{name:"ad_starts",position:"left"},{name:"fill_rate",position:"left"},{name:"spend",position:"left"},{name:"profit_loss",position:"left"}],legend:{verticalAlignment:"bottom",horizontalAlignment:"center",itemTextPosition:"bottom"}},impressions:{text:c("MAIN.CHECKBOX.IMPRESSIONS"),value:a.checkChartVideo.imp,onInitialized:function(e){l.Init.push(e.component)},onValueChanged:function(e){l.updateCharts("Impressions","imp",e.value),l.onlyTwo(e.value),l.charIsUpdating=!1,l.UI.chartOptions.onDone(),d()}},ad_starts:{text:c("MAIN.CHECKBOX.ad_starts"),value:a.checkChartVideo.ad_starts,onInitialized:function(e){l.Init.push(e.component)},onValueChanged:function(e){l.updateCharts("ad_starts","ad_starts",e.value),l.onlyTwo(e.value),l.charIsUpdating=!1,l.UI.chartOptions.onDone(),d()}},fill_rate:{text:c("MAIN.CHECKBOX.fill_rate"),value:a.checkChartVideo.fill_rate,onInitialized:function(e){l.Init.push(e.component)},onValueChanged:function(e){l.updateCharts("fill_rate","fill_rate",e.value),l.onlyTwo(e.value),l.charIsUpdating=!1,l.UI.chartOptions.onDone(),d()}},profit_loss:{text:c("MAIN.CHECKBOX.profit_loss"),value:a.checkChartVideo.profit_loss,onInitialized:function(e){l.Init.push(e.component)},onValueChanged:function(e){l.updateCharts("profit_loss","profit_loss",e.value),l.onlyTwo(e.value),l.charIsUpdating=!1,l.UI.chartOptions.onDone(),d()}},cost:{text:c("MAIN.CHECKBOX.COST"),value:a.checkChartVideo.spend,onInitialized:function(e){l.Init.push(e.component)},onValueChanged:function(e){l.updateCharts("Cost","spend",e.value),l.onlyTwo(e.value),l.charIsUpdating=!1,l.UI.chartOptions.onDone(),d()}}}}e.$inject=["$window","$state","$localStorage","$translate","$timeout","VideoCampMain","Campaign","$rootScope"],angular.module("pjtLayout").controller("VideoCampaignController",e)}(),function(){"use strict";function e(e,t,a){function n(n){return e({method:"GET",headers:{Authorization:"Token "+t.get("token")},url:"/api/v1/advertiser/campaign/all",params:{id:n}}).then(function(e){return e.data})["catch"](function(e){a.DevExpress.ui.notify(e.statusText,"error",4e3)})}function i(n,i,o){return e({method:"POST",headers:{Authorization:"Token "+t.get("token")},url:"/api/v1/campaign/create/bulk",data:{advertiserId:n,campaignId:i,domain:o}}).then(function(e){return e.data})["catch"](function(e){return a.DevExpress.ui.notify(e.statusText,"error",4e3),!1})}var o=this;o.campaignList=n,o.campaignCreateBulk=i}e.$inject=["$http","$cookies","$window"],angular.module("pjtLayout").service("BCC",e)}(),function(){"use strict";function e(e,t,a,n,i,o){var r,s,d=this,l=n.instant;d.loadindicatorVisible=!1,d.message=!1,d.campName=o.campaign,d.campId=o.id,d.line_item=o.line_item,d.line_item_id=o.line_item_id,null==a.campaign&&t.go("home.main"),i.campaignList(a.advertiser.id).then(function(e){d.selectCampaignStore=e}),null==a.SelectedTime?(a.SelectedTime=0,a.dataStart=e.moment({hour:"00"}).subtract(1,"day").unix(),a.dataEnd=e.moment({hour:"00"}).subtract(1,"day").endOf("day").unix(),d.dataStart=e.moment({hour:"00"}).subtract(1,"day").unix(),d.dataEnd=e.moment({hour:"00"}).subtract(1,"day").endOf("day").unix()):null==a.dataStart||null==a.dataEnd?(a.SelectedTime=0,a.dataStart=e.moment({hour:"00"}).subtract(1,"day").unix(),a.dataEnd=e.moment({hour:"00"}).subtract(1,"day").endOf("day").unix(),d.dataStart=e.moment({hour:"00"}).subtract(1,"day").unix(),d.dataEnd=e.moment({hour:"00"}).subtract(1,"day").endOf("day").unix()):(d.dataStart=a.dataStart,d.dataEnd=a.dataEnd);var c=[{ID:0,Name:l("MAIN.DATE_PICKER.YESTERDAY"),dataStart:e.moment({hour:"00"}).subtract(1,"day").unix(),dataEnd:e.moment({hour:"00"}).subtract(1,"day").endOf("day").unix()},{ID:1,Name:l("MAIN.DATE_PICKER.LAST_3_DAYS"),dataStart:e.moment({hour:"00"}).subtract(3,"day").unix(),dataEnd:e.moment({hour:"00"}).unix()},{ID:2,Name:l("MAIN.DATE_PICKER.LAST_7_DAYS"),dataStart:e.moment({hour:"00"}).subtract(7,"day").unix(),dataEnd:e.moment({hour:"00"}).unix()},{ID:3,Name:l("MAIN.DATE_PICKER.LAST_14_DAYS"),dataStart:e.moment({hour:"00"}).subtract(14,"day").unix(),dataEnd:e.moment({hour:"00"}).unix()},{ID:4,Name:l("MAIN.DATE_PICKER.LAST_21_DAYS"),dataStart:e.moment({hour:"00"}).subtract(21,"day").unix(),dataEnd:e.moment({hour:"00"}).unix()},{ID:5,Name:l("MAIN.DATE_PICKER.CURRENT_MONTH"),dataStart:e.moment().startOf("month").unix(),dataEnd:e.moment().unix()},{ID:6,Name:l("MAIN.DATE_PICKER.LAST_MONTH"),dataStart:e.moment().subtract(1,"month").startOf("month").unix(),dataEnd:e.moment().subtract(1,"month").endOf("month").unix()},{ID:7,Name:l("MAIN.DATE_PICKER.LAST_90_DAYS"),dataStart:e.moment({hour:"00"}).subtract(90,"day").unix(),dataEnd:e.moment().unix()},{ID:8,Name:l("MAIN.DATE_PICKER.ALL_TIME"),dataStart:0,dataEnd:e.moment().unix()}];d.UI={loadPanel:{shadingColor:"rgba(0,0,0,0.4)",bindingOptions:{visible:"bcc.loadindicatorVisible"},showIndicator:!0,showPane:!0,shading:!0,closeOnOutsideClick:!1},send:{text:l("BCC.CREATE"),onClick:function(){return r&&null!=r?s&&null!=s?(d.loadindicatorVisible=!0,i.campaignCreateBulk(a.advertiser.id,r,s).then(function(e){return 0==e?void(d.loadindicatorVisible=!1):(d.message="Created campaigns: "+e,void(d.loadindicatorVisible=!1))})):void e.DevExpress.ui.notify("Insert the list of domains please","warning",4e3):void e.DevExpress.ui.notify("Select campaign please","warning",4e3)}},searchOptions:{displayExpr:"name",valueExpr:"id",searchEnabled:!0,bindingOptions:{dataSource:"bcc.selectCampaignStore"
},onValueChanged:function(e,t){r=e.value}},domainArea:{height:150,placeholder:l("BCC.PLACEHOLDER-DOMAIN"),onValueChanged:function(e){s=e.value}},datePiker:{items:c,displayExpr:"Name",valueExpr:"ID",value:c[a.SelectedTime].ID,onValueChanged:function(e){a.SelectedTime=e.value,a.dataStart=c[e.value].dataStart,a.dataEnd=c[e.value].dataEnd,t.reload()}}}}e.$inject=["$window","$state","$localStorage","$translate","BCC","Campaign"],angular.module("pjtLayout").controller("BCCController",e)}(),function(){"use strict";function e(e,t,a){function n(n,i){return e({method:"POST",url:"/api/v1/campaigns/"+n+"/rules",headers:{Authorization:"Token "+t.get("token")},data:{ruleObj:i}}).then(function(e){return e.data})["catch"](function(e){a.DevExpress.ui.notify(e.statusText,"error",4e3)})}function i(n){return e({method:"GET",url:"/api/v1/campaigns/"+n+"/rules",headers:{Authorization:"Token "+t.get("token")}}).then(function(e){return e.data})["catch"](function(e){a.DevExpress.ui.notify(e.statusText,"error",4e3)})}var o=this;o.saveRules=n,o.getRules=i}e.$inject=["$http","$cookies","$window"],angular.module("pjtLayout").service("Rules",e)}(),function(){"use strict";function e(e,t,a,n,i,o,r){function s(){c.popUpIf=!1}function d(e,t){"Suspend for review"==t.then?(m=!0,p=e,c.confirmPopup.option("visible",!0)):(delete t.time,delete t.timeString)}function l(){o.saveRules(r.id,c.rulesArray)}var c=this,u=i.instant,m=!1,p="";c.campName=r.campaign,c.campId=r.id,c.line_item=r.line_item,c.line_item_id=r.line_item_id,c.popUpIf=!1,c.arrayDiagram=[],null==n.campaign&&t.go("home.main"),c.saveRules=l,c.popUpHide=s,c.checkTime=d,o.getRules(r.id).then(function(e){e&&(c.rulesArray=e)}),c.addField=function(e){e.$parent.$parent.$parent.$parent.rule?e.$parent.$parent.$parent.$parent.rule.push({type:"logic",logicOrAnd:"and"},{type:"condition",target:"Placement/App",payment:"CPA",compare:">",value:0}):e.$parent.$parent.rules["if"].push({type:"logic",logicOrAnd:"and"},{type:"condition",target:"Placement/App",payment:"cpa",compare:">",value:0})},c.addGroup=function(e,t){e.$parent.$parent.$parent.rule?e.$parent.$parent.$parent.rule.push({type:"logic",logicOrAnd:"and"},[{type:"condition",target:"Placement/App",payment:"cpa",compare:">",value:0}]):e.$parent.rules["if"].push({type:"logic",logicOrAnd:"and"},[{type:"condition",target:"Placement/App",payment:"cpa",compare:">",value:0}])},c.addNewRule=function(){var e=c.rulesArray.length+1;c.rulesArray.push({id:e,"if":[{type:"condition",target:"Placement/App",payment:"cpa",compare:">",value:0}],then:"Blacklist"})},c.deleteRule=function(e){c.rulesArray.splice(e,1)},c.deleteFilds=function(e,t){e.$parent.$parent.$parent.$parent.rule?e.$parent.$parent.$parent.$parent.rule.splice(t,2):e.$parent.$parent.rules["if"].splice(t,2)},c.typeOfLogic=function(e){return"logic"===e.type?!0:!1},c.typeOfThen=function(e){return"Blacklist"===e.then?!0:!1},c.typeOfObject=function(e){return"condition"==e.type?!0:!1},c.typeOfArray=function(e){return 1==Array.isArray(e)?!0:!1},null==n.SelectedTime?(n.SelectedTime=0,n.dataStart=e.moment({hour:"00"}).subtract(1,"day").unix(),n.dataEnd=e.moment({hour:"00"}).subtract(1,"day").endOf("day").unix(),c.dataStart=e.moment({hour:"00"}).subtract(1,"day").unix(),c.dataEnd=e.moment({hour:"00"}).subtract(1,"day").endOf("day").unix()):null==n.dataStart||null==n.dataEnd?(n.SelectedTime=0,n.dataStart=e.moment({hour:"00"}).subtract(1,"day").unix(),n.dataEnd=e.moment({hour:"00"}).subtract(1,"day").endOf("day").unix(),c.dataStart=e.moment({hour:"00"}).subtract(1,"day").unix(),c.dataEnd=e.moment({hour:"00"}).subtract(1,"day").endOf("day").unix()):(c.dataStart=n.dataStart,c.dataEnd=n.dataEnd);var h=[{ID:0,Name:u("MAIN.DATE_PICKER.YESTERDAY"),dataStart:e.moment({hour:"00"}).subtract(1,"day").unix(),dataEnd:e.moment({hour:"00"}).subtract(1,"day").endOf("day").unix()},{ID:1,Name:u("MAIN.DATE_PICKER.LAST_3_DAYS"),dataStart:e.moment({hour:"00"}).subtract(3,"day").unix(),dataEnd:e.moment({hour:"00"}).unix()},{ID:2,Name:u("MAIN.DATE_PICKER.LAST_7_DAYS"),dataStart:e.moment({hour:"00"}).subtract(7,"day").unix(),dataEnd:e.moment({hour:"00"}).unix()},{ID:3,Name:u("MAIN.DATE_PICKER.LAST_14_DAYS"),dataStart:e.moment({hour:"00"}).subtract(14,"day").unix(),dataEnd:e.moment({hour:"00"}).unix()},{ID:4,Name:u("MAIN.DATE_PICKER.LAST_21_DAYS"),dataStart:e.moment({hour:"00"}).subtract(21,"day").unix(),dataEnd:e.moment({hour:"00"}).unix()},{ID:5,Name:u("MAIN.DATE_PICKER.CURRENT_MONTH"),dataStart:e.moment().startOf("month").unix(),dataEnd:e.moment().unix()},{ID:6,Name:u("MAIN.DATE_PICKER.LAST_MONTH"),dataStart:e.moment().subtract(1,"month").startOf("month").unix(),dataEnd:e.moment().subtract(1,"month").endOf("month").unix()},{ID:7,Name:u("MAIN.DATE_PICKER.LAST_90_DAYS"),dataStart:e.moment({hour:"00"}).subtract(90,"day").unix(),dataEnd:e.moment().unix()},{ID:8,Name:u("MAIN.DATE_PICKER.ALL_TIME"),dataStart:0,dataEnd:e.moment().unix()}];c.UI={datePiker:{items:h,displayExpr:"Name",valueExpr:"ID",value:h[n.SelectedTime].ID,onValueChanged:function(e){n.SelectedTime=e.value,n.dataStart=h[e.value].dataStart,n.dataEnd=h[e.value].dataEnd,t.reload()}}}}e.$inject=["$window","$state","$rootScope","$localStorage","$translate","Rules","Campaign"],angular.module("pjtLayout").controller("rulesController",e)}(),function(){"use strict";function e(e,t,a){function n(e,t,n){return new a.DevExpress.data.CustomStore({totalCount:function(){return c},load:function(a){return a.searchOperation&&a.dataField&&(a.take=999999),i(e,t,n,a.skip,a.take,a.sort,a.order,a.filter,a.totalSummary)}})}function i(n,i,o,r,s,d,u,m,p){return d?(u=d[0].desc===!0?"desc":"asc",d=d[0].selector):(d="placement",u="DESC"),null==s&&(s=10),null==r&&(r=0),e({method:"GET",url:"/api/v1/campaigns/"+encodeURI(n)+"/domains",headers:{Authorization:"Token "+t.get("token")},params:{from_date:i,to_date:o,skip:r,take:s,sort:d,order:u,filter:m,totalSummary:p}}).then(function(e){for(var t in e.data.data){var a=[];if(-1==e.data.data[t].analitics.good||-2==e.data.data[t].analitics.good||-3==e.data.data[t].analitics.good)a=null;else{var n=e.data.data[t].analitics.bad,i=e.data.data[t].analitics.good,o=1,r=1,s=+(100*n/(n+i));(.5>=s/100&&s/100>.45||.5>=(100-s)/100&&(100-s)/100>.45)&&(o=.03,r=.03),(.45>s/100&&s/100>.4||.45>(100-s)/100&&(100-s)/100>.4)&&(o=.09,r=.09),(.4>s/100&&s/100>.3||.4>(100-s)/100&&(100-s)/100>.3)&&(o=.2,r=.2),(.3>s/100&&s/100>.2||.3>(100-s)/100&&(100-s)/100>.2)&&(o=.5,r=.5),(.2>s/100&&s/100>.1||.2>(100-s)/100&&(100-s)/100>.1)&&(o=.7,r=.7),(.1>s/100&&s/100>0||.1>(100-s)/100&&(100-s)/100>0)&&(o=1,r=1);var d=100-s+"%",u=s+"%";a={good:e.data.data[t].analitics.good,bad:e.data.data[t].analitics.bad,checked:e.data.data[t].analitics.checked,badDiagram:u,goodDiagram:d,badOpasity:o,goodOpasity:r,k:s}}var m=[];if(-1==e.data.data[t].analitics1.good||-2==e.data.data[t].analitics1.good||-3==e.data.data[t].analitics1.good)m=null;else{var n=e.data.data[t].analitics1.bad,i=e.data.data[t].analitics1.good,o=1,r=1,s=+(100*n/(n+i));(.5>=s/100&&s/100>.45||.5>=(100-s)/100&&(100-s)/100>.45)&&(o=.03,r=.03),(.45>s/100&&s/100>.4||.45>(100-s)/100&&(100-s)/100>.4)&&(o=.09,r=.09),(.4>s/100&&s/100>.3||.4>(100-s)/100&&(100-s)/100>.3)&&(o=.2,r=.2),(.3>s/100&&s/100>.2||.3>(100-s)/100&&(100-s)/100>.2)&&(o=.5,r=.5),(.2>s/100&&s/100>.1||.2>(100-s)/100&&(100-s)/100>.1)&&(o=.7,r=.7),(.1>s/100&&s/100>0||.1>(100-s)/100&&(100-s)/100>0)&&(o=1,r=1);var d=100-s+"%",u=s+"%";m={good:e.data.data[t].analitics1.good,bad:e.data.data[t].analitics1.bad,checked:e.data.data[t].analitics1.checked,badDiagram:u,goodDiagram:d,badOpasity:o,goodOpasity:r,k:s}}e.data.data[t].cvr=parseFloat((e.data.data[t].cvr||0).toFixed(2)/100),e.data.data[t].ctr=parseFloat((e.data.data[t].ctr||0).toFixed(2)/100),e.data.data[t].cpc=parseFloat((e.data.data[t].cpc||0).toFixed(4)),e.data.data[t].cpm=parseFloat((e.data.data[t].cpm||0).toFixed(4)),e.data.data[t].imp=parseFloat((e.data.data[t].imp||0).toFixed(4)),e.data.data[t].cpa=parseFloat((e.data.data[t].cpa||0).toFixed(4)),e.data.data[t].clicks=parseFloat((e.data.data[t].clicks||0).toFixed(4)),e.data.data[t].conv=parseFloat((e.data.data[t].conv||0).toFixed(4)),e.data.data[t].cost=parseFloat((e.data.data[t].cost||0).toFixed(2)),e.data.data[t].analitics=a,e.data.data[t].analitics1=m,e.data.data[t].imps_viewed=parseFloat((e.data.data[t].imps_viewed||0).toFixed(4)),e.data.data[t].view_measured_imps=parseFloat((e.data.data[t].view_measured_imps||0).toFixed(4)),e.data.data[t].view_measurement_rate=parseFloat((e.data.data[t].view_measurement_rate||0).toFixed(1)/100),e.data.data[t].view_rate=parseFloat((e.data.data[t].view_rate||0).toFixed(1)/100),e.data.data[t].state={blackList:2&e.data.data[t].state,suspended:1&e.data.data[t].state,whiteList:4&e.data.data[t].state}}return c=e.data.totalCount,l.totalSummary=e.data.totalSummary,e.data.data})["catch"](function(e){a.DevExpress.ui.notify(e.data.detail,"error",4e3)})}function o(e,t,a){return{domains:["about.com","celebritytoob.com","lotto.pch.com","verywell.com"],geo:["US","UK","NZ"],device:["Desktops & Laptops","AND","Web"],block:["Phones","Tablets","Mobile web","Apps"]}}function r(n,i,o,r){return e({method:"POST",url:"/api/v1/campaigns/"+encodeURI(n)+"/changestate",headers:{Authorization:"Token "+t.get("token")},data:{placement:i,activeState:o,suspendTimes:r}}).then(function(e){return e.data})["catch"](function(e){a.DevExpress.ui.notify(e.data.detail,"error",4e3)})}function s(n,i,o,r){return e({method:"POST",url:"/api/v1/campaigns/"+n+"/MLPlacement",headers:{Authorization:"Token "+t.get("token")},data:{placementId:i,checked:o,test_type:r,test_name:"ctr_cvr_cpc_cpm_cpa",day:7}}).then(function(e){return e.data})["catch"](function(e){a.DevExpress.ui.notify(e.statusText,"error",4e3)})}function d(n,i){return e({method:"GET",url:"/api/v1/campaigns/"+n+"/MLPlacement",headers:{Authorization:"Token "+t.get("token")},params:{placementId:i,test_type:"kmeans",test_name:"ctr_cvr_cpc_cpm_cpa"}}).then(function(e){var t=[];for(var a in e.data)if(-1==e.data[a].good||-2==e.data[a].good||-3==e.data[a].good)t[a]=!1;else{"0"==e.data[a].day&&(e.data[a].day="Sunday"),"1"==e.data[a].day&&(e.data[a].day="Monday"),"2"==e.data[a].day&&(e.data[a].day="Tuesday"),"3"==e.data[a].day&&(e.data[a].day="Wednesday"),"4"==e.data[a].day&&(e.data[a].day="Thursday"),"5"==e.data[a].day&&(e.data[a].day="Friday"),"6"==e.data[a].day&&(e.data[a].day="Saturday"),"7"==e.data[a].day&&(e.data[a].day="All week");var n=e.data[a].bad,i=e.data[a].good,o=1,r=1,s=+(100*n/(n+i));(.5>=s/100&&s/100>=.45||.5>=(100-s)/100&&(100-s)/100>.45)&&(o=.03,r=.03),(.45>s/100&&s/100>.4||.45>=(100-s)/100&&(100-s)/100>.4)&&(o=.09,r=.09),(.4>=s/100&&s/100>.3||.4>=(100-s)/100&&(100-s)/100>.3)&&(o=.2,r=.2),(.3>=s/100&&s/100>.2||.3>=(100-s)/100&&(100-s)/100>.2)&&(o=.5,r=.5),(.2>=s/100&&s/100>.1||.2>=(100-s)/100&&(100-s)/100>.1)&&(o=.7,r=.7),(.1>=s/100&&s/100>0||.1>=(100-s)/100&&(100-s)/100>0)&&(o=1,r=1);var d=100-s+"%",l=s+"%";t.push({day:e.data[a].day,good:e.data[a].good,bad:e.data[a].bad,checked:e.data[a].checked,badDiagram:l,goodDiagram:d,badOpasity:o,goodOpasity:r,k:s})}return t})["catch"](function(e){a.DevExpress.ui.notify(e.statusText,"error",4e3)})}var l=this,c=0;l.showAllMLDiagram=d,l.decisionML=s,l.campaignTargeting=o,l.editCampaignDomains=r,l.getGridCampaignStore=n}e.$inject=["$http","$cookies","$window"],angular.module("pjtLayout").service("CampaignOptimiser",e)}(),function(){"use strict";function e(e,t,a,n,i,o,r,s,d){function l(){u.popUpIf=!1}function c(t,a){return t.dataSource.postProcess=function(t){var n=e._.uniqBy(t,a);return n.map(function(e){return{text:e[a],value:e[a]}})}}var u=this,m=o.instant,p=null,h={},v=!1;u.campName=d.campaign,u.campId=d.id,u.line_item=d.line_item,u.line_item_id=d.line_item_id,u.object=s.campaignTargeting(1,1,1),u.popUpIf=!1,u.arrayDiagram=[],u.popUpHide=l,null==n.SelectedTime?(n.SelectedTime=0,n.dataStart=e.moment({hour:"00"}).subtract(1,"day").unix(),n.dataEnd=e.moment({hour:"00"}).subtract(1,"day").endOf("day").unix(),u.dataStart=e.moment({hour:"00"}).subtract(1,"day").unix(),u.dataEnd=e.moment({hour:"00"}).subtract(1,"day").endOf("day").unix()):null==n.dataStart||null==n.dataEnd?(n.SelectedTime=0,n.dataStart=e.moment({hour:"00"}).subtract(1,"day").unix(),n.dataEnd=e.moment({hour:"00"}).subtract(1,"day").endOf("day").unix(),u.dataStart=e.moment({hour:"00"}).subtract(1,"day").unix(),u.dataEnd=e.moment({hour:"00"}).subtract(1,"day").endOf("day").unix()):(u.dataStart=n.dataStart,u.dataEnd=n.dataEnd);var C=[{ID:0,Name:m("MAIN.DATE_PICKER.YESTERDAY"),dataStart:e.moment({hour:"00"}).subtract(1,"day").unix(),dataEnd:e.moment({hour:"00"}).subtract(1,"day").endOf("day").unix()},{ID:1,Name:m("MAIN.DATE_PICKER.LAST_3_DAYS"),dataStart:e.moment({hour:"00"}).subtract(3,"day").unix(),dataEnd:e.moment({hour:"00"}).unix()},{ID:2,Name:m("MAIN.DATE_PICKER.LAST_7_DAYS"),dataStart:e.moment({hour:"00"}).subtract(7,"day").unix(),dataEnd:e.moment({hour:"00"}).unix()},{ID:3,Name:m("MAIN.DATE_PICKER.LAST_14_DAYS"),dataStart:e.moment({hour:"00"}).subtract(14,"day").unix(),dataEnd:e.moment({hour:"00"}).unix()},{ID:4,Name:m("MAIN.DATE_PICKER.LAST_21_DAYS"),dataStart:e.moment({hour:"00"}).subtract(21,"day").unix(),dataEnd:e.moment({hour:"00"}).unix()},{ID:5,Name:m("MAIN.DATE_PICKER.CURRENT_MONTH"),dataStart:e.moment().startOf("month").unix(),dataEnd:e.moment().unix()},{ID:6,Name:m("MAIN.DATE_PICKER.LAST_MONTH"),dataStart:e.moment().subtract(1,"month").startOf("month").unix(),dataEnd:e.moment().subtract(1,"month").endOf("month").unix()},{ID:7,Name:m("MAIN.DATE_PICKER.LAST_90_DAYS"),dataStart:e.moment({hour:"00"}).subtract(90,"day").unix(),dataEnd:e.moment().unix()},{ID:8,Name:m("MAIN.DATE_PICKER.ALL_TIME"),dataStart:0,dataEnd:e.moment().unix()}];u.selectedItems=[],u.state="",u.gridStore=s.getGridCampaignStore(u.campId,u.dataStart,u.dataEnd);var g=(new Date(1981,3,27),new Date);u.UI={showGridWhiteList:{text:m("CO.WHITELIST"),onClick:function(e){u.grindIf=1,i.$apply()}},showGridBlackList:{text:m("CO.BLACKLISTED"),onClick:function(e){u.grindIf=2,i.$apply()}},showGridTempSuspendList:{text:m("CO.TEMP-SUSPEND"),onClick:function(e){u.grindIf=3,i.$apply()}},dateFormatPop:{disabled:!0,type:"date",value:g,onValueChanged:function(e){p=e.value}},radioGroupMain:{items:[m("CO.24-HRS"),m("CO.3-DAYS"),m("CO.7-DAYS"),m("CO.SPECIFIC-DATE")],value:m("CO.24-HRS"),onValueChanged:function(e){var t=$("#radioGroupSend").dxRadioGroup("instance");if(e.value)if(t.option("value",!1),e.value==m("CO.SPECIFIC-DATE")){var a=$("#dateFormatPop").dxDateBox("instance");a.option("disabled",!1)}else{var a=$("#dateFormatPop").dxDateBox("instance");a.option("disabled",!0),p=null}}},radioGroupSend:{items:[m("CO.SEND-TO-SUSPEND-LIST")],onValueChanged:function(e){p=null;var t=$("#dateFormatPop").dxDateBox("instance");t.option("disabled",!0);var a=$("#radioGroupMain").dxRadioGroup("instance");e.value&&a.option("value",!1)}},confirmPopup:{onInitialized:function(e){u.confirmPopup=e.component},bindingOptions:{visible:"crc.confirmPopupVisible"},showTitle:!1,width:320,height:300},confirmPopupOk:{width:110,text:"OK",disabled:!1,onClick:function(){v=!0;var t,a=$("#radioGroupMain").dxRadioGroup("instance"),n=$("#radioGroupSend").dxRadioGroup("instance");a._options.value!==!1&&(a._options.value==m("CO.24-HRS")&&(t=e.moment().add(1,"day").unix()),a._options.value==m("CO.3-DAYS")&&(t=e.moment().add(3,"day").unix()),a._options.value==m("CO.7-DAYS")&&(t=e.moment().add(7,"day").unix())),n._options.value!==!1&&(t="unlimited"),null!==p&&(t=e.moment(p).unix()),null==n._options.value&&a._options.value==m("CO.24-HRS")&&(t=e.moment().add(1,"day").unix());for(var o=0;o<h.placement.length;o++){var r=e.$("div.state-white"+h.placement[o]),d=e.$("div.state-black"+h.placement[o]),l=e.$("div.state-suspended"+h.placement[o]);r.dxButton("instance").option("disabled",!0),d.dxButton("instance").option("disabled",!0),l.dxButton("instance").option("disabled",!0),r.removeClass("active"),d.removeClass("active"),l.removeClass("active")}s.editCampaignDomains(u.campId,h.placement,1,t).then(function(t){for(var a=0;a<h.placement.length;a++){var n=e.$("div.state-black"+h.placement[a]),i=e.$("div.state-white"+h.placement[a]),o=e.$("div.state-suspended"+h.placement[a]);if(i.dxButton("instance").option("disabled",!1),n.dxButton("instance").option("disabled",!1),o.dxButton("instance").option("disabled",!1),404==t)return e.DevExpress.ui.notify("Not found","warning",4e3),e.$(".gridContainerWhite").dxDataGrid("instance").refresh(),t;if(503==t)return e.DevExpress.ui.notify("Not connect to appnexus server, please try again later","warning",4e3),e.$(".gridContainerWhite").dxDataGrid("instance").refresh(),t;"Unactive"!==t&&o.addClass("active")}v=!1}),u.confirmPopupVisible=!1,u.confirmPopup.option("visible",!1),i.$apply()}},confirmPopupCancel:{width:120,text:m("COMMON.CANCEL"),onClick:function(){v=!1,u.confirmPopup.option("visible",!1),i.$apply()}},navCamp:{text:m("CO.CAMPAIGN-HOME"),onClick:function(){t.go("home.campaign.details",{id:u.campId})}},datePiker:{items:C,displayExpr:"Name",valueExpr:"ID",value:C[n.SelectedTime].ID,onValueChanged:function(e){n.SelectedTime=e.value,n.dataStart=C[e.value].dataStart,n.dataEnd=C[e.value].dataEnd,t.reload()}},dataGridOptionsCampaign:{editing:{mode:"batch",allowUpdating:!0},loadPanel:{shadingColor:"rgba(0,0,0,0.4)",visible:!1,showIndicator:!0,showPane:!0,shading:!0,closeOnOutsideClick:!1},alignment:"left",headerFilter:{visible:!0},filterRow:{visible:!0,applyFilter:"auto"},bindingOptions:{dataSource:"CO.gridStore"},paging:{pageSize:10},remoteOperations:!0,pager:{showPageSizeSelector:!0,allowedPageSizes:[10,30,50],visible:!0,showNavigationButtons:!0},allowColumnReordering:!0,allowColumnResizing:!0,columnAutoWidth:!0,wordWrapEnabled:!0,showBorders:!0,showRowLines:!0,columns:[{caption:m("CAMP.CAMPAIGN.COLUMNS.PLACEMENT"),dataField:"placement",alignment:"center",dataType:"number",allowEditing:!1,headerFilter:{dataSource:function(e){return c(e,"placement")}}},{caption:m("CAMP.CAMPAIGN.COLUMNS.DOMAIN"),dataField:"placement__rtbimpressiontrackerplacementdomain__domain",alignment:"center",dataType:"string",allowEditing:!1,headerFilter:{dataSource:function(e){return c(e,"domain")}}},{caption:m("CAMP.CAMPAIGN.COLUMNS.NETWORK"),dataField:"NetworkPublisher",alignment:"center",dataType:"string",allowEditing:!1,headerFilter:{dataSource:function(e){return c(e,"NetworkPublisher")}}},{caption:m("CAMP.CAMPAIGN.COLUMNS.CONV"),dataField:"conv",alignment:"center",dataType:"number",allowEditing:!1,headerFilter:{dataSource:function(e){return c(e,"conv")}}},{caption:m("CAMP.CAMPAIGN.COLUMNS.IMP"),dataField:"imp",dataType:"number",sortOrder:"desc",format:"fixedPoint",alignment:"center",allowEditing:!1,headerFilter:{dataSource:function(e){return c(e,"imp")}}},{caption:m("CAMP.CAMPAIGN.COLUMNS.CPA")+" ,$",dataField:"cpa",dataType:"number",alignment:"center",format:"currency",precision:4,allowEditing:!1,headerFilter:{dataSource:function(e){return c(e,"cpa")}}},{caption:m("CAMP.CAMPAIGN.COLUMNS.COST")+" ,$",dataField:"cost",alignment:"center",format:"currency",precision:2,dataType:"number",allowEditing:!1,headerFilter:{dataSource:function(e){return c(e,"cost")}}},{caption:m("CAMP.CAMPAIGN.COLUMNS.CLICKS"),dataField:"clicks",alignment:"center",dataType:"number",allowEditing:!1,headerFilter:{dataSource:function(e){return c(e,"clicks")}}},{caption:m("CAMP.CAMPAIGN.COLUMNS.CPC")+" ,$",dataField:"cpc",alignment:"center",dataType:"number",format:"currency",precision:4,allowEditing:!1,headerFilter:{dataSource:function(e){return c(e,"cpc")}}},{caption:m("CAMP.CAMPAIGN.COLUMNS.CPM")+" ,$",dataField:"cpm",alignment:"center",dataType:"number",format:"currency",precision:4,allowEditing:!1,headerFilter:{dataSource:function(e){return c(e,"cpm")}}},{caption:m("CAMP.CAMPAIGN.COLUMNS.CVR")+" ,%",dataField:"cvr",alignment:"center",dataType:"number",format:"percent",precision:2,allowEditing:!1,headerFilter:{dataSource:function(e){return c(e,"cvr")}}},{caption:m("CAMP.CAMPAIGN.COLUMNS.CTR")+" ,%",dataField:"ctr",alignment:"center",dataType:"number",format:"percent",precision:2,allowEditing:!1,headerFilter:{dataSource:function(e){return c(e,"ctr")}}},{caption:m("CAMP.CAMPAIGN.COLUMNS.IMPS_VIEWED"),dataField:"imps_viewed",alignment:"center",visible:!1,width:80,format:"fixedPoint",dataType:"number",allowEditing:!1,headerFilter:{dataSource:function(e){return c(e,"imps_viewed")}}},{caption:m("CAMP.CAMPAIGN.COLUMNS.VIEW_MEASURED_IMPS"),dataField:"view_measured_imps",alignment:"center",format:"fixedPoint",visible:!1,width:100,dataType:"number",headerFilter:{dataSource:function(e){return c(e,"view_measured_imps")}}},{caption:m("CAMP.CAMPAIGN.COLUMNS.VIEW_MEASUREMENT_RATE")+" ,%",dataField:"view_measurement_rate",alignment:"center",format:"percent",precision:1,visible:!1,width:120,dataType:"number",headerFilter:{dataSource:function(e){return c(e,"view_measurement_rate")}}},{caption:m("CAMP.CAMPAIGN.COLUMNS.VIEW_RATE")+" ,%",dataField:"view_rate",alignment:"center",format:"percent",precision:1,visible:!1,width:80,dataType:"number",headerFilter:{dataSource:function(e){return c(e,"view_rate")}}},{caption:m("CAMP.CAMPAIGN.COLUMNS.PREDICTION_1"),width:115,dataField:"analytics",allowEditing:!1,cellTemplate:function(t,a){if(u.arrayDiagram.push(a.data),null===a.data.analitics);else{var n=(a.data.analitics.bad,a.data.analitics.good,a.data.analitics.badOpasity),o=a.data.analitics.goodOpasity,d=a.data.analitics.k,l=a.data.analitics.goodDiagram,c=a.data.analitics.badDiagram,m=r('<div class="analiticCO"><div class="diagramCO"><div class="badDiagramCO" style="width:'+c+";opacity:"+n+';"></div><div class="goodDiagramCO" style="width:'+l+";opacity:"+o+';"></div><p class="textBadDiagramCO" >'+d.toFixed(1)+'%</p><p class="textGoodDiagramCO">'+(100-d).toFixed(1)+'%</p></div><div class="buttonAnaliticCO'+a.data.placement+'"><div class="trueButtonAnaliticCO'+a.data.placement+'"></div><div class="falseButtonAnaliticCO'+a.data.placement+'"></div></div></div>;')(i);m.appendTo(t);var p=e.$(".trueButtonAnaliticCO"+a.data.placement).dxButton({text:"True",disabled:!1,onClick:function(){e.$(".falseButtonAnaliticCO"+a.data.placement).removeClass("active-white"),e.$(".trueButtonAnaliticCO"+a.data.placement).addClass("active-white"),s.decisionML(u.campId,a.data.placement,!0,"kmeans").then(function(e){return e})}}),h=e.$(".falseButtonAnaliticCO"+a.data.placement).dxButton({text:"False",disabled:!1,onClick:function(){e.$(".falseButtonAnaliticCO"+a.data.placement).addClass("active-white"),e.$(".trueButtonAnaliticCO"+a.data.placement).removeClass("active-white"),s.decisionML(u.campId,a.data.placement,!1,"kmeans").then(function(e){return e})}});1==a.data.analitics.checked?p.addClass("active-white").append():p.append(),0==a.data.analitics.checked?h.addClass("active-white").append():h.append(),u.showAllDiagram=function(e){u.popUpIf=!0,s.showAllMLDiagram(u.campId,e).then(function(e){u.arraytoPopup=e})}}}},{caption:m("CAMP.CAMPAIGN.COLUMNS.PREDICTION_2"),width:115,dataField:"analytics1",allowEditing:!1,cellTemplate:function(t,a){if(u.arrayDiagram.push(a.data),null===a.data.analitics1);else{var n=(a.data.analitics1.bad,a.data.analitics1.good,a.data.analitics1.badOpasity),o=a.data.analitics1.goodOpasity,d=a.data.analitics1.k,l=a.data.analitics1.goodDiagram,c=a.data.analitics1.badDiagram,m=r('<div class="analiticCO"><div class="diagramCO"><div class="badDiagramCO" style="width:'+c+";opacity:"+n+';"></div><div class="goodDiagramCO" style="width:'+l+";opacity:"+o+';"></div><p class="textBadDiagramCO" >'+d.toFixed(1)+'%</p><p class="textGoodDiagramCO">'+(100-d).toFixed(1)+'%</p></div><div class="buttonAnaliticCO'+a.data.placement+'"><div class="trueButtonAnaliticCO1'+a.data.placement+'"></div><div class="falseButtonAnaliticCO1'+a.data.placement+'"></div></div></div>;')(i);m.appendTo(t);var p=e.$(".trueButtonAnaliticCO1"+a.data.placement).dxButton({text:"True",disabled:!1,onClick:function(){e.$(".falseButtonAnaliticCO1"+a.data.placement).removeClass("active-white"),e.$(".trueButtonAnaliticCO1"+a.data.placement).addClass("active-white"),s.decisionML(u.campId,a.data.placement,!0,"log").then(function(e){return e})}}),h=e.$(".falseButtonAnaliticCO1"+a.data.placement).dxButton({text:"False",disabled:!1,onClick:function(){e.$(".falseButtonAnaliticCO1"+a.data.placement).addClass("active-white"),e.$(".trueButtonAnaliticCO1"+a.data.placement).removeClass("active-white"),s.decisionML(u.campId,a.data.placement,!1,"log").then(function(e){return e})}});1==a.data.analitics1.checked?p.addClass("active-white").append():p.append(),0==a.data.analitics1.checked?h.addClass("active-white").append():h.append(),u.showAllDiagram=function(e){u.popUpIf=!0,s.showAllMLDiagram(u.campId,e).then(function(e){u.arraytoPopup=e})}}}},{caption:m("CAMP.CAMPAIGN.COLUMNS.STATE"),width:300,columnIndex:16,dataField:"state",allowEditing:!1,headerFilter:{dataSource:[{text:"White",value:["state","=",4]},{text:"Black",value:["state","=",2]},{text:"Suspended",value:["state","=",1]}]},cellTemplate:function(t,a){var n=e.$("<div />").dxButton({text:"white",height:30,width:89,disabled:!1,onClick:function(t){var n=e.$("div.state-white"+a.data.placement),i=e.$("div.state-black"+a.data.placement),o=e.$("div.state-suspended"+a.data.placement);n.dxButton("instance").option("disabled",!0),i.dxButton("instance").option("disabled",!0),o.dxButton("instance").option("disabled",!0),n.removeClass("active"),i.removeClass("active"),o.removeClass("active"),s.editCampaignDomains(u.campId,[a.data.placement],4).then(function(t){return n.dxButton("instance").option("disabled",!1),i.dxButton("instance").option("disabled",!1),o.dxButton("instance").option("disabled",!1),404==t?(e.DevExpress.ui.notify("Not found","warning",4e3),$("#gridContainerWhite").dxDataGrid("instance").refresh(),t):503==t?(e.DevExpress.ui.notify("Not connect to appnexus server, please try again later","warning",4e3),e.$(".gridContainerWhite").dxDataGrid("instance").refresh(),t):("Unactive"!==t&&n.addClass("active"),t)})["catch"](function(e){return e})}});4==a.data.state.whiteList?n.addClass("state-white"+a.data.placement).addClass("active").appendTo(t):n.addClass("state-white"+a.data.placement).appendTo(t);var i=e.$("<div />").dxButton({text:"black",height:30,width:89,disabled:!1,onClick:function(t){var n=e.$("div.state-white"+a.data.placement),i=e.$("div.state-black"+a.data.placement),o=e.$("div.state-suspended"+a.data.placement);n.dxButton("instance").option("disabled",!0),i.dxButton("instance").option("disabled",!0),o.dxButton("instance").option("disabled",!0),n.removeClass("active"),i.removeClass("active"),o.removeClass("active"),s.editCampaignDomains(u.campId,[a.data.placement],2).then(function(t){return n.dxButton("instance").option("disabled",!1),i.dxButton("instance").option("disabled",!1),o.dxButton("instance").option("disabled",!1),404==t?(e.DevExpress.ui.notify("Not found","warning",4e3),e.$(".gridContainerWhite").dxDataGrid("instance").refresh(),t):503==t?(e.DevExpress.ui.notify("Not connect to appnexus server, please try again later","warning",4e3),e.$(".gridContainerWhite").dxDataGrid("instance").refresh(),t):("Unactive"!==t&&i.addClass("active"),t)})["catch"](function(e){return e})}});2==a.data.state.blackList?i.addClass("state-black"+a.data.placement).addClass("active").appendTo(t):i.addClass("state-black"+a.data.placement).appendTo(t);var o=e.$("<div />").dxButton({text:"suspend",height:30,width:95,disabled:!1,onClick:function(){return 1==v?(e.DevExpress.ui.notify("Wait please","warning",4e3),0):(h.placement=[a.data.placement],h.suspend=1,void u.confirmPopup.option("visible",!0))}});1==a.data.state.suspended?o.addClass("state-suspended"+a.data.placement).addClass("active").appendTo(t):o.addClass("state-suspended"+a.data.placement).appendTo(t)}}],summary:{totalItems:[{column:"placement",summaryType:"count",customizeText:function(e){return e.valueText="Count: "+u.dataGridOptionsMultipleFunc.totalCount(),e.valueText}},{column:"conv",summaryType:"sum",customizeText:function(e){return e.valueText="Conv: "+s.totalSummary.conv,e.valueText}},{column:"imp",summaryType:"sum",customizeText:function(e){return e.valueText="Imp: "+s.totalSummary.imp.toString().split(/(?=(?:\d{3})+(?!\d))/).join(),e.valueText}},{column:"cpa",summaryType:"sum",valueFormat:"currency",customizeText:function(e){return e.valueText="CPA: $"+s.totalSummary.cpa.toFixed(4),e.valueText}},{column:"cost",summaryType:"sum",valueFormat:"currency",customizeText:function(e){return e.valueText="Cost: $"+s.totalSummary.cost.toFixed(2),e.valueText}},{column:"clicks",summaryType:"sum",customizeText:function(e){return e.valueText="Clicks: "+s.totalSummary.clicks,e.valueText}},{column:"cpc",summaryType:"sum",customizeText:function(e){return e.valueText="CPC: $"+s.totalSummary.cpc.toFixed(4),e.valueText}},{column:"cpm",summaryType:"sum",customizeText:function(e){return e.valueText="CPM: $"+s.totalSummary.cpm.toFixed(4),e.valueText}},{column:"cvr",summaryType:"sum",customizeText:function(e){return e.valueText="CVR: %"+s.totalSummary.cvr.toFixed(4),e.valueText}},{column:"ctr",summaryType:"sum",customizeText:function(e){return e.valueText="CTR: %"+s.totalSummary.ctr.toFixed(4),e.valueText}}]},columnChooser:{enabled:!0,height:180,width:400,emptyPanelText:"A place to hide the columns"},selection:{mode:"multiple",allowSelectAll:!1,showCheckBoxesMode:"always"},onInitialized:function(e){u.dataGridOptionsMultipleFunc=e.component,u.dataGridOptionsMultipleFunc._controllers.columns._commandColumns[1].visibleIndex=9,u.dataGridOptionsMultipleFunc._controllers.columns._commandColumns[1].width=35},onEditorPreparing:function(t){"filterRow"==t.parentType&&"state"==t.dataField&&(t.editorElement.dxSelectBox({dataSource:[{name:"White List",state:4},{name:"Black List",state:2},{name:"Suspended",state:1},{name:"Clear state",state:0}],placeholder:"Select a state",displayExpr:"name",valueExpr:u.state,onSelectionChanged:function(t){var a=e.$(".gridContainerWhite")[0].querySelectorAll('[aria-selected="true"]');if(!a[0])return e.DevExpress.ui.notify(m("CO.NO-ITEMS-CHOSEN"),"warning",4e3);for(var n=[],i=0;i<a.length;i++)n.push(a[i].firstChild.innerText);if(1==t.selectedItem.state)"[]"!=n&&(h.placement=n,h.suspend="suspend",u.confirmPopupVisible=!0,u.confirmPopup.option("visible",!0));else if("[]"!=n){for(var i=0;i<n.length;i++){var o=e.$("div.state-white"+n[i]),r=e.$("div.state-black"+n[i]),d=e.$("div.state-suspended"+n[i]);o.dxButton("instance").option("disabled",!0),r.dxButton("instance").option("disabled",!0),d.dxButton("instance").option("disabled",!0),o.removeClass("active"),r.removeClass("active"),d.removeClass("active")}s.editCampaignDomains(u.campId,n,t.selectedItem.state).then(function(a){for(var i=0;i<n.length;i++){var o=e.$("div.state-black"+n[i]),r=e.$("div.state-white"+n[i]),s=e.$("div.state-suspended"+n[i]);if(r.dxButton("instance").option("disabled",!1),o.dxButton("instance").option("disabled",!1),s.dxButton("instance").option("disabled",!1),404==a)return e.DevExpress.ui.notify("Not found","warning",4e3),e.$(".gridContainerWhite").dxDataGrid("instance").refresh(),a;if(503==a)return e.DevExpress.ui.notify("Not connect to appnexus server, please try again later","warning",4e3),e.$(".gridContainerWhite").dxDataGrid("instance").refresh(),a;2==t.selectedItem.state&&o.addClass("active"),4==t.selectedItem.state&&r.addClass("active")}})}$(".gridContainerWhite").dxDataGrid("instance").refresh()}}),t.cancel=!0)},onSelectionChanged:function(e){u.selectedItems=e.selectedRowsData,u.disabled=!u.selectedItems.length}}}}e.$inject=["$window","$state","$rootScope","$localStorage","$scope","$translate","$compile","CampaignOptimiser","Campaign"],angular.module("pjtLayout").controller("CampaignOptimiserController",e)}(),function(){"use strict";function e(e,t,a){function n(e,a,n,o){return new t.DevExpress.data.CustomStore({totalCount:function(){return 0},load:function(){return i(e,a,n,o).then(function(e){return e.statistics})}})}function i(n,i,o,r){return e({method:"GET",url:"/api/v1/statistics",headers:{Authorization:"Token "+a.get("token")
},params:{advertiser_id:n,from_date:i,to_date:o,by:r}}).then(function(e){for(var a in e.data.statistics)e.data.statistics[a].cvr=+parseFloat(e.data.statistics[a].cvr).toFixed(4),e.data.statistics[a].ctr=+parseFloat(e.data.statistics[a].ctr).toFixed(4),e.data.statistics[a].cpc=+parseFloat(e.data.statistics[a].cpc).toFixed(2),e.data.statistics[a].cpm=+parseFloat(e.data.statistics[a].cpm).toFixed(4),e.data.statistics[a].spend=+parseFloat(e.data.statistics[a].spend).toFixed(2),e.data.statistics[a].day=t.moment(e.data.statistics[a].day).format("DD/MM");return e.data})["catch"](function(e){t.DevExpress.ui.notify(e.data.detail,"error",4e3)})}function o(n,i,o){return e({method:"GET",url:"/api/v1/totals",headers:{Authorization:"Token "+a.get("token")},params:{advertiser_id:n,from_date:i,to_date:o}}).then(function(e){return e.data.totals.cvr=+parseFloat(e.data.totals.cvr).toFixed(4),e.data.totals.ctr=+parseFloat(e.data.totals.ctr).toFixed(4),e.data.totals.cpc=+parseFloat(e.data.totals.cpc).toFixed(2),e.data.totals.cpm=+parseFloat(e.data.totals.cpm).toFixed(2),e.data.totals.spend=+parseFloat(e.data.totals.spend).toFixed(2),e.data.totals})["catch"](function(e){t.DevExpress.ui.notify(e.data.detail,"error",4e3)})}function r(e,a,n,i){return new t.DevExpress.data.CustomStore({totalCount:function(){return c},load:function(t){return t.searchOperation&&t.dataField&&(t.take=999999),s(e,a,n,t.skip,t.take,t.sort,t.order,i,t.filter).then(function(e){return c=e.totalCount,e.campaigns})}})}function s(n,i,o,r,s,d,l,c,u){return d?(l=d[0].desc===!0?"desc":"asc",d=d[0].selector):(d="campaign",l="DESC"),null==s&&(s=20),null==r&&(r=0),e({method:"GET",url:"/api/v1/campaigns",headers:{Authorization:"Token "+a.get("token")},params:{advertiser_id:n,from_date:i,to_date:o,skip:r,take:s,sort:d,order:l,stat_by:c,filter:u}}).then(function(e){for(var t in e.data.campaigns){for(var a in e.data.campaigns[t].chart)e.data.campaigns[t].chart[a].conv=+parseFloat(e.data.campaigns[t].chart[a].conv).toFixed(4),e.data.campaigns[t].chart[a].cpc=+parseFloat(e.data.campaigns[t].chart[a].cpc).toFixed(2),e.data.campaigns[t].chart[a].ctr=+parseFloat(e.data.campaigns[t].chart[a].ctr.toFixed(4)),e.data.campaigns[t].chart[a].cvr=+parseFloat(e.data.campaigns[t].chart[a].cvr).toFixed(4),e.data.campaigns[t].chart[a].spend=+parseFloat(e.data.campaigns[t].chart[a].spend).toFixed(2);e.data.campaigns[t].cvr=+parseFloat(e.data.campaigns[t].cvr).toFixed(2)/100,e.data.campaigns[t].ctr=+parseFloat(e.data.campaigns[t].ctr).toFixed(2)/100,e.data.campaigns[t].cpc=+parseFloat(e.data.campaigns[t].cpc).toFixed(4),e.data.campaigns[t].cpm=+parseFloat(e.data.campaigns[t].cpm).toFixed(4),e.data.campaigns[t].spend=+parseFloat(e.data.campaigns[t].spend).toFixed(4),e.data.campaigns[t].imps_viewed=+parseFloat(e.data.campaigns[t].imps_viewed).toFixed(4),e.data.campaigns[t].view_measured_imps=+parseFloat(e.data.campaigns[t].view_measured_imps).toFixed(4),e.data.campaigns[t].view_measurement_rate=+parseFloat(e.data.campaigns[t].view_measurement_rate).toFixed(1)/100,e.data.campaigns[t].view_rate=+parseFloat(e.data.campaigns[t].view_rate).toFixed(1)/100}return e.data})["catch"](function(e){t.DevExpress.ui.notify(e.data.detail,"error",4e3)})}function d(n,i,o){return e({method:"GET",url:"/api/v1/map/clicks",headers:{Authorization:"Token "+a.get("token")},params:{advertiser_id:n,from_date:i,to_date:o}}).then(function(e){return e.data})["catch"](function(e){t.DevExpress.ui.notify(e.data.detail,"error",4e3)})}var l=this,c=0;l.multipleStore=r,l.chartStore=n,l.statsTotals=o,l.statsMap=d}e.$inject=["$http","$window","$cookies"],angular.module("pjtLayout").service("Main",e)}(),function(){"use strict";function e(e,t,a,n,i,o,r){function s(){for(var e in n.checkChart)n.checkChart[e]?("imp"==e&&d.chartOptionsFunc.getSeriesByName("Impressions").show(),"cvr"==e&&d.chartOptionsFunc.getSeriesByName("CVR").show(),"cpc"==e&&d.chartOptionsFunc.getSeriesByName("CPC").show(),"clicks"==e&&d.chartOptionsFunc.getSeriesByName("Clicks").show(),"spend"==e&&d.chartOptionsFunc.getSeriesByName("Cost").show(),"conv"==e&&d.chartOptionsFunc.getSeriesByName("Conversions").show(),"ctr"==e&&d.chartOptionsFunc.getSeriesByName("CTR").show()):("imp"==e&&d.chartOptionsFunc.getSeriesByName("Impressions").hide(),"cvr"==e&&d.chartOptionsFunc.getSeriesByName("CVR").hide(),"cpc"==e&&d.chartOptionsFunc.getSeriesByName("CPC").hide(),"clicks"==e&&d.chartOptionsFunc.getSeriesByName("Clicks").hide(),"spend"==e&&d.chartOptionsFunc.getSeriesByName("Cost").hide(),"conv"==e&&d.chartOptionsFunc.getSeriesByName("Conversions").hide(),"ctr"==e&&d.chartOptionsFunc.getSeriesByName("CTR").hide())}var d=this;d.advertiser=n.advertiser,d.Main=o,d.multipleTotalCount=0,d.Init=[],d.by="imp,cvr,cpc,clicks,spend,conv,ctr",d.selectedItems=[],d.chartOptionsFuncgrid=[],d.charIsUpdating=!1,r.id=null;var l=i.instant;null==n.checkChart&&(n.checkChart={imp:!0,cvr:!1,cpc:!1,clicks:!1,spend:!1,conv:!1,ctr:!1});var c=[{valueField:"imp",name:"Impressions",axis:"imp",visible:n.checkChart.imp},{valueField:"cvr",name:"CVR",axis:"cvr",visible:n.checkChart.cvr},{valueField:"cpc",name:"CPC",axis:"cpc",visible:n.checkChart.cpc},{valueField:"clicks",name:"Clicks",axis:"clicks",visible:n.checkChart.clicks},{valueField:"spend",name:"Cost",axis:"spend",visible:n.checkChart.spend},{valueField:"conv",name:"Conversions",axis:"conv",visible:n.checkChart.conv},{valueField:"ctr",name:"CTR",axis:"ctr",visible:n.checkChart.ctr}];null==n.SelectedTime?(n.SelectedTime=0,n.dataStart=e.moment({hour:"00"}).subtract(1,"day").unix(),n.dataEnd=e.moment({hour:"00"}).subtract(1,"day").endOf("day").unix(),d.dataStart=e.moment({hour:"00"}).subtract(1,"day").unix(),d.dataEnd=e.moment({hour:"00"}).subtract(1,"day").endOf("day").unix()):null==n.dataStart||null==n.dataEnd?(n.SelectedTime=0,n.dataStart=e.moment({hour:"00"}).subtract(1,"day").unix(),n.dataEnd=e.moment({hour:"00"}).subtract(1,"day").endOf("day").unix(),d.dataStart=e.moment({hour:"00"}).subtract(1,"day").unix(),d.dataEnd=e.moment({hour:"00"}).subtract(1,"day").endOf("day").unix()):(d.dataStart=n.dataStart,d.dataEnd=n.dataEnd);var u=angular.element(e.document.querySelector("#wrapper"))[0];u.classList.add("hidden-menu");var m=[{ID:0,Name:l("MAIN.DATE_PICKER.YESTERDAY"),dataStart:e.moment({hour:"00"}).subtract(1,"day").unix(),dataEnd:e.moment({hour:"00"}).subtract(1,"day").endOf("day").unix()},{ID:1,Name:l("MAIN.DATE_PICKER.LAST_3_DAYS"),dataStart:e.moment({hour:"00"}).subtract(3,"day").unix(),dataEnd:e.moment({hour:"00"}).unix()},{ID:2,Name:l("MAIN.DATE_PICKER.LAST_7_DAYS"),dataStart:e.moment({hour:"00"}).subtract(7,"day").unix(),dataEnd:e.moment({hour:"00"}).unix()},{ID:3,Name:l("MAIN.DATE_PICKER.LAST_14_DAYS"),dataStart:e.moment({hour:"00"}).subtract(14,"day").unix(),dataEnd:e.moment({hour:"00"}).unix()},{ID:4,Name:l("MAIN.DATE_PICKER.LAST_21_DAYS"),dataStart:e.moment({hour:"00"}).subtract(21,"day").unix(),dataEnd:e.moment({hour:"00"}).unix()},{ID:5,Name:l("MAIN.DATE_PICKER.CURRENT_MONTH"),dataStart:e.moment().startOf("month").unix(),dataEnd:e.moment().unix()},{ID:6,Name:l("MAIN.DATE_PICKER.LAST_MONTH"),dataStart:e.moment().subtract(1,"month").startOf("month").unix(),dataEnd:e.moment().subtract(1,"month").endOf("month").unix()},{ID:7,Name:l("MAIN.DATE_PICKER.LAST_90_DAYS"),dataStart:e.moment({hour:"00"}).subtract(90,"day").unix(),dataEnd:e.moment().unix()},{ID:8,Name:l("MAIN.DATE_PICKER.ALL_TIME"),dataStart:0,dataEnd:e.moment().unix()}];d.totals=[],d.Main.statsTotals(d.advertiser.id,d.dataStart,d.dataEnd).then(function(e){d.totals.imp=e.imp.toString().split(/(?=(?:\d{3})+(?!\d))/).join(),d.totals.spent=e.spend.toFixed(2),d.totals.conv=e.conv,d.totals.cpc=e.cpc,d.totals.cpm=e.cpm,d.totals.cvr=e.cvr,d.totals.ctr=e.ctr}),d.checkBoxState=!0,d.onlyTwo=function(e){var t=0,a=[],n=[];for(t=0;t<d.Init.length;t++)1==d.Init[t]._options.value?a.push(d.Init[t]):n.push(d.Init[t]);if(1==e){if(2==a.length&&n.length>4)for(t=0;t<n.length;t++)n[t].option("disabled",!0)}else if(a.length<=2)for(t=0;t<n.length;t++)n[t].option("disabled",!1)},d.updateCharts=function(t,a,i){var o={};n.checkChart[a]=i;var r=0;if(i)for(d.chartOptionsFunc.getSeriesByName(t).show(),o=e.$(".chartMulti"),r=0;r<o.length;r++)e.$(o[r]).dxChart("instance").getSeriesByName(t).show();else for(d.chartOptionsFunc.getSeriesByName(t).hide(),o=e.$(".chartMulti"),r=0;r<o.length;r++)e.$(o[r]).dxChart("instance").getSeriesByName(t).hide()};var p={};d.Main.statsMap(d.advertiser.id,d.dataStart,d.dataEnd).then(function(t){p=t,e.$("#visualMap").dxVectorMap(d.UI.vectorMapOptions)}),d.chartStore=o.chartStore(d.advertiser.id,d.dataStart,d.dataEnd,d.by),d.multipleStore=o.multipleStore(d.advertiser.id,d.dataStart,d.dataEnd,d.by),d.UI={datePiker:{items:m,displayExpr:"Name",valueExpr:"ID",value:m[n.SelectedTime].ID,onValueChanged:function(e){n.SelectedTime=e.value,n.dataStart=m[e.value].dataStart,n.dataEnd=m[e.value].dataEnd,t.reload()}},dataGridOptionsMultiple:{bindingOptions:{dataSource:"main.multipleStore"},onInitialized:function(e){d.dataGridOptionsMultipleFunc=e.component},loadPanel:{shadingColor:"rgba(0,0,0,0.4)",visible:!1,showIndicator:!0,showPane:!0,shading:!0,closeOnOutsideClick:!1},alignment:"left",headerFilter:{visible:!0},filterRow:{visible:!0,applyFilter:"auto"},"export":{enabled:!0,fileName:"Employees"},allowColumnReordering:!0,allowColumnResizing:!0,columnAutoWidth:!0,wordWrapEnabled:!0,loadingIndicator:{show:!1},columnChooser:{enabled:!0},columnFixing:{enabled:!0},paging:{pageSize:10},pager:{showPageSizeSelector:!0,allowedPageSizes:[10,30,50],visible:!0,showNavigationButtons:!0},showBorders:!0,showRowLines:!0,columns:[{caption:l("MAIN.CAMPAIGN.COLUMNS.CAMPAIGN"),dataField:"campaign",fixed:!0,cellTemplate:function(t,a){t.addClass("a-campaign"),e.angular.element('<a href="#/campaign/'+a.data.id+'">'+a.data.campaign+"</a>").appendTo(t)},alignment:"center"},{caption:l("MAIN.CAMPAIGN.COLUMNS.SPENT")+" ,$",dataField:"spend",alignment:"center",dataType:"number",format:"currency",precision:4},{caption:l("MAIN.CAMPAIGN.COLUMNS.CONV"),dataField:"conv",alignment:"center",dataType:"number"},{caption:l("MAIN.CAMPAIGN.COLUMNS.IMP"),dataField:"imp",sortOrder:"desc",alignment:"center",format:"fixedPoint",dataType:"number"},{caption:l("MAIN.CAMPAIGN.COLUMNS.CLICKS"),dataField:"clicks",alignment:"center",dataType:"number"},{caption:l("MAIN.CAMPAIGN.COLUMNS.CPC")+" ,$",dataField:"cpc",alignment:"center",dataType:"number",precision:4,format:"currency"},{caption:l("MAIN.CAMPAIGN.COLUMNS.CPM")+" ,$",dataField:"cpm",alignment:"center",dataType:"number",precision:4,format:"currency"},{caption:l("MAIN.CAMPAIGN.COLUMNS.CVR")+" ,%",dataField:"cvr",alignment:"center",dataType:"number",precision:2,format:"percent"},{caption:l("MAIN.CAMPAIGN.COLUMNS.CTR")+" ,%",dataField:"ctr",alignment:"center",dataType:"number",precision:2,format:"percent"},{caption:l("MAIN.CAMPAIGN.COLUMNS.IMPS_VIEWED"),dataField:"imps_viewed",alignment:"center",width:90,dataType:"number",format:"fixedPoint"},{caption:l("MAIN.CAMPAIGN.COLUMNS.VIEW_MEASURED_IMPS"),dataField:"view_measured_imps",alignment:"center",width:100,dataType:"number",format:"fixedPoint"},{caption:l("MAIN.CAMPAIGN.COLUMNS.VIEW_MEASUREMENT_RATE")+" ,%",dataField:"view_measurement_rate",alignment:"center",width:120,dataType:"number",precision:2,format:"percent"},{caption:l("MAIN.CAMPAIGN.COLUMNS.VIEW_RATE")+" ,%",dataField:"view_rate",alignment:"center",width:80,dataType:"number",precision:2,format:"percent"},{width:200,dataField:l("MAIN.CAMPAIGN.COLUMNS.STATS"),cellTemplate:function(t,a){if(a.data.chart){var n={onInitialized:function(e){d.chartOptionsFuncgrid[a.rowIndex]=e.component},dataSource:a.data.chart,size:{height:80,width:185},commonSeriesSettings:{argumentField:"day",type:"line",point:{size:2,hoverStyle:{border:{visible:!0,width:1},size:4}}},commonAxisSettings:{label:{visible:!1},grid:{visible:!1}},valueAxis:[{name:"imp"},{name:"cvr"},{name:"cpc"},{name:"clicks"},{name:"spend"},{name:"conv"},{name:"ctr"}],argumentAxis:{valueMarginsEnabled:!1,discreteAxisDivisionMode:"crossLabels",grid:{visible:!1},label:{visible:!1},minorGrid:{visible:!1},minorTick:{visible:!1},tick:{visible:!1}},series:c,legend:{visible:!1},tooltip:{enabled:!0,customizeTooltip:function(e){return"Cost"==e.seriesName||"CPC"==e.seriesName?{text:"$"+e.valueText+" "+e.seriesName}:"Impressions"==e.seriesName?{text:e.value.toString().split(/(?=(?:\d{3})+(?!\d))/).join()}:"CTR"==e.seriesName||"CVR"==e.seriesName?{text:e.valueText+"% "+e.seriesName}:{text:e.valueText+" "+e.seriesName}}}};t.addClass("img-container");var i=e.$('<div class="chartMulti" ></div>');i.dxChart(n),i.appendTo(t)}else t.addClass("img-container"),e.$('<div id="chartMulti" ></div>').appendTo(t)}}],onSelectionChanged:function(e){d.selectedItems=e.selectedRowsData,d.disabled=!d.selectedItems.length}},chartOptions:{onDone:function(){var e=$("#chart").dxChart("instance");if(!d.charIsUpdating){var t=[],a="left";d.UI.chartOptions.valueAxis.forEach(function(i,o){var r=n.checkChart[i.name];t.push({name:i.name,position:a,label:{format:"percent",alignment:"center",customizeText:function(){d.charIsUpdating=!0;var t=e._valueAxes[o]._majorTicks,a=null;if(Array.isArray(t)&&a<t[t.length-1].value&&(a=t[t.length-1].value),this.value==a)switch(i.name){case"imp":return'<span style="color:black; font-weight: bolder; text-decoration:underline;">'+l("MAIN.CHECKBOX.IMPRESSIONS")+"</span><br>"+this.value.toString().split(/(?=(?:\d{3})+(?!\d))/).join();case"cvr":return'<span style="color:black; font-weight: bolder; text-decoration:underline;">'+l("MAIN.CHECKBOX.CVR")+"%</span><br>"+this.value+"%";case"cpc":return'<span style="color:black; font-weight: bolder; text-decoration:underline;">$'+l("MAIN.CHECKBOX.CPC")+"</span><br>$"+this.value;case"clicks":return'<span style="color:black; font-weight: bolder; text-decoration:underline;">'+l("MAIN.CHECKBOX.CLICKS")+"</span><br>"+this.value;case"spend":return'<span style="color:black; font-weight: bolder; text-decoration:underline;">'+l("MAIN.CHECKBOX.COST")+"</span><br>$"+this.value;case"conv":return'<span style="color:black; font-weight: bolder; text-decoration:underline;">'+l("MAIN.CHECKBOX.CONVERSIONS")+"</span><br>"+this.value;case"ctr":return'<span style="color:black; font-weight: bolder; text-decoration:underline;">'+l("MAIN.CHECKBOX.CTR")+"%</span><br>"+this.value+"%";default:return'<span style="color:black; font-weight: bolder; text-decoration:underline;">'+i.name+"</span><br>"+this.value}else switch(i.name){case"imp":return this.value.toString().split(/(?=(?:\d{3})+(?!\d))/).join();case"cvr":return this.value+"%";case"cpc":return"$"+this.value;case"spend":return"$"+this.value;case"ctr":return this.value+"%"}return this.value}}}),r&&(a="left"==a?"right":"left")}),e.option("valueAxis",t)}},onInitialized:function(e){d.chartOptionsFunc=e.component},series:c,bindingOptions:{dataSource:"main.chartStore"},commonSeriesSettings:{argumentField:"day",type:"Line",point:{size:6,hoverStyle:{border:{visible:!0,width:2},size:5}}},tooltip:{enabled:!0,customizeTooltip:function(e){return"Cost"==e.seriesName||"CPC"==e.seriesName?{text:"$"+e.valueText}:"Impressions"==e.point.series.name?{text:e.valueText.toString().split(/(?=(?:\d{3})+(?!\d))/).join()}:"CTR"==e.seriesName||"CVR"==e.seriesName?{text:e.valueText+"%"}:{text:e.valueText}}},crosshair:{enabled:!0,color:"deepskyblue",visible:!0,horizontalLine:{label:{visible:!0,customizeText:function(e){return"Cost"==e.point.series.name||"CPC"==e.point.series.name?"$"+this.value:"Impressions"==e.point.series.name?this.value.toString().split(/(?=(?:\d{3})+(?!\d))/).join():"CTR"==e.point.series.name||"CVR"==e.point.series.name?this.value+"%":void 0}}},verticalLine:{label:{visible:!0}}},commonAxisSettings:{valueMarginsEnabled:!0},margin:{bottom:20},argumentAxis:{discreteAxisDivisionMode:"crossLabels",grid:{visible:!0}},valueAxis:[{name:"imp",position:"left",label:{format:"percent"}},{name:"cvr",position:"left"},{name:"cpc",position:"left",label:{format:"currency"}},{name:"clicks",position:"left"},{name:"spend",position:"left"},{name:"conv",position:"left"},{name:"ctr",position:"left"}],legend:{verticalAlignment:"bottom",horizontalAlignment:"center",itemTextPosition:"bottom"}},impressions:{text:l("MAIN.CHECKBOX.IMPRESSIONS"),value:n.checkChart.imp,onInitialized:function(e){d.Init.push(e.component)},onValueChanged:function(e){d.updateCharts("Impressions","imp",e.value),d.onlyTwo(e.value),d.charIsUpdating=!1,d.UI.chartOptions.onDone(),s()}},CVR:{text:l("MAIN.CHECKBOX.CVR"),value:n.checkChart.cvr,onInitialized:function(e){d.Init.push(e.component)},onValueChanged:function(e){d.updateCharts("CVR","cvr",e.value),d.onlyTwo(e.value),d.charIsUpdating=!1,d.UI.chartOptions.onDone(),s()}},CPC:{text:l("MAIN.CHECKBOX.CPC"),value:n.checkChart.cpc,onInitialized:function(e){d.Init.push(e.component)},onValueChanged:function(e){d.updateCharts("CPC","cpc",e.value),d.onlyTwo(e.value),d.charIsUpdating=!1,d.UI.chartOptions.onDone(),s()}},clicks:{text:l("MAIN.CHECKBOX.CLICKS"),value:n.checkChart.clicks,onInitialized:function(e){d.Init.push(e.component)},onValueChanged:function(e){d.updateCharts("Clicks","clicks",e.value),d.onlyTwo(e.value),d.charIsUpdating=!1,d.UI.chartOptions.onDone(),s()}},cost:{text:l("MAIN.CHECKBOX.COST"),value:n.checkChart.spend,onInitialized:function(e){d.Init.push(e.component)},onValueChanged:function(e){d.updateCharts("Cost","spend",e.value),d.onlyTwo(e.value),d.charIsUpdating=!1,d.UI.chartOptions.onDone(),s()}},conversions:{text:l("MAIN.CHECKBOX.CONVERSIONS"),value:n.checkChart.conv,onInitialized:function(e){d.Init.push(e.component)},onValueChanged:function(e){d.updateCharts("Conversions","conv",e.value),d.onlyTwo(e.value),d.charIsUpdating=!1,d.UI.chartOptions.onDone(),s()}},CTR:{text:l("MAIN.CHECKBOX.CTR"),value:n.checkChart.ctr,onInitialized:function(e){d.Init.push(e.component)},onValueChanged:function(e){d.updateCharts("CTR","ctr",e.value),d.onlyTwo(e.value),d.charIsUpdating=!1,d.UI.chartOptions.onDone(),s()}},vectorMapOptions:{size:{height:320},layers:[{name:"areas",dataSource:e.DevExpress.viz.map.sources.world,palette:"blue",colorGroups:[0,100,1e7],colorGroupingField:"clicks",label:{enabled:!0,dataField:"name"},customize:function(e){e.forEach(function(e){var t=e.attribute("name"),a=p[t];a&&e.attribute("clicks",a)})}}],tooltip:{enabled:!0,customizeTooltip:function(e){return e.attribute("clicks")?{text:e.attribute("name")+": "+e.attribute("clicks")}:{text:e.attribute("name")}}},legends:[{source:{layer:"areas",grouping:"color"},horizontalAlignment:"left",verticalAlignment:"bottom",customizeText:function(e){return e.start+" to "+e.end+" clicks"}}],bounds:[-180,85,180,-75]}},a(function(){var e=0,t=[],a=[];for(e=0;e<d.Init.length;e++)1==d.Init[e]._options.value?t.push(d.Init[e]):a.push(d.Init[e]);if(t.length>=2&&a.length>4)for(e=0;e<a.length;e++)a[e].option("disabled",!0)})}e.$inject=["$window","$state","$timeout","$localStorage","$translate","Main","$rootScope"],angular.module("pjtLayout").controller("MainController",e)}(),function(){"use strict";function e(e,t){function a(a){return e({method:"GET",headers:{Authorization:"Token "+t.get("token")},url:"/api/v1/campaigns/"+encodeURI(a)}).then(function(e){return e.data})}function n(a,n,i,o){return e({method:"GET",url:"/api/v1/campaigns/"+encodeURI(a)+"/details",headers:{Authorization:"Token "+t.get("token")},params:{from_date:n,to_date:i,section:o}}).then(function(e){for(var t in e.data.all)e.data.all[t].data=+parseFloat(e.data.all[t].data).toFixed(4);for(var t in e.data.conversions)e.data.conversions[t].data=+parseFloat(e.data.conversions[t].data).toFixed(4);return e.data})}function i(a,n,i,o){return e({method:"GET",url:"/api/v1/campaigns/"+encodeURI(a)+"/cpabuckets",headers:{Authorization:"Token "+t.get("token")},params:{id:a,from_date:n,to_date:i,category:o}}).then(function(e){for(var t in e.data)e.data[t].cpa=+parseFloat(e.data[t].cpa).toFixed(3);return e.data})}var o=this;o.nameCampaigns=a,o.bucketsCpa=i,o.detailsStoreAll=n}e.$inject=["$http","$cookies"],angular.module("pjtLayout").service("CPA",e)}(),function(){"use strict";function e(e,t,a,n,i,o,r,s){var d=this;d.Camp=i,d.multipleTotalCount=0,d.checkChart=[],d.by="imp,cvr,cpc,clicks,spend,conv,ctr";var l=n.instant;d.campName=s.campaign,d.campId=s.id,d.line_item=s.line_item,d.line_item_id=s.line_item_id,d.cpaResult=[],d.selectedSection=a.selectedSection,d.detailsStoreAll=new e.DevExpress.data.CustomStore({totalCount:function(){return 0},load:function(){return o.all}}),d.detailsStoreConversion=new e.DevExpress.data.CustomStore({totalCount:function(){return 0},load:function(){return o.conversions}}),d.cpaBucketRequestFirst=new e.DevExpress.data.CustomStore({totalCount:function(){return 0},load:function(){d.cpaResult=r;for(var e=[],t=0;t<d.cpaResult.length;t++)+d.cpaResult[t].cpa>=d.backetsRanges.first.min&&+d.cpaResult[t].cpa<d.backetsRanges.first.max&&e.push(d.cpaResult[t]);return e}}),d.cpaBucketRequestSecond=new e.DevExpress.data.CustomStore({totalCount:function(){return 0},load:function(){for(var e=[],t=0;t<d.cpaResult.length;t++)+d.cpaResult[t].cpa>=d.backetsRanges.second.min&&+d.cpaResult[t].cpa<d.backetsRanges.second.max&&e.push(d.cpaResult[t]);return e}}),d.cpaBucketRequestThird=new e.DevExpress.data.CustomStore({totalCount:function(){return 0},load:function(){for(var e=[],t=0;t<d.cpaResult.length;t++)+d.cpaResult[t].cpa>=d.backetsRanges.third.min&&+d.cpaResult[t].cpa<d.backetsRanges.third.max&&e.push(d.cpaResult[t]);return e}}),d.cpaBucketRequestFourth=new e.DevExpress.data.CustomStore({totalCount:function(){return 0},load:function(){for(var e=[],t=0;t<d.cpaResult.length;t++)+d.cpaResult[t].cpa>=d.backetsRanges.fourth.min&&+d.cpaResult[t].cpa<d.backetsRanges.fourth.max&&e.push(d.cpaResult[t]);return e}}),null==a.SelectedTime?(a.SelectedTime=0,a.dataStart=e.moment({hour:"00"}).subtract(1,"day").unix(),a.dataEnd=e.moment({hour:"00"}).subtract(1,"day").endOf("day").unix(),d.dataStart=e.moment({hour:"00"}).subtract(1,"day").unix(),d.dataEnd=e.moment({hour:"00"}).subtract(1,"day").endOf("day").unix()):null==a.dataStart||null==a.dataEnd?(a.SelectedTime=0,a.dataStart=e.moment({hour:"00"}).subtract(1,"day").unix(),a.dataEnd=e.moment({hour:"00"}).subtract(1,"day").endOf("day").unix(),d.dataStart=e.moment({hour:"00"}).subtract(1,"day").unix(),d.dataEnd=e.moment({hour:"00"}).subtract(1,"day").endOf("day").unix()):(d.dataStart=a.dataStart,d.dataEnd=a.dataEnd);var c=[{ID:0,Name:l("MAIN.DATE_PICKER.YESTERDAY"),dataStart:e.moment({hour:"00"}).subtract(1,"day").unix(),dataEnd:e.moment({hour:"00"}).subtract(1,"day").endOf("day").unix()},{ID:1,Name:l("MAIN.DATE_PICKER.LAST_3_DAYS"),dataStart:e.moment({hour:"00"}).subtract(3,"day").unix(),dataEnd:e.moment({hour:"00"}).unix()},{ID:2,Name:l("MAIN.DATE_PICKER.LAST_7_DAYS"),dataStart:e.moment({hour:"00"}).subtract(7,"day").unix(),dataEnd:e.moment({hour:"00"}).unix()},{ID:3,Name:l("MAIN.DATE_PICKER.LAST_14_DAYS"),dataStart:e.moment({hour:"00"}).subtract(14,"day").unix(),dataEnd:e.moment({hour:"00"}).unix()},{ID:4,Name:l("MAIN.DATE_PICKER.LAST_21_DAYS"),dataStart:e.moment({hour:"00"}).subtract(21,"day").unix(),dataEnd:e.moment({hour:"00"}).unix()},{ID:5,Name:l("MAIN.DATE_PICKER.CURRENT_MONTH"),dataStart:e.moment().startOf("month").unix(),dataEnd:e.moment().unix()},{ID:6,Name:l("MAIN.DATE_PICKER.LAST_MONTH"),dataStart:e.moment().subtract(1,"month").startOf("month").unix(),dataEnd:e.moment().subtract(1,"month").endOf("month").unix()},{ID:7,Name:l("MAIN.DATE_PICKER.LAST_90_DAYS"),dataStart:e.moment({hour:"00"}).subtract(90,"day").unix(),dataEnd:e.moment().unix()},{ID:8,Name:l("MAIN.DATE_PICKER.ALL_TIME"),dataStart:0,dataEnd:e.moment().unix()}];d.UI={datePiker:{items:c,displayExpr:"Name",valueExpr:"ID",value:c[a.SelectedTime].ID,onValueChanged:function(e){a.SelectedTime=e.value,a.dataStart=c[e.value].dataStart,a.dataEnd=c[e.value].dataEnd,t.reload()}}},d.ctrlBbtns={placement:{btn:"Placement",header:"Placement"},creativeId:{btn:"creative_id",header:"creative_id"},creativeSize:{btn:"creative_size",header:"creative_size"},os:{btn:"OS",header:"Operating System used"},carrier:{btn:"carrier",header:"carrier"},networkSeller:{btn:"network(seller)",header:"network (seller)"},connectionType:{btn:"connection_type",header:"connection_type"},device:{btn:"device",header:"device"}},d.pieChartHeader=a.pieChartHeader||d.ctrlBbtns.placement.header,d.btnsNodesArray=e.$(".label-container")[0].children;for(var u in d.ctrlBbtns)d.ctrlBbtns[u].header==d.pieChartHeader&&(d.selectedSection=d.ctrlBbtns[u].btn,a.selectedSection=d.selectedSection);Array.prototype.forEach.call(d.btnsNodesArray,function(e){e.name==d.selectedSection&&e.classList.add("nav-btn-active")}),d.selectInfoBtn=function(e,n){d.pieChartHeader=n,a.pieChartHeader=d.pieChartHeader,Array.prototype.forEach.call(d.btnsNodesArray,function(e){e.classList.contains("nav-btn-active")&&e.classList.remove("nav-btn-active")}),a.pieChartHeader=d.pieChartHeader,e.currentTarget.classList.add("nav-btn-active");for(var i in d.ctrlBbtns)d.ctrlBbtns[i].header==d.pieChartHeader&&(a.selectedSection=d.ctrlBbtns[i].btn);t.reload()},d.targetCpa||(d.targetCpa=a.targetCpa||1,a.targetCpa=d.targetCpa),d.backetsRanges={first:{min:0,max:Number(d.targetCpa).toFixed(2)},second:{min:Number(d.targetCpa).toFixed(2),max:Number(2*d.targetCpa).toFixed(2)},third:{min:Number(2*d.targetCpa).toFixed(2),max:Number(3*d.targetCpa).toFixed(2)},fourth:{min:Number(3*d.targetCpa).toFixed(2),max:Number(1e5*d.targetCpa).toFixed(2)}},d.targetCpaChange=function(t){var n=Number(t.currentTarget.value);return a.targetCpa=n,d.backetsRanges={first:{min:0,max:n.toFixed(2)},second:{min:n.toFixed(2),max:(2*n).toFixed(2)},third:{min:(2*n).toFixed(2),max:(3*n).toFixed(2)},fourth:{min:(3*n).toFixed(2),max:(1e5*n).toFixed(2)}},e.$("#backets-1").dxDataGrid("instance").refresh(),e.$("#backets-2").dxDataGrid("instance").refresh(),e.$("#backets-3").dxDataGrid("instance").refresh(),e.$("#backets-4").dxDataGrid("instance").refresh(),d.backetsRanges},d.pieChartAll={title:{text:"All",font:{size:20},margin:{bottom:1}},bindingOptions:{dataSource:"cpa.detailsStoreAll"},legend:{visible:!1},tooltip:{enabled:!0,format:{type:"millions",percentPrecision:2},customizeTooltip:function(e){return{text:e.argument+" - "+e.value+"%"}}},series:[{argumentField:"section",valueField:"data",smallValuesGrouping:{mode:"topN",topCount:25}}]},d.pieChartConversions={title:{text:"Conversions",font:{size:20},margin:{bottom:1}},bindingOptions:{dataSource:"cpa.detailsStoreConversion"},legend:{visible:!1},tooltip:{enabled:!0,customizeTooltip:function(e){return{text:e.argument+" - "+e.value+"%"}}},series:[{argumentField:"section",valueField:"data",smallValuesGrouping:{mode:"topN",topCount:25}}]},d.columnsPlacement=[{caption:"sellerid",dataField:"sellerid"},{caption:"sellername",dataField:"sellername"},{caption:"placementid",dataField:"placementid"},{caption:"placementname",dataField:"placementname"},{caption:"cpa, $",dataField:"cpa",sortOrder:"desc"}],d.columnsCreativeId=[{caption:"creative id",dataField:"creative"},{caption:"creative name",dataField:"creative_name"},{caption:"cpa, $",dataField:"cpa",sortOrder:"desc"}],d.columnsCreativeSize=[{caption:"size",dataField:"size"},{caption:"cpa, $",dataField:"cpa",sortOrder:"desc"}],d.columnsOs=[{caption:"operating system id",dataField:"operating_system"},{caption:"operating system",dataField:"operating_system_name"},{caption:"cpa, $",dataField:"cpa",sortOrder:"desc"}],d.columnsCarrier=[{caption:"carrier id",dataField:"carrier"},{caption:"carrier name",dataField:"carrier_name"},{caption:"cpa, $",dataField:"cpa",sortOrder:"desc"}],d.columnsNetworkSeller=[{caption:"seller member",dataField:"seller_member"},{caption:"seller member name",dataField:"seller_member_name"},{caption:"cpa, $",dataField:"cpa",sortOrder:"desc"}],d.columnsConnectionType=[{caption:"connection type",dataField:"connection_type"},{caption:"cpa, $",dataField:"cpa",sortOrder:"desc"}],d.columnsDevice=[{caption:"device model",dataField:"device_model"},{caption:"device model name",dataField:"device_model_name"},{caption:"cpa, $",dataField:"cpa",sortOrder:"desc"}],"Placement"==a.selectedSection?d.columnsSelected=d.columnsPlacement:"creative_id"==a.selectedSection?d.columnsSelected=d.columnsCreativeId:"creative_size"==a.selectedSection?d.columnsSelected=d.columnsCreativeSize:"OS"==a.selectedSection?d.columnsSelected=d.columnsOs:"carrier"==a.selectedSection?d.columnsSelected=d.columnsCarrier:"network(seller)"==a.selectedSection?d.columnsSelected=d.columnsNetworkSeller:"connection_type"==a.selectedSection?d.columnsSelected=d.columnsConnectionType:"device"==a.selectedSection&&(d.columnsSelected=d.columnsDevice),d.cpaBucketFirst={showBorders:!0,alignment:"left",bindingOptions:{dataSource:"cpa.cpaBucketRequestFirst"},howBorders:!0,showRowLines:!0,paging:{enabled:!0,pageSize:10},remoteOperations:!1,allowColumnReordering:!0,allowColumnResizing:!0,columnAutoWidth:!0,pager:{showPageSizeSelector:!0,allowedPageSizes:[10,30,50],visible:!0,showNavigationButtons:!0},columns:d.columnsSelected,"export":{enabled:!0,fileName:"cpa_first"}},d.cpaBucketSecond={showBorders:!0,alignment:"left",bindingOptions:{dataSource:"cpa.cpaBucketRequestSecond"},howBorders:!0,showRowLines:!0,paging:{enabled:!0,pageSize:10},remoteOperations:!1,allowColumnReordering:!0,allowColumnResizing:!0,columnAutoWidth:!0,pager:{showPageSizeSelector:!0,allowedPageSizes:[10,30,50],visible:!0,showNavigationButtons:!0},columns:d.columnsSelected,"export":{enabled:!0,fileName:"cpa_second"}},d.cpaBucketThird={showBorders:!0,alignment:"left",bindingOptions:{dataSource:"cpa.cpaBucketRequestThird"},howBorders:!0,showRowLines:!0,paging:{enabled:!0,pageSize:10},remoteOperations:!1,allowColumnReordering:!0,allowColumnResizing:!0,columnAutoWidth:!0,pager:{showPageSizeSelector:!0,allowedPageSizes:[10,30,50],visible:!0,showNavigationButtons:!0},columns:d.columnsSelected,"export":{enabled:!0,fileName:"cpa_third"}},d.cpaBucketFourth={showBorders:!0,alignment:"left",bindingOptions:{dataSource:"cpa.cpaBucketRequestFourth"},howBorders:!0,showRowLines:!0,paging:{enabled:!0,pageSize:10},remoteOperations:!1,allowColumnReordering:!0,allowColumnResizing:!0,columnAutoWidth:!0,pager:{showPageSizeSelector:!0,allowedPageSizes:[10,30,50],visible:!0,showNavigationButtons:!0},columns:d.columnsSelected,"export":{enabled:!0,fileName:"cpa_fourth"}}}e.$inject=["$window","$state","$localStorage","$translate","CPA","ChartDetails","CpaBucketsAll","Campaign"],angular.module("pjtLayout").controller("CPAController",e)}(),function(){"use strict";function e(e,t,a){function n(t){return e({method:"GET",headers:{Authorization:"Token "+a.get("token")},url:"/api/v1/campaigns/"+encodeURI(t)}).then(function(e){return e.data})["catch"](function(e){return e})}function i(n,i,o,r){return e({method:"GET",url:"/api/v1/campaigns/"+encodeURI(n)+"/graphinfo",headers:{Authorization:"Token "+a.get("token")},params:{from_date:i,to_date:o,by:r}}).then(function(e){for(var a in e.data)e.data[a].ctr=+parseFloat(e.data[a].ctr).toFixed(4),e.data[a].conversions=+parseFloat(e.data[a].conversions).toFixed(4),e.data[a].impression=+parseFloat(e.data[a].impression).toFixed(4),e.data[a].cpa=+parseFloat(e.data[a].cpa).toFixed(4),e.data[a].cpc=+parseFloat(e.data[a].cpc).toFixed(4),e.data[a].clicks=+parseFloat(e.data[a].clicks).toFixed(4),e.data[a].cost=+parseFloat(e.data[a].mediaspent).toFixed(4),e.data[a].day=t.moment(e.data[a].day).format("DD/MM");return e.data})["catch"](function(e){return e})}function o(n,i,o){return e({method:"GET",url:"/api/v1/campaigns/"+encodeURI(n)+"/cpareport",headers:{Authorization:"Token "+a.get("token")},params:{from_date:i,to_date:o}}).then(function(e){for(var a in e.data)e.data[a].avg=+parseFloat(e.data[a].avg).toFixed(4),e.data[a].ctr=+parseFloat(e.data[a].ctr).toFixed(4),e.data[a].close=+parseFloat(e.data[a].close).toFixed(4),e.data[a].high=+parseFloat(e.data[a].high).toFixed(4),e.data[a].low=+parseFloat(e.data[a].low).toFixed(4),e.data[a].open=+parseFloat(e.data[a].open).toFixed(4),e.data[a].day=t.moment().locale("en").isoWeekday(e.data[a].date).format("ddd");
return e.data})["catch"](function(e){return e})}function r(t,n,i,o,r,s,d,l,c){return s?(d=s[0].desc===!0?"desc":"asc",s=s[0].selector):(s="placement",d="DESC"),null==r&&(r=10),null==o&&(o=0),e({method:"GET",url:"/api/v1/campaigns/"+encodeURI(t)+"/domains",headers:{Authorization:"Token "+a.get("token")},params:{from_date:n,to_date:i,skip:o,take:r,sort:s,order:d,filter:l,totalSummary:c}}).then(function(e){var t=e.data.data.map(function(e){return{NetworkPublisher:e.NetworkPublisher,placement:e.placement,placement_name:e.placement_name,placement__rtbimpressiontrackerplacementdomain__domain:e.placement__rtbimpressiontrackerplacementdomain__domain,cvr:parseFloat((e.cvr||0).toFixed(2)/100),ctr:parseFloat((e.ctr||0).toFixed(2)/100),cpc:parseFloat((e.cpc||0).toFixed(4)),cpm:parseFloat((e.cpm||0).toFixed(4)),imp:parseFloat((e.imp||0).toFixed(4)),cpa:parseFloat((e.cpa||0).toFixed(4)),clicks:parseFloat((e.clicks||0).toFixed(4)),conv:parseFloat((e.conv||0).toFixed(4)),cost:parseFloat((e.cost||0).toFixed(2)),imps_viewed:parseFloat((e.imps_viewed||0).toFixed(4)),view_measured_imps:parseFloat((e.view_measured_imps||0).toFixed(4)),view_measurement_rate:parseFloat((e.view_measurement_rate||0).toFixed(1)/100),view_rate:parseFloat((e.view_rate||0).toFixed(1)/100),state:{blackList:2&e.state,suspended:1&e.state,whiteList:4&e.state}}});return m=e.data.totalCount,u.totalSummary=e.data.totalSummary,t})["catch"](function(e){return e})}function s(n,i,o,r){return e({method:"POST",url:"/api/v1/campaigns/"+encodeURI(n)+"/changestate",headers:{Authorization:"Token "+a.get("token")},data:{placement:i,activeState:o,suspendTimes:r}}).then(function(e){return e.data})["catch"](function(e){t.DevExpress.ui.notify(e.data.detail,"error",4e3)})}function d(e,a,n,o){return new t.DevExpress.data.CustomStore({totalCount:function(){return 0},load:function(){return i(e,a,n,o)}})}function l(e,a,n){return new t.DevExpress.data.CustomStore({totalCount:function(){return 0},load:function(){return o(e,a,n)}})}function c(e,a,n){return new t.DevExpress.data.CustomStore({totalCount:function(){return m},load:function(t){return t.searchOperation&&t.dataField&&(t.take=999999),r(e,a,n,t.skip,t.take,t.sort,t.order,t.filter,t.totalSummary)}})}var u=this,m=0;u.nameCampaigns=n,u.editCampaignDomains=s,u.getChartStore=d,u.getGridCampaignStore=c,u.getBoxPlotStore=l}e.$inject=["$http","$window","$cookies"],angular.module("pjtLayout").service("CampMain",e)}(),function(){"use strict";function e(e,t,a,n,i,o,r,s,d,l){function c(){for(var e in a.checkCharCamp)a.checkCharCamp[e]?("impression"==e&&m.gridCharts.getSeriesByName("Impressions").show(),"cpa"==e&&m.gridCharts.getSeriesByName("CPA").show(),"cpc"==e&&m.gridCharts.getSeriesByName("CPC").show(),"clicks"==e&&m.gridCharts.getSeriesByName("Clicks").show(),"cost"==e&&m.gridCharts.getSeriesByName("Cost").show(),"conversions"==e&&m.gridCharts.getSeriesByName("Conversions").show(),"ctr"==e&&m.gridCharts.getSeriesByName("CTR").show()):("impression"==e&&m.gridCharts.getSeriesByName("Impressions").hide(),"cpa"==e&&m.gridCharts.getSeriesByName("CPA").hide(),"cpc"==e&&m.gridCharts.getSeriesByName("CPC").hide(),"clicks"==e&&m.gridCharts.getSeriesByName("Clicks").hide(),"cost"==e&&m.gridCharts.getSeriesByName("Cost").hide(),"conversions"==e&&m.gridCharts.getSeriesByName("Conversions").hide(),"ctr"==e&&m.gridCharts.getSeriesByName("CTR").hide())}function u(t,a){return t.dataSource.postProcess=function(t){var n=e._.uniqBy(t,a);return n.map(function(e){return{text:e[a],value:e[a]}})}}var m=this,p=n.instant,h=null,v={};m.Camp=o;var C=new Date,g=!1;l.id=r.id,l.name=r.campaign,l.line_item=r.line_item,l.line_item_id=r.line_item_id,m.checkChart=[],m.by="imp,cvr,cpc,clicks,spend,conv,ctr",null==a.campaign&&t.go("home.main"),a.campaign={id:r.id,name:r.campaign,line_item:r.line_item},m.campName=r.campaign,m.campId=r.id,m.line_item=r.line_item,m.line_item_id=r.line_item_id,m.Init=[],null==a.checkCharCamp&&(a.checkCharCamp={impression:!0,cpa:!1,cpc:!1,clicks:!1,cost:!1,conversions:!1,ctr:!1}),null==a.SelectedTime?(a.SelectedTime=0,a.dataStart=e.moment({hour:"00"}).subtract(1,"day").unix(),a.dataEnd=e.moment({hour:"00"}).subtract(1,"day").endOf("day").unix(),m.dataStart=e.moment({hour:"00"}).subtract(1,"day").unix(),m.dataEnd=e.moment({hour:"00"}).subtract(1,"day").endOf("day").unix()):null==a.dataStart||null==a.dataEnd?(a.SelectedTime=0,a.dataStart=e.moment({hour:"00"}).subtract(1,"day").unix(),a.dataEnd=e.moment({hour:"00"}).subtract(1,"day").endOf("day").unix(),m.dataStart=e.moment({hour:"00"}).subtract(1,"day").unix(),m.dataEnd=e.moment({hour:"00"}).subtract(1,"day").endOf("day").unix()):(m.dataStart=a.dataStart,m.dataEnd=a.dataEnd);var f=[{ID:0,Name:p("MAIN.DATE_PICKER.YESTERDAY"),dataStart:e.moment({hour:"00"}).subtract(1,"day").unix(),dataEnd:e.moment({hour:"00"}).subtract(1,"day").endOf("day").unix()},{ID:1,Name:p("MAIN.DATE_PICKER.LAST_3_DAYS"),dataStart:e.moment({hour:"00"}).subtract(3,"day").unix(),dataEnd:e.moment({hour:"00"}).unix()},{ID:2,Name:p("MAIN.DATE_PICKER.LAST_7_DAYS"),dataStart:e.moment({hour:"00"}).subtract(7,"day").unix(),dataEnd:e.moment({hour:"00"}).unix()},{ID:3,Name:p("MAIN.DATE_PICKER.LAST_14_DAYS"),dataStart:e.moment({hour:"00"}).subtract(14,"day").unix(),dataEnd:e.moment({hour:"00"}).unix()},{ID:4,Name:p("MAIN.DATE_PICKER.LAST_21_DAYS"),dataStart:e.moment({hour:"00"}).subtract(21,"day").unix(),dataEnd:e.moment({hour:"00"}).unix()},{ID:5,Name:p("MAIN.DATE_PICKER.CURRENT_MONTH"),dataStart:e.moment().startOf("month").unix(),dataEnd:e.moment().unix()},{ID:6,Name:p("MAIN.DATE_PICKER.LAST_MONTH"),dataStart:e.moment().subtract(1,"month").startOf("month").unix(),dataEnd:e.moment().subtract(1,"month").endOf("month").unix()},{ID:7,Name:p("MAIN.DATE_PICKER.LAST_90_DAYS"),dataStart:e.moment({hour:"00"}).subtract(90,"day").unix(),dataEnd:e.moment().unix()},{ID:8,Name:p("MAIN.DATE_PICKER.ALL_TIME"),dataStart:0,dataEnd:e.moment().unix()}];m.datePiker={items:f,displayExpr:"Name",valueExpr:"ID",value:f[a.SelectedTime].ID,onValueChanged:function(e){a.SelectedTime=e.value,a.dataStart=f[e.value].dataStart,a.dataEnd=f[e.value].dataEnd,t.reload()}},m.optimiser={text:p("CAMP.GO-OPTIMISER"),onClick:function(){t.go("home.campaignOptimiser",{id:m.campId})}},m.chartStore=o.getChartStore(m.campId,m.dataStart,m.dataEnd,m.by),m.boxPlotStore=o.getBoxPlotStore(m.campId,m.dataStart,m.dataEnd),m.gridStore=o.getGridCampaignStore(m.campId,m.dataStart,m.dataEnd);var S=angular.element(e.document.querySelector("#wrapper"))[0];S.classList.remove("hidden-menu"),m.charIsUpdating=!1,m.chartOptionsFirst={onDone:function(){var e=$("#zoomedChartFirst").dxChart("instance");if(!m.charIsUpdating){var t=[],n="left";m.chartOptionsFirst.valueAxis.forEach(function(i,o){var r=a.checkCharCamp[i.name];t.push({name:i.name,position:n,label:{alignment:"center",customizeText:function(){m.charIsUpdating=!0;var t=e._valueAxes[o]._majorTicks,a=null;if(Array.isArray(t)&&a<t[t.length-1].value&&(a=t[t.length-1].value),this.value==a)switch(i.name){case"impression":return'<span style="color:black; font-weight: bolder; text-decoration:underline;">'+p("MAIN.CHECKBOX.IMPRESSIONS")+"</span><br>"+this.value.toString().split(/(?=(?:\d{3})+(?!\d))/).join();case"cpa":return'<span style="color:black; font-weight: bolder; text-decoration:underline;">$'+p("CAMP.CHECKBOX.CPA")+"</span><br>$"+this.value;case"cpc":return'<span style="color:black; font-weight: bolder; text-decoration:underline;">$'+p("CAMP.CHECKBOX.CPC")+"</span><br>$"+this.value;case"clicks":return'<span style="color:black; font-weight: bolder; text-decoration:underline;">'+p("CAMP.CHECKBOX.CLICKS")+"</span><br>"+this.value;case"cost":return'<span style="color:black; font-weight: bolder; text-decoration:underline;">'+p("CAMP.CHECKBOX.COST")+"</span><br>$"+this.value;case"conversions":return'<span style="color:black; font-weight: bolder; text-decoration:underline;">'+p("CAMP.CHECKBOX.CONVERSIONS")+"</span><br>"+this.value;case"ctr":return'<span style="color:black; font-weight: bolder; text-decoration:underline;">'+p("CAMP.CHECKBOX.CTR")+"%</span><br>"+this.value+"%";default:return'<span style="color:black; font-weight: bolder; text-decoration:underline;">'+i.name+"</span><br>"+this.value}else switch(i.name){case"impression":return this.value.toString().split(/(?=(?:\d{3})+(?!\d))/).join();case"cpa":return"$"+this.value;case"cpc":return"$"+this.value;case"cost":return"$"+this.value;case"spend":return"$"+this.value;case"ctr":return this.value+"%"}return this.value}}}),r&&(n="left"==n?"right":"left")}),e.option("valueAxis",t)}},onInitialized:function(e){m.chartOptionsFuncFirst=e.component},valueAxis:[{name:"impression",position:"left"},{name:"cpa",position:"left"},{name:"cpc",position:"left"},{name:"clicks",position:"left"},{name:"cost",position:"left"},{name:"conversions",position:"left"},{name:"ctr",position:"left"}],argumentAxis:{discreteAxisDivisionMode:"crossLabels",grid:{visible:!0}},crosshair:{enabled:!0,color:"deepskyblue",visible:!0,horizontalLine:{label:{visible:!0,customizeText:function(e){return"Cost"==e.point.series.name||"CPC"==e.point.series.name||"CPA"==e.point.series.name?"$"+this.value:"Impressions"==e.point.series.name?this.value.toString().split(/(?=(?:\d{3})+(?!\d))/).join():"CTR"==e.point.series.name||"CVR"==e.point.series.name?this.value+"%":void 0}}},verticalLine:{label:{visible:!0}}},legend:{verticalAlignment:"top",horizontalAlignment:"center",itemTextPosition:"top"},commonSeriesSettings:{point:{size:7,hoverStyle:{border:{visible:!0,width:2},size:5}}},bindingOptions:{dataSource:"campmain.chartStore"},series:[{name:"Impressions",argumentField:"day",valueField:"impression",axis:"impression",visible:a.checkCharCamp.impression},{argumentField:"day",valueField:"cpa",name:"CPA",axis:"cpa",visible:a.checkCharCamp.cpa},{argumentField:"day",valueField:"cpc",name:"CPC",axis:"cpc",visible:a.checkCharCamp.cpc},{argumentField:"day",valueField:"clicks",name:"Clicks",axis:"clicks",visible:a.checkCharCamp.clicks},{argumentField:"day",valueField:"cost",name:"Cost",axis:"cost",visible:a.checkCharCamp.cost},{argumentField:"day",valueField:"conversions",name:"Conversions",axis:"conversions",visible:a.checkCharCamp.conversions},{argumentField:"day",valueField:"ctr",name:"CTR",axis:"ctr",visible:a.checkCharCamp.ctr}],loadingIndicator:{show:!0,text:"Creating a chart..."}},m.rangeOptionsFirst={size:{height:80},scale:{minorTickInterval:"day",tickInterval:{days:1},minRange:"day",maxRange:"year",minorTick:{visible:!0}},bindingOptions:{dataSource:"campmain.chartStore"},dataSourceField:"day",sliderMarker:{format:"monthAndDay"},behavior:{callSelectedRangeChanged:"onMoving"},onSelectedRangeChanged:function(t){var a=e.$("#zoomedContainerFirst #zoomedChartFirst").dxChart("instance");a.zoomArgument(t.startValue,t.endValue)}},m.updateCharts=function(t,n,i){a.checkCharCamp[n]=i,m.gridCharts=e.$("#zoomedChartFirst").dxChart("instance"),m.rangeChartFirst=e.$("#rangeChartFirst").dxRangeSelector("instance"),i?m.gridCharts.getSeriesByName(t).show():m.chartOptionsFuncFirst.getSeriesByName(t).hide()},m.onlyTwo=function(e){var t=0,a=[],n=[];for(t=0;t<m.Init.length;t++)1==m.Init[t]._options.value?a.push(m.Init[t]):n.push(m.Init[t]);if(1==e){if(2==a.length&&n.length>4)for(t=0;t<n.length;t++)n[t].option("disabled",!0)}else if(a.length<=2)for(t=0;t<n.length;t++)n[t].option("disabled",!1)},m.impressions={text:p("CAMP.CHECKBOX.IMPRESSIONS"),value:a.checkCharCamp.impression,onInitialized:function(e){m.Init.push(e.component)},onValueChanged:function(e){m.updateCharts("Impressions","impression",e.value),m.onlyTwo(e.value),m.charIsUpdating=!1,m.chartOptionsFirst.onDone(),c()}},m.CPA={text:p("CAMP.CHECKBOX.CPA"),value:a.checkCharCamp.cpa,onInitialized:function(e){m.Init.push(e.component)},onValueChanged:function(e){m.updateCharts("CPA","cpa",e.value),m.onlyTwo(e.value),m.charIsUpdating=!1,m.chartOptionsFirst.onDone(),c()}},m.CPC={text:p("CAMP.CHECKBOX.CPC"),value:a.checkCharCamp.cpc,onInitialized:function(e){m.Init.push(e.component)},onValueChanged:function(e){m.updateCharts("CPC","cpc",e.value),m.onlyTwo(e.value),m.charIsUpdating=!1,m.chartOptionsFirst.onDone(),c()}},m.clicks={text:p("CAMP.CHECKBOX.CLICKS"),value:a.checkCharCamp.clicks,onInitialized:function(e){m.Init.push(e.component)},onValueChanged:function(e){m.updateCharts("Clicks","clicks",e.value),m.onlyTwo(e.value),m.charIsUpdating=!1,m.chartOptionsFirst.onDone(),c()}},m.cost={text:p("CAMP.CHECKBOX.COST"),value:a.checkCharCamp.cost,onInitialized:function(e){m.Init.push(e.component)},onValueChanged:function(e){m.updateCharts("Cost","cost",e.value),m.onlyTwo(e.value),m.charIsUpdating=!1,m.chartOptionsFirst.onDone(),c()}},m.conversions={text:p("CAMP.CHECKBOX.CONVERSIONS"),value:a.checkCharCamp.conversions,onInitialized:function(e){m.Init.push(e.component)},onValueChanged:function(e){m.updateCharts("Conversions","conversions",e.value),m.onlyTwo(e.value),m.charIsUpdating=!1,m.chartOptionsFirst.onDone(),c()}},m.CTR={text:p("CAMP.CHECKBOX.CTR"),value:a.checkCharCamp.ctr,onInitialized:function(e){m.Init.push(e.component)},onValueChanged:function(e){m.updateCharts("CTR","ctr",e.value),m.onlyTwo(e.value),m.charIsUpdating=!1,m.chartOptionsFirst.onDone(),c()}},i(function(){var e=0,t=[],a=[];for(e=0;e<m.Init.length;e++)1==m.Init[e]._options.value?t.push(m.Init[e]):a.push(m.Init[e]);if(t.length>=2&&a.length>4)for(e=0;e<a.length;e++)a[e].option("disabled",!0)}),m.chartOptionsSecond={bindingOptions:{dataSource:"campmain.boxPlotStore"},valueAxis:{title:"CPA, $"},argumentAxis:{grid:{visible:!0},label:{visible:!0},discreteAxisDivisionMode:"crossLabels"},tooltip:{enabled:!0,customizeTooltip:function(e){return"Series 2"===e.seriesName?{text:"Average: $"+e.originalValue}:"Series 1"===e.seriesName?{text:"Q1: $"+e.openValue+"<br/>Q3: $"+e.closeValue+"<br/>High: $"+e.highValue+"<br/>Low: $"+e.lowValue+"<br/>"}:void 0}},legend:{visible:!1},loadingIndicator:{show:!0,text:"Creating a chart..."},useAggregation:!0,commonSeriesSettings:{candlestick:{openValueField:"open",closeValueField:"close",highValueField:"high",lowValueField:"low"},argumentField:"day",point:{size:6,hoverStyle:{border:{visible:!0,width:1},size:4}}},series:[{type:"candlestick"},{valueField:"avg",color:"silver"}]},m.rangeOptionsSecond={size:{height:80},bindingOptions:{dataSource:"campmain.boxPlotStore"},scale:{minorTickInterval:"day",tickInterval:{days:1},minRange:"day",maxRange:"year",minorTick:{visible:!0}},dataSourceField:"day",sliderMarker:{format:"week"},behavior:{callSelectedRangeChanged:"onMoving"},onSelectedRangeChanged:function(t){var a=e.$("#zoomedContainerSecond #zoomedChartSecond").dxChart("instance");a.zoomArgument(new Date(t.startValue),new Date(t.endValue))}},m.selectedItems=[],m.chartOptionsFuncgrid=[],m.state="",m.selectCell={dataSource:[{name:"White List",state:"whiteList"},{name:"Black List",state:"blackList"},{name:"Suspended",state:"suspended"}],disabled:!0,placeholder:"Select a state",displayExpr:"name",valueExpr:m.state,onSelectionChanged:function(){var t=e.$("#gridContainer2")[0].querySelectorAll('[aria-selected="true"]');if(t[0])for(var a=[],n=0;n<t.length;n++)a.push(t[n].firstChild.innerText)}},m.UI={dateFormatPop:{disabled:!0,type:"date",value:C,onValueChanged:function(e){h=e.value}},radioGroupMain:{items:[p("CO.24-HRS"),p("CO.3-DAYS"),p("CO.7-DAYS"),p("CO.SPECIFIC-DATE")],value:p("CO.24-HRS"),onValueChanged:function(e){var t=$("#radioGroupSend").dxRadioGroup("instance");if(e.value)if(t.option("value",!1),e.value==p("CO.SPECIFIC-DATE")){var a=$("#dateFormatPop").dxDateBox("instance");a.option("disabled",!1)}else{var a=$("#dateFormatPop").dxDateBox("instance");a.option("disabled",!0),h=null}}},radioGroupSend:{items:[p("CO.SEND-TO-SUSPEND-LIST")],onValueChanged:function(e){h=null;var t=$("#dateFormatPop").dxDateBox("instance");t.option("disabled",!0);var a=$("#radioGroupMain").dxRadioGroup("instance");e.value&&a.option("value",!1)}},confirmPopup:{onInitialized:function(e){m.confirmPopup=e.component},bindingOptions:{visible:"crc.confirmPopupVisible"},showTitle:!1,width:320,height:300},confirmPopupOk:{width:110,text:"OK",disabled:!1,onClick:function(){g=!0;var t,a=$("#radioGroupMain").dxRadioGroup("instance"),n=$("#radioGroupSend").dxRadioGroup("instance");a._options.value!==!1&&(a._options.value==p("CO.24-HRS")&&(t=e.moment().add(1,"day").unix()),a._options.value==p("CO.3-DAYS")&&(t=e.moment().add(3,"day").unix()),a._options.value==p("CO.7-DAYS")&&(t=e.moment().add(7,"day").unix())),n._options.value!==!1&&(t="unlimited"),null!==h&&(t=e.moment(h).unix()),null==n._options.value&&a._options.value==p("CO.24-HRS")&&(t=e.moment().add(1,"day").unix());for(var i=0;i<v.placement.length;i++){var r=e.$("div.state-white"+v.placement[i]),d=e.$("div.state-black"+v.placement[i]),l=e.$("div.state-suspended"+v.placement[i]);r.dxButton("instance").option("disabled",!0),d.dxButton("instance").option("disabled",!0),l.dxButton("instance").option("disabled",!0),r.removeClass("active"),d.removeClass("active"),l.removeClass("active")}o.editCampaignDomains(m.campId,v.placement,1,t).then(function(t){for(var a=0;a<v.placement.length;a++){var n=e.$("div.state-black"+v.placement[a]),i=e.$("div.state-white"+v.placement[a]),o=e.$("div.state-suspended"+v.placement[a]);if(i.dxButton("instance").option("disabled",!1),n.dxButton("instance").option("disabled",!1),o.dxButton("instance").option("disabled",!1),404==t)return e.DevExpress.ui.notify("Not found","warning",4e3),e.$("#gridContainer2").dxDataGrid("instance").refresh(),t;if(503==t)return e.DevExpress.ui.notify("Not connect to appnexus server, please try again later","warning",4e3),e.$("#gridContainer2").dxDataGrid("instance").refresh(),t;"Unactive"!==t&&o.addClass("active")}g=!1}),m.confirmPopupVisible=!1,m.confirmPopup.option("visible",!1),s.$apply()}},confirmPopupCancel:{width:120,text:p("COMMON.CANCEL"),onClick:function(){m.confirmPopup.option("visible",!1),s.$apply()}}},m.dataGridOptionsCampaign={onInitialized:function(e){m.dataGridOptionsMultipleFunc=e.component,m.dataGridOptionsMultipleFunc._controllers.columns._commandColumns[1].visibleIndex=9,m.dataGridOptionsMultipleFunc._controllers.columns._commandColumns[1].width=35},onRowPrepared:function(e){if(m.objectData=e,"data"==m.objectData.rowType){var t=e.rowElement[0].childNodes[11],a=e.data.state;"true"==a.whiteList&&t.classList.add("active-white"),"true"==a.blackList&&t.classList.add("active-black"),"true"==a.suspended&&t.classList.add("active-suspended")}},alignment:"left",headerFilter:{visible:!0},filterRow:{visible:!0,applyFilter:"auto"},loadPanel:{shadingColor:"rgba(0,0,0,0.4)",visible:!1,showIndicator:!0,showPane:!0,shading:!0,closeOnOutsideClick:!1},bindingOptions:{dataSource:"campmain.gridStore"},paging:{pageSize:10},remoteOperations:!0,pager:{showPageSizeSelector:!0,allowedPageSizes:[10,30,50],visible:!0,showNavigationButtons:!0},allowColumnReordering:!0,allowColumnResizing:!0,columnAutoWidth:!0,wordWrapEnabled:!0,showBorders:!0,showRowLines:!0,columns:[{caption:p("CAMP.CAMPAIGN.COLUMNS.PLACEMENT"),dataField:"placement",alignment:"center",dataType:"number",headerFilter:{dataSource:function(e){return u(e,"placement")}}},{caption:p("CAMP.CAMPAIGN.COLUMNS.DOMAIN"),dataField:"placement__rtbimpressiontrackerplacementdomain__domain",alignment:"center",dataType:"string",allowEditing:!1,headerFilter:{dataSource:function(e){return u(e,"domain")}}},{caption:p("CAMP.CAMPAIGN.COLUMNS.NETWORK"),dataField:"NetworkPublisher",alignment:"center",dataType:"string",headerFilter:{dataSource:function(e){return u(e,"NetworkPublisher")}}},{caption:p("CAMP.CAMPAIGN.COLUMNS.CONV"),dataField:"conv",alignment:"center",dataType:"number",headerFilter:{dataSource:function(e){return u(e,"conv")}}},{caption:p("CAMP.CAMPAIGN.COLUMNS.IMP"),dataField:"imp",dataType:"number",sortOrder:"desc",format:"fixedPoint",alignment:"center",headerFilter:{dataSource:function(e){return u(e,"imp")}}},{caption:p("CAMP.CAMPAIGN.COLUMNS.CPA")+" ,$",dataField:"cpa",dataType:"number",format:"currency",precision:4,alignment:"center",headerFilter:{dataSource:function(e){return u(e,"cpa")}}},{caption:p("CAMP.CAMPAIGN.COLUMNS.COST")+" ,$",dataField:"cost",alignment:"center",format:"currency",precision:2,dataType:"number",headerFilter:{dataSource:function(e){return u(e,"cost")}}},{caption:p("CAMP.CAMPAIGN.COLUMNS.CLICKS"),dataField:"clicks",alignment:"center",dataType:"number",headerFilter:{dataSource:function(e){return u(e,"clicks")}}},{caption:p("CAMP.CAMPAIGN.COLUMNS.CPC")+" ,$",dataField:"cpc",alignment:"center",format:"currency",precision:4,dataType:"number",headerFilter:{dataSource:function(e){return u(e,"cpc")}}},{caption:p("CAMP.CAMPAIGN.COLUMNS.CPM")+" ,$",dataField:"cpm",alignment:"center",format:"currency",precision:4,dataType:"number",headerFilter:{dataSource:function(e){return u(e,"cpm")}}},{caption:p("CAMP.CAMPAIGN.COLUMNS.CVR")+" ,%",dataField:"cvr",alignment:"center",format:"percent",precision:2,dataType:"number",headerFilter:{dataSource:function(e){return u(e,"cvr")}}},{caption:p("CAMP.CAMPAIGN.COLUMNS.CTR")+" ,%",dataField:"ctr",alignment:"center",format:"percent",precision:2,dataType:"number",headerFilter:{dataSource:function(e){return u(e,"ctr")}}},{caption:p("CAMP.CAMPAIGN.COLUMNS.IMPS_VIEWED"),dataField:"imps_viewed",alignment:"center",visible:!1,width:80,dataType:"number",format:"fixedPoint",headerFilter:{dataSource:function(e){return u(e,"imps_viewed")}}},{caption:p("CAMP.CAMPAIGN.COLUMNS.VIEW_MEASURED_IMPS"),dataField:"view_measured_imps",alignment:"center",visible:!1,width:100,dataType:"number",format:"fixedPoint",headerFilter:{dataSource:function(e){return u(e,"view_measured_imps")}}},{caption:p("CAMP.CAMPAIGN.COLUMNS.VIEW_MEASUREMENT_RATE")+" ,%",dataField:"view_measurement_rate",alignment:"center",visible:!1,width:120,format:"percent",precision:1,dataType:"number",headerFilter:{dataSource:function(e){return u(e,"view_measurement_rate")}}},{caption:p("CAMP.CAMPAIGN.COLUMNS.VIEW_RATE")+" ,%",dataField:"view_rate",alignment:"center",visible:!1,width:80,format:"percent",precision:1,dataType:"number",headerFilter:{dataSource:function(e){return u(e,"view_rate")}}},{caption:p("CAMP.CAMPAIGN.COLUMNS.STATE"),width:300,columnIndex:16,dataField:"state",allowEditing:!1,headerFilter:{dataSource:[{text:"White",value:["state","=",4]},{text:"Black",value:["state","=",2]},{text:"Suspended",value:["state","=",1]}]},cellTemplate:function(t,a){var n=e.$("<div />").dxButton({text:"white",height:30,width:89,disabled:!1,onClick:function(t){var n=e.$("div.state-white"+a.data.placement),i=e.$("div.state-black"+a.data.placement),r=e.$("div.state-suspended"+a.data.placement);n.dxButton("instance").option("disabled",!0),i.dxButton("instance").option("disabled",!0),r.dxButton("instance").option("disabled",!0),n.removeClass("active"),i.removeClass("active"),r.removeClass("active"),o.editCampaignDomains(m.campId,[a.data.placement],4).then(function(t){return n.dxButton("instance").option("disabled",!1),i.dxButton("instance").option("disabled",!1),r.dxButton("instance").option("disabled",!1),404==t?(e.DevExpress.ui.notify("Not found","warning",4e3),$("#gridContainerWhite").dxDataGrid("instance").refresh(),t):503==t?(e.DevExpress.ui.notify("Not connect to appnexus server, please try again later","warning",4e3),e.$("#gridContainer2").dxDataGrid("instance").refresh(),t):("Unactive"!==t&&n.addClass("active"),t)})["catch"](function(e){return e})}});4==a.data.state.whiteList?n.addClass("state-white"+a.data.placement).addClass("active").appendTo(t):n.addClass("state-white"+a.data.placement).appendTo(t);var i=e.$("<div />").dxButton({text:"black",height:30,width:89,disabled:!1,onClick:function(t){var n=e.$("div.state-white"+a.data.placement),i=e.$("div.state-black"+a.data.placement),r=e.$("div.state-suspended"+a.data.placement);n.dxButton("instance").option("disabled",!0),i.dxButton("instance").option("disabled",!0),r.dxButton("instance").option("disabled",!0),n.removeClass("active"),i.removeClass("active"),r.removeClass("active"),o.editCampaignDomains(m.campId,[a.data.placement],2).then(function(t){return n.dxButton("instance").option("disabled",!1),i.dxButton("instance").option("disabled",!1),r.dxButton("instance").option("disabled",!1),404==t?(e.DevExpress.ui.notify("Not found","warning",4e3),e.$("#gridContainer2").dxDataGrid("instance").refresh(),t):503==t?(e.DevExpress.ui.notify("Not connect to appnexus server, please try again later","warning",4e3),e.$("#gridContainer2").dxDataGrid("instance").refresh(),t):("Unactive"!==t&&i.addClass("active"),t)})["catch"](function(e){return e})}});2==a.data.state.blackList?i.addClass("state-black"+a.data.placement).addClass("active").appendTo(t):i.addClass("state-black"+a.data.placement).appendTo(t);var r=e.$("<div />").dxButton({text:"suspend",height:30,width:95,disabled:!1,onClick:function(){return 1==g?(e.DevExpress.ui.notify("Wait please","warning",4e3),0):(v.placement=[a.data.placement],v.suspend=1,void m.confirmPopup.option("visible",!0))}});1==a.data.state.suspended?r.addClass("state-suspended"+a.data.placement).addClass("active").appendTo(t):r.addClass("state-suspended"+a.data.placement).appendTo(t)}}],summary:{totalItems:[{column:"placement",summaryType:"count",customizeText:function(e){return e.valueText="Count: "+m.dataGridOptionsMultipleFunc.totalCount(),e.valueText}},{column:"conv",summaryType:"sum",customizeText:function(e){return e.valueText="Conv: "+m.Camp.totalSummary.conv,e.valueText}},{column:"imp",summaryType:"sum",customizeText:function(e){return e.valueText="Imp: "+m.Camp.totalSummary.imp.toString().split(/(?=(?:\d{3})+(?!\d))/).join(),e.valueText}},{column:"cpa",summaryType:"sum",valueFormat:"currency",customizeText:function(e){return e.valueText="CPA: $"+m.Camp.totalSummary.cpa.toFixed(4),e.valueText}},{column:"cost",summaryType:"sum",valueFormat:"currency",customizeText:function(e){return e.valueText="Cost: $"+m.Camp.totalSummary.cost.toFixed(2),e.valueText}},{column:"clicks",summaryType:"sum",customizeText:function(e){return e.valueText="Clicks: "+m.Camp.totalSummary.clicks,e.valueText}},{column:"cpc",summaryType:"sum",customizeText:function(e){return e.valueText="CPC: $"+m.Camp.totalSummary.cpc.toFixed(4),e.valueText}},{column:"cpm",summaryType:"sum",customizeText:function(e){return e.valueText="CPM: $"+m.Camp.totalSummary.cpm.toFixed(4),e.valueText}},{column:"cvr",summaryType:"sum",customizeText:function(e){return e.valueText="CVR: %"+m.Camp.totalSummary.cvr.toFixed(4),e.valueText}},{column:"ctr",valueFormat:"percent",summaryType:"sum",customizeText:function(e){return e.valueText="CTR: %"+m.Camp.totalSummary.ctr.toFixed(4),e.valueText}}]},columnChooser:{enabled:!0,height:180,width:400,emptyPanelText:"A place to hide the columns"},selection:{mode:"multiple",allowSelectAll:!1,showCheckBoxesMode:"always"},onEditorPreparing:function(t){"filterRow"==t.parentType&&"state"==t.dataField&&(t.editorElement.dxSelectBox({dataSource:[{name:"White List",state:4},{name:"Black List",state:2},{name:"Suspended",state:1},{name:"Clear state",state:0}],placeholder:"Select a state",displayExpr:"name",valueExpr:m.state,onSelectionChanged:function(t){var a=e.$("#gridContainer2")[0].querySelectorAll('[aria-selected="true"]');if(!a[0])return e.DevExpress.ui.notify(p("CO.NO-ITEMS-CHOSEN"),"warning",4e3);for(var n=[],i=0;i<a.length;i++)n.push(a[i].firstChild.innerText);if(1==t.selectedItem.state)"[]"!=n&&(v.placement=n,v.suspend="suspend",m.confirmPopupVisible=!0,m.confirmPopup.option("visible",!0));else if("[]"!=n){for(var i=0;i<n.length;i++){var o=e.$("div.state-white"+n[i]),r=e.$("div.state-black"+n[i]),s=e.$("div.state-suspended"+n[i]);o.dxButton("instance").option("disabled",!0),r.dxButton("instance").option("disabled",!0),s.dxButton("instance").option("disabled",!0),o.removeClass("active"),r.removeClass("active"),s.removeClass("active")}d.editCampaignDomains(m.campId,n,t.selectedItem.state).then(function(a){for(var i=0;i<n.length;i++){var o=e.$("div.state-black"+n[i]),r=e.$("div.state-white"+n[i]),s=e.$("div.state-suspended"+n[i]);if(r.dxButton("instance").option("disabled",!1),o.dxButton("instance").option("disabled",!1),s.dxButton("instance").option("disabled",!1),404==a)return e.DevExpress.ui.notify("Not found","warning",4e3),e.$("#gridContainer2").dxDataGrid("instance").refresh(),a;if(503==a)return e.DevExpress.ui.notify("Not connect to appnexus server, please try again later","warning",4e3),e.$("#gridContainer2").dxDataGrid("instance").refresh(),a;2==t.selectedItem.state&&o.addClass("active"),4==t.selectedItem.state&&r.addClass("active")}$("#gridContainer2").dxDataGrid("instance").refresh()})}}}),t.cancel=!0)},onSelectionChanged:function(e){m.selectedItems=e.selectedRowsData,m.disabled=!m.selectedItems.length}}}e.$inject=["$window","$state","$localStorage","$translate","$timeout","CampMain","Campaign","$scope","CampaignOptimiser","$rootScope"],angular.module("pjtLayout").controller("CampaignMainController",e)}(),function(){"use strict";function e(e,t,a){function n(){return new a.DevExpress.data.CustomStore({totalCount:function(){return 0},load:function(){return i("send")}})}function i(n){return e({method:"GET",url:"/api/v1/MLRandomTestSet",headers:{Authoriszation:"Token "+t.get("token")},params:{action:n}}).then(function(e){for(var t in e.data)e.data[t].imps=parseFloat((e.data[t].imps||0).toFixed(4)),e.data[t].clicks=parseFloat((e.data[t].clicks||0).toFixed(4)),e.data[t].total_convs=parseFloat((e.data[t].total_convs||0).toFixed(4)),e.data[t].imps_viewed=parseFloat((e.data[t].imps_viewed||0).toFixed(4)),e.data[t].view_measured_imps=parseFloat((e.data[t].view_measured_imps||0).toFixed(4)),e.data[t].sum_cost=parseFloat((e.data[t].sum_cost||0).toFixed(4)),e.data[t].cpa=parseFloat((e.data[t].cpa||0).toFixed(4)),e.data[t].ctr=parseFloat((e.data[t].ctr||0).toFixed(4)),e.data[t].cvr=parseFloat((e.data[t].cvr||0).toFixed(4)),e.data[t].cpc=parseFloat((e.data[t].cpc||0).toFixed(4)),e.data[t].cpm=parseFloat((e.data[t].cpm||0).toFixed(4)),e.data[t].view_rate=parseFloat((e.data[t].view_rate||0).toFixed(1)),e.data[t].view_measurement_rate=parseFloat((e.data[t].view_measurement_rate||0).toFixed(1));return e.data})["catch"](function(e){a.DevExpress.ui.notify(e.data.detail,"error",4e3)})}function o(n,i){return e({method:"GET",url:"/api/v1/MLExpertMark",headers:{Authorization:"Token "+t.get("token")},params:{placementId:n,day:7,decision:i}}).then(function(e){return e.status})["catch"](function(e){a.DevExpress.ui.notify(e.statusText,"error",4e3)})}function r(n){return e({method:"GET",url:"/api/v1/MLGetAUC",headers:{Authorization:"Token "+t.get("token")},params:{test_type:n,test_name:"ctr_cvr_cpc_cpm_cpa"}}).then(function(e){for(var t in e.data.chartCoord)e.data.chartCoord[t].rocSensetivities=parseFloat((e.data.chartCoord[t].rocSensetivities||0).toFixed(4)),e.data.chartCoord[t].rocFalsePositiveRate=parseFloat((e.data.chartCoord[t].rocFalsePositiveRate||0).toFixed(4));return e.data.auc=parseFloat((e.data.auc||0).toFixed(4)),e.data.chartCoord[0].diagonal=0,e.data.chartCoord[e.data.chartCoord.length-1].diagonal=100,e.data})["catch"](function(e){return 400==e.status?a.DevExpress.ui.notify("Not all placements are marked by experts","warning",6e3):void a.DevExpress.ui.notify(e.statusText,"error",4e3)})}function s(){return new a.DevExpress.data.CustomStore({totalCount:function(){return 0},load:function(){return r().then(function(e){return e})}})}var d=this;d.MLGetAUC=r,d.chartAUC=s,d.goodBadSend=o,d._MLRandomTestSet=i,d.getGridCampaignStore=n}e.$inject=["$http","$cookies","$window"],angular.module("pjtLayout").service("valuationByExpertS",e)}(),function(){"use strict";function e(e,t,a,n,i,o,r){var s=this,d=i.instant;s.campId=13921687,s.arrayDiagram=[],s.popUpIf=!1,s.culcReady=!1,s.chartCoord=[];var l,c;s.selectType="kmeans",s.popUpHide=function(){s.popUpIf=!1},s.auc=null,s.titlePred="",r.MLGetAUC(s.selectType).then(function(e){"log"==s.selectType&&(s.titlePred="Logistic regression"),"kmeans"==s.selectType&&(s.titlePred="K-means"),s.auc=e.auc,s.chartCoord=e.chartCoord,s.culcReady=!0;
}),null==a.SelectedTime?(a.SelectedTime=0,a.dataStart=e.moment({hour:"00"}).subtract(1,"day").unix(),a.dataEnd=e.moment({hour:"00"}).subtract(1,"day").endOf("day").unix(),s.dataStart=e.moment({hour:"00"}).subtract(1,"day").unix(),s.dataEnd=e.moment({hour:"00"}).subtract(1,"day").endOf("day").unix()):null==a.dataStart||null==a.dataEnd?(a.SelectedTime=0,a.dataStart=e.moment({hour:"00"}).subtract(1,"day").unix(),a.dataEnd=e.moment({hour:"00"}).subtract(1,"day").endOf("day").unix(),s.dataStart=e.moment({hour:"00"}).subtract(1,"day").unix(),s.dataEnd=e.moment({hour:"00"}).subtract(1,"day").endOf("day").unix()):(s.dataStart=a.dataStart,s.dataEnd=a.dataEnd);var u=[{ID:0,Name:d("MAIN.DATE_PICKER.YESTERDAY"),dataStart:e.moment({hour:"00"}).subtract(1,"day").unix(),dataEnd:e.moment({hour:"00"}).subtract(1,"day").endOf("day").unix()},{ID:1,Name:d("MAIN.DATE_PICKER.LAST_3_DAYS"),dataStart:e.moment({hour:"00"}).subtract(3,"day").unix(),dataEnd:e.moment({hour:"00"}).unix()},{ID:2,Name:d("MAIN.DATE_PICKER.LAST_7_DAYS"),dataStart:e.moment({hour:"00"}).subtract(7,"day").unix(),dataEnd:e.moment({hour:"00"}).unix()},{ID:3,Name:d("MAIN.DATE_PICKER.LAST_14_DAYS"),dataStart:e.moment({hour:"00"}).subtract(14,"day").unix(),dataEnd:e.moment({hour:"00"}).unix()},{ID:4,Name:d("MAIN.DATE_PICKER.LAST_21_DAYS"),dataStart:e.moment({hour:"00"}).subtract(21,"day").unix(),dataEnd:e.moment({hour:"00"}).unix()},{ID:5,Name:d("MAIN.DATE_PICKER.CURRENT_MONTH"),dataStart:e.moment().startOf("month").unix(),dataEnd:e.moment().unix()},{ID:6,Name:d("MAIN.DATE_PICKER.LAST_MONTH"),dataStart:e.moment().subtract(1,"month").startOf("month").unix(),dataEnd:e.moment().subtract(1,"month").endOf("month").unix()},{ID:7,Name:d("MAIN.DATE_PICKER.LAST_90_DAYS"),dataStart:e.moment({hour:"00"}).subtract(90,"day").unix(),dataEnd:e.moment().unix()},{ID:8,Name:d("MAIN.DATE_PICKER.ALL_TIME"),dataStart:0,dataEnd:e.moment().unix()}];s.gridStore=r.getGridCampaignStore(s.campId,s.dataStart,s.dataEnd),s.UI={datePiker:{items:u,displayExpr:"Name",valueExpr:"ID",value:u[a.SelectedTime].ID,onValueChanged:function(e){a.SelectedTime=e.value,a.dataStart=u[e.value].dataStart,a.dataEnd=u[e.value].dataEnd,t.reload()}},calculateAUC:{text:d("VBE.CALCULATE-AUC"),template:function(e,t){$("<div class='button-indicator'></div><span class='dx-button-text'>"+e.text+"</span>").appendTo(t),l=t.find(".button-indicator").dxLoadIndicator({height:15,visible:!1}).dxLoadIndicator("instance")},onClick:function(e){e.component.option("text","Calculate"),l.option("visible",!0),r.MLGetAUC(s.selectType).then(function(t){"log"==s.selectType&&(s.titlePred="Logistic regression"),"kmeans"==s.selectType&&(s.titlePred="K-means"),s.auc=t.auc,s.chartCoord=t.chartCoord,s.culcReady=!0,l.option("visible",!1),e.component.option("text","Calculate AUC")})["catch"](function(t){l.option("visible",!1),e.component.option("text","Calculate AUC")})}},createTestSet:{text:d("VBE.CREATE-TEST-SET"),template:function(e,t){$("<div class='button-indicator1'></div><span class='dx-button-text'>"+e.text+"</span>").appendTo(t),c=t.find(".button-indicator1").dxLoadIndicator({height:10,visible:!1}).dxLoadIndicator("instance")},onClick:function(e){e.component.option("text","Create"),c.option("visible",!0),r._MLRandomTestSet("create").then(function(t){$(".gridContainerWhite").dxDataGrid("instance").refresh(),c.option("visible",!1),e.component.option("text","Create test set")})["catch"](function(t){c.option("visible",!1),e.component.option("text","Create test set")})}},test_type:{items:["K-means","Logistic regression"],value:"K-means",width:200,onValueChanged:function(e){"Logistic regression"==e.selectedItem&&(s.selectType="log"),"K-means"==e.selectedItem&&(s.selectType="kmeans")}},ROC_curve:{palette:"violet",bindingOptions:{dataSource:"VBE.chartCoord"},commonSeriesSettings:{argumentField:"rocFalsePositiveRate",type:"line"},margin:{bottom:20},argumentAxis:{valueMarginsEnabled:!1,discreteAxisDivisionMode:"crossLabels",grid:{visible:!0},title:"False positive rate"},size:{width:400,height:400},series:[{valueField:"rocSensetivities",name:"ROC Curve",showInLegend:!1},{valueField:"diagonal",showInLegend:!1,color:"gray"}],valueAxis:{title:{text:"Sensetivity"}},title:{text:"ROC Curve",subtitle:{text:"(Confidence interval - 95%, Confidence error - 5%)"}},"export":{enabled:!0},tooltip:{enabled:!0,customizeTooltip:function(e){return{text:e.valueText}}}},dataGridOptionsExpert:{editing:{mode:"batch"},alignment:"left",headerFilter:{visible:!0},filterRow:{visible:!0,applyFilter:"auto"},bindingOptions:{dataSource:"VBE.gridStore"},paging:{pageSize:10},loadPanel:{shadingColor:"rgba(0,0,0,0.4)",visible:!1,showIndicator:!0,showPane:!0,shading:!0,closeOnOutsideClick:!1},remoteOperations:!1,allowColumnReordering:!0,allowColumnResizing:!0,columnAutoWidth:!0,wordWrapEnabled:!0,showBorders:!0,showRowLines:!0,columns:[{caption:d("CAMP.CAMPAIGN.COLUMNS.PLACEMENT"),dataField:"placement_id",alignment:"center",dataType:"string"},{caption:d("CAMP.CAMPAIGN.COLUMNS.NETWORK"),dataField:"publisher",alignment:"center",dataType:"string"},{caption:d("CAMP.CAMPAIGN.COLUMNS.DOMAIN"),dataField:"domain",alignment:"center",dataType:"string"},{caption:d("CAMP.CAMPAIGN.COLUMNS.CONV"),dataField:"total_convs",alignment:"center",dataType:"number"},{caption:d("CAMP.CAMPAIGN.COLUMNS.IMP"),dataField:"imps",dataType:"number",sortOrder:"desc",alignment:"center",format:"fixedPoint"},{caption:d("CAMP.CAMPAIGN.COLUMNS.IMPS_VIEWED"),dataField:"imps_viewed",dataType:"number",sortOrder:"desc",alignment:"center",format:"fixedPoint"},{caption:d("CAMP.CAMPAIGN.COLUMNS.CPA")+" ,$",dataField:"cpa",dataType:"number",alignment:"center",format:"currency",precision:4},{caption:d("CAMP.CAMPAIGN.COLUMNS.COST")+" ,$",dataField:"sum_cost",dataType:"number",alignment:"center",format:"currency",precision:4},{caption:d("CAMP.CAMPAIGN.COLUMNS.CLICKS"),dataField:"clicks",alignment:"center",dataType:"number",allowEditing:!1},{caption:d("CAMP.CAMPAIGN.COLUMNS.CPC")+" ,$",dataField:"cpc",alignment:"center",dataType:"number",precision:4,format:"currency"},{caption:d("CAMP.CAMPAIGN.COLUMNS.CPM")+" ,$",dataField:"cpm",alignment:"center",dataType:"number",precision:4,format:"currency"},{caption:d("CAMP.CAMPAIGN.COLUMNS.CVR")+" ,%",dataField:"cvr",alignment:"center",dataType:"number",precision:2,format:"percent"},{caption:d("CAMP.CAMPAIGN.COLUMNS.CTR")+" ,%",dataField:"ctr",alignment:"center",dataType:"number",precision:2,format:"percent"},{caption:d("CAMP.CAMPAIGN.COLUMNS.VIEW_MEASURED_IMPS"),dataField:"view_measured_imps",alignment:"center",visible:!1,width:100,dataType:"number"},{caption:d("CAMP.CAMPAIGN.COLUMNS.VIEW_MEASUREMENT_RATE")+" ,%",dataField:"view_measurement_rate",alignment:"center",visible:!1,width:120,dataType:"number"},{caption:d("CAMP.CAMPAIGN.COLUMNS.VIEW_RATE")+" ,%",dataField:"view_rate",alignment:"center",visible:!1,width:80,dataType:"number"},{caption:"Good/Bad",columnIndex:16,dataField:"goodBad",width:125,allowEditing:!1,cellTemplate:function(t,a){var i=o('<div class="goodBad"><div class="button goodButtonAnaliticCO'+a.data.placement_id+'"></div><div class="button badButtonAnaliticCO'+a.data.placement_id+'"></div></div>')(n);i.appendTo(t);var s=e.$(".goodButtonAnaliticCO"+a.data.placement_id).dxButton({text:"Good",disabled:!1,onClick:function(){e.$(".badButtonAnaliticCO"+a.data.placement_id).removeClass("active-white"),e.$(".goodButtonAnaliticCO"+a.data.placement_id).addClass("active-white"),r.goodBadSend(a.data.placement_id,"good").then(function(e){return a.data.mark="good",e})}}),d=e.$(".badButtonAnaliticCO"+a.data.placement_id).dxButton({text:"Bad",disabled:!1,onClick:function(){e.$(".badButtonAnaliticCO"+a.data.placement_id).addClass("active-white"),e.$(".goodButtonAnaliticCO"+a.data.placement_id).removeClass("active-white"),r.goodBadSend(a.data.placement_id,"bad").then(function(e){return a.data.mark="bad",e})}});"good"==a.data.mark?s.addClass("active-white").append():s.append(),"bad"==a.data.mark?d.addClass("active-white").append():d.append()}}],columnChooser:{enabled:!0,height:180,width:400,emptyPanelText:"A place to hide the columns"},onInitialized:function(e){s.dataGridOptionsMultipleFunc=e.component,s.dataGridOptionsMultipleFunc._controllers.columns._commandColumns[1].visibleIndex=9,s.dataGridOptionsMultipleFunc._controllers.columns._commandColumns[1].width=35},onSelectionChanged:function(e){s.selectedItems=e.selectedRowsData,s.disabled=!s.selectedItems.length}}}}e.$inject=["$window","$state","$localStorage","$scope","$translate","$compile","valuationByExpertS"],angular.module("pjtLayout").controller("valuationByExpertController",e)}(),angular.module("pjtLayout").controller("RootController",RootController),function(){"use strict";function e(e,t,a){function n(){return e({method:"GET",headers:{Authorization:"Token "+t.get("token")},url:"/api/v1/advertisers"}).then(function(e){return e.data})["catch"](function(e){a.DevExpress.ui.notify(e.statusText,"error",4e3)})}function i(){return new a.DevExpress.data.CustomStore({totalCount:function(){return s},load:function(){return n()}})}function o(t){return e({method:"POST",url:"/api/v1/login/",data:{email:t.email,password:t.password}}).then(function(e){return e})["catch"](function(e){a.DevExpress.ui.notify(e.statusText,"error",4e3)})}var r=this,s=0;r.authorization=o,r.selectAdvertisersStore=i}e.$inject=["$http","$cookies","$window"],angular.module("pjtLayout").service("Auth",e)}(),function(){"use strict";function e(e,t,a,n,i,o,r){var s=this,d=n.instant;s.bannerShow=!1,s.userLogOut=!1,s.adminPanel=!1,!o.get("token")||"userfull"!=o.get("permission")&&"userread"!=o.get("permission")||r.getValueOfTech().then(function(e){return"on"==e?(s.bannerShow=!0,r.bannerTextReturn().then(function(e){s.bannerText=e.text})):void 0}),!o.get("token")||"adminfull"!=o.get("permission")&&"adminread"!=o.get("permission")||(e.$(".reg-form-wrapper")[0].classList.add("hide"),e.$(".advertiser-wrapper")[0].classList.add("show"),s.userLogOut=!0,s.adminPanel=!0),!o.get("token")||"userfull"!=o.get("permission")&&"userread"!=o.get("permission")||(e.$(".reg-form-wrapper")[0].classList.add("hide"),e.$(".advertiser-wrapper")[0].classList.add("show"),s.userLogOut=!0,s.adminPanel=!1),s.selectAdvertisersStore=i.selectAdvertisersStore(),s.submitForm=function(t){return void 0!=t&&void 0!=t.email&&void 0!=t.password?(o.remove("permission"),o.remove("token"),i.authorization(t).then(function(t){200==t.status?(a.$reset(),o.put("token",t.data.token),o.put("permission",t.data.permission),!t.data.token||"adminfull"!=t.data.permission&&"adminread"!=t.data.permission||(e.$(".reg-form-wrapper")[0].classList.add("hide"),e.$(".advertiser-wrapper")[0].classList.add("show"),s.userLogOut=!0,s.adminPanel=!0),!t.data.token||"userfull"!=t.data.permission&&"userread"!=t.data.permission||(e.$(".reg-form-wrapper")[0].classList.add("hide"),e.$(".advertiser-wrapper")[0].classList.add("show"),s.userLogOut=!0,s.adminPanel=!1,r.getValueOfTech().then(function(e){return"on"==e?(s.bannerShow=!0,r.bannerTextReturn().then(function(e){s.bannerText=e.text})):void 0}))):(o.remove("permission"),o.remove("token"))})):void e.DevExpress.ui.notify(d("AUTH.EMAIL-OR-PASSWORD-EMPTY"),"error",4e3)},s.goToAdminPanel=function(){t.go("admin")},s.logout=function(){o.remove("permission"),o.remove("token"),t.reload()},s.UI={addButton:{text:d("AUTH.GO_BUTTON"),onClick:function(){a.advertiser=s.selectedService,("usualAds"===s.selectedService.ad_type||null===s.selectedService.ad_type)&&t.go("home.main"),"videoAds"==s.selectedService.ad_type&&t.go("home.videomain")}},selectAdvertisers:{bindingOptions:{dataSource:"auth.selectAdvertisersStore",value:"auth.selectedService"},displayExpr:"name",width:"200px"}}}e.$inject=["$window","$state","$localStorage","$translate","Auth","$cookies","AdminService"],angular.module("pjtLayout").controller("AuthController",e)}(),function(){"use strict";angular.module("pjtLayout").constant("RussianTranslations",{COMMON:{"GO-TO-ADMIN-PANEL":"Панель администратора",LOGOUT:"Выйти","TO-MAIN-PAGE":"Главная",CANCEL:"Отмена"},AUTH:{"EMAIL-OR-PASSWORD-EMPTY":"E-mail или пароль пуст",GO_BUTTON:"Дальше","MAIL-REQUIRED":"Введите ваш email","MAIL-VALID":"Некорректный адрес электронной почты","PASSWORD-REQUIRED":"Введите ваш пароль","MAIL-PLACEHOLDER":"Введите адрес электронной почты","MAIL-PASSWORD":"Введите ваш пароль","MAIL-SUBMIT":"Вход"},ADMIN:{ANU:{"ADD-NEW-USER":"Добавить нового пользователя",EMAIL:"Электронная почта",PASSWORD:"Пароль","CONFIRM-PASSWORD":"Подтвердите пароль","USER-NAME":"Имя пользователя","FIRST-NAME":"Имя","LAST-NAME":"Фамилия","MAIL-REQUIRED":"Введите ваш email","MAIL-VALID":"Некорректный адрес электронной почты","PASSWORD-REQUIRED":"Введите ваш пароль","CONFIRM-PASSWORD-REQUIRED":"Введите подтверждение пароля","CONFIRM-PASSWORD-INCORRECT":"Неверный пароль","USER-NAME-REQUIRED":"Введите имя пользователя","FIRST-NAME-REQUIRED":"Введите имя","LAST-NAME-REQUIRED":"Введите фамилию","SELECT-PERMISSION":"Выберите тип доступа","SELECT-NEXUS-USER":"Выберите пользователя с AppNexus",SUBMIT:"Создать"},"LIST-USER":{TITLE:"Список пользователей",EMAIL:"Электронная почта",PASSWORD:"Пароль","CONFIRM-PASSWORD":"Подтвердите пароль","USER-NAME":"Имя пользователя","FIRST-NAME":"Имя","LAST-NAME":"Фамилия","APNEXUS-ID":"Id пользователя AppNexus","APNEXUS-NAME":"Имя пользователя AppNexus",PERMISSION:"Разрешение"},"TECHNICAL-WORK":{"EDIT-USERS":"Редактировать пользователей","TECH-WORK":"Технические работы","ADVERTISER-LIST":"Cписок рекламодателей","TECH-WORK-SWITCHER":"проведение технических работ на сайте","TECH-JOURNAL":"Журнал проведения технических работ","TECH-DATE":"Дата","TECH-STATUS":"Статус","TECH-STATUS-BANNER":"СТАТУС БАННЕРА","APNEXUS-ID":"Id пользователя AppNexus","APNEXUS-NAME":"Имя пользователя AppNexus",PERMISSION:"Разрешение"},"ADVERTISER-LIST":{NAME:"Имя",ID:"Id","AD-TYPE":"Тип рекламодателя"}},INDEX:{ADVERTISER_TITLE:"Статистика для",LEFT_NAV:{HOME:"Главная",CAMPAIGN:"Кампания",BILLING:"Биллинг",CPA:"CPA",OPTIMIZER:"Оптимизатор",BCC:"Массовое создание компаний",Rules:"Правила",EXPERT:"Оценка экспертом"}},MAIN:{HOME:"Главная",DATE_PICKER:{YESTERDAY:"Вчера",LAST_3_DAYS:"Последние 3 дня",LAST_7_DAYS:"Последние 7 дней",LAST_14_DAYS:"Последние 14 дней",LAST_21_DAYS:"Последние 21 дней",CURRENT_MONTH:"Текущий месяц",LAST_MONTH:"Прошлый месяц",LAST_90_DAYS:"Последние 90 дней",ALL_TIME:"Все время"},TOTALS:{COLUMNS:{TOTALS:"ИТОГИ",SPENT:"Потрачено",CONV:"Конв",IMP:"Показы",CLICKS:"Клики",CPC:"CPC",CPM:"CPM",CVR:"CVR",CTR:"CTR"}},CAMPAIGN:{COLUMNS:{CAMPAIGN:"Кампания",PLACEMENT:"Размещение",NETWORK:"Сеть_Издатель",SPENT:"Потрачено",CONV:"Конв",IMP:"Показы",CPA:"CPA",CLICKS:"Клики",CPC:"CPC",CPM:"CPM",CVR:"CVR",CTR:"CTR",IMPS_VIEWED:"Видимые показы",VIEW_MEASURED_IMPS:"Измерено видимость показов",VIEW_MEASUREMENT_RATE:"Измереная видимост",VIEW_RATE:"Видимость",STATS:"Стат","AD-STARTS":"Стартов реклам","FILL-RATE":"Рейтинг показов","PROFIT-LOSS":"Прибыль/убыток","FILL-RATE-HOUR":"Рейтинг показов за час","PROFIT-LOSS-HOUR":"Прибыль/убыток за час"}},CHECKBOX:{ad_starts:"ad_starts",fill_rate:"fill_rate",profit_loss:"profit_loss",IMPRESSIONS:"Показы",CVR:"CVR",CPC:"CPC",CLICKS:"Клики",COST:"$ Затраты",CONVERSIONS:"Конверсии",CTR:"CTR"}},CAMP:{NAME:"Кампания",LINE_ITEM:"Line item","GO-OPTIMISER":"Перейти к оптимизатору",CHECKBOX:{IMPRESSIONS:"Показы",CPA:"CPA",CPC:"CPC",CLICKS:"Клики",COST:"$ Затраты",CONVERSIONS:"Конверсии",CTR:"CTR"},CAMPAIGN:{COLUMNS:{CAMPAIGN:"Кампания",PLACEMENT:"Размещение",DOMAIN:"Домен",NETWORK:"Сеть_Издатель",SPENT:"Потрачено",CONV:"Конв",COST:"Стоимость",IMP:"Показы",CPA:"CPA",CLICKS:"Клики",CPC:"CPC",CPM:"CPM",CVR:"CVR",CTR:"CTR",IMPS_VIEWED:"Видимые показы",VIEW_MEASURED_IMPS:"Измерено видимость показов",VIEW_MEASUREMENT_RATE:"Измереная видимост",VIEW_RATE:"Видимость",STATS:"Стат",STATE:"Cостояние",PREDICTION_1:"Прогнозирование №1",PREDICTION_2:"Прогнозирование №2"}}},CO:{"NO-ITEMS-CHOSEN":"Пожалуйста, выберите по крайней мере 1 пункт","SEND-TO-SUSPEND-LIST":"Приостановить , пока я не добрался до него","SPECIFIC-DATE":"Выбрать дату","7-DAYS":"7 дней","3-DAYS":"3 дня","24-HRS":"24 часа","TEMP-SUSPEND":"Приостановленые",BLACKLISTED:"Blacklisted",WHITELIST:"Whitelist",SUSPEND:"Приостановить",OPTIMIZER:"Оптимизатор",BLOCKING:"Блокировка","DEVICE-AND-SUPPLY-TYPE":"Устройство и тип",GEO:"Геоинформация",DOMAIN:"Домен","DOMAIN-LISTS":"Списки доменов",DOMAINS:"Домены",RULES:"Правила для всех доменов:","OPTIMISER-FOR":"Оптимизатор для:","CAMPAIGN-HOME":"Вернуться к компании"},RULESC:{"OPTIMISER-FOR":"Правила для:",RULES:"Правила для всех доменов:","ADD-RULE":"Добавить правило","SAVE-RULE":"Сохранить правила","RULE-DELETE":"Удалить правило"},VBE:{"PAGE-NAME":"Valuation by expert:","CALCULATE-AUC":"Calculate AUC","CREATE-TEST-SET":"Create test set"},BCC:{"SELECT-CAMPAIGN":"Выберите компанию:","ADD-DOMAIN":"Введите домен:","PLACEHOLDER-DOMAIN":"Один домен в одну строку",CREATE:"Создать"}})}(),function(){"use strict";angular.module("pjtLayout").constant("EnglishTranslations",{COMMON:{"GO-TO-ADMIN-PANEL":"Admin panel",LOGOUT:"Log out","TO-MAIN-PAGE":"Home",CANCEL:"Cancel"},AUTH:{"EMAIL-OR-PASSWORD-EMPTY":"Email or Password is empty",GO_BUTTON:"GO","MAIL-REQUIRED":"Your email is required","MAIL-VALID":"Your email is not valid.","PASSWORD-REQUIRED":"Your password is required.","MAIL-PLACEHOLDER":"Enter your email","MAIL-PASSWORD":"Enter your password","MAIL-SUBMIT":"Submit"},ADMIN:{ANU:{"ADD-NEW-USER":"Add new user",EMAIL:"Email",PASSWORD:"Password","CONFIRM-PASSWORD":"Confirm password","USER-NAME":"User name","FIRST-NAME":"First name","LAST-NAME":"Last name","MAIL-REQUIRED":"Your email is required","MAIL-VALID":"Your email is not valid","PASSWORD-REQUIRED":"Your password is required","CONFIRM-PASSWORD-REQUIRED":"Password confirmation is required","CONFIRM-PASSWORD-INCORRECT":"Incorrect password","USER-NAME-REQUIRED":"User name is required","FIRST-NAME-REQUIRED":"First name is required","LAST-NAME-REQUIRED":"Last name is required","SELECT-PERMISSION":"Select the type of permission","SELECT-NEXUS-USER":"Select the appnexus user",SUBMIT:"Create"},"LIST-USER":{TITLE:"List of users",EMAIL:"Email",PASSWORD:"Password","CONFIRM-PASSWORD":"Confirm password","USER-NAME":"User name","FIRST-NAME":"First name","LAST-NAME":"Last name","APNEXUS-ID":"AppNexus user id","APNEXUS-NAME":"AppNexus user name",PERMISSION:"Permission"},"TECHNICAL-WORK":{"EDIT-USERS":"Edit users","TECH-WORK":"Technical works","ADVERTISER-LIST":"Advertiser list","TECH-WORK-SWITCHER":"carrying out technical works on the site","TECH-JOURNAL":"Journal of carrying out technical works Journal","TECH-DATE":"Date","TECH-STATUS":"Status","TECH-STATUS-BANNER":"BANNER STATUS","APNEXUS-ID":"Id пользователя AppNexus","APNEXUS-NAME":"Имя польeзователя AppNexus",PERMISSION:"Разрешение"},"ADVERTISER-LIST":{NAME:"Name",ID:"Id","AD-TYPE":"Type of the advertiser"}},INDEX:{ADVERTISER_TITLE:"Stats for",LEFT_NAV:{HOME:"Home",CAMPAIGN:"Campaign",CPA:"CPA",BILLING:"Billing",OPTIMIZER:"Optimizer",BCC:"Bulk campaigns creation",Rules:"Rules",EXPERT:"Expert"}},MAIN:{HOME:"Home",DATE_PICKER:{YESTERDAY:"Yesterday",LAST_3_DAYS:"Last 3 days",LAST_7_DAYS:"Last 7 days",LAST_14_DAYS:"Last 14 days",LAST_21_DAYS:"Last 21 days",CURRENT_MONTH:"Current month",LAST_MONTH:"Last month",LAST_90_DAYS:"Last 90 days",ALL_TIME:"All times"},TOTALS:{COLUMNS:{TOTALS:"TOTALS",SPENT:"Spent",CONV:"Conv",IMP:"Imp",CLICKS:"Clicks",CPC:"CPC",CPM:"CPM",CVR:"CVR",CTR:"CTR"}},CAMPAIGN:{COLUMNS:{CAMPAIGN:"Campaign",PLACEMENT:"Placement",NETWORK:"Network + Publisher",SPENT:"Spent",CONV:"Conv",IMP:"Imp",CPA:"CPA",CLICKS:"Clicks",CPC:"CPC",CPM:"CPM",CVR:"CVR",CTR:"CTR",IMPS_VIEWED:"Visible imp",VIEW_MEASURED_IMPS:"Measured imp",VIEW_MEASUREMENT_RATE:"Viewed measurement rate",VIEW_RATE:"Viewed rate",STATS:"Stats","AD-STARTS":"Ad starts","FILL-RATE":"Fill rate","PROFIT-LOSS":"Profit/loss","FILL-RATE-HOUR":"Delta Fill Rate","PROFIT-LOSS-HOUR":"Delta profit/loss"}},CHECKBOX:{ad_starts:"ad_starts",fill_rate:"fill_rate",profit_loss:"profit_loss",IMPRESSIONS:"Impressions",CVR:"CVR",CPC:"CPC",CLICKS:"Clicks",COST:"$ Cost",CONVERSIONS:"Conversions",CTR:"CTR"}},CAMP:{NAME:"Campaign:",LINE_ITEM:"Line item:","GO-OPTIMISER":"Go to the Optimiser",CHECKBOX:{IMPRESSIONS:"Impressions",CPA:"CPA",CPC:"CPC",CLICKS:"Clicks",COST:"$ Cost",CONVERSIONS:"Conversions",CTR:"CTR"},CAMPAIGN:{COLUMNS:{CAMPAIGN:"Campaign",PLACEMENT:"Placement",DOMAIN:"Domain",NETWORK:"Network + Seller",SPENT:"Spent",CONV:"Conv",COST:"Cost",IMP:"Imp",CPA:"CPA",CLICKS:"Clicks",CPC:"CPC",CPM:"CPM",CVR:"CVR",CTR:"CTR",IMPS_VIEWED:"Visible imp",VIEW_MEASURED_IMPS:"Measured imp",VIEW_MEASUREMENT_RATE:"Viewed measurement rate",VIEW_RATE:"Viewed rate",STATS:"Stats",STATE:"State",PREDICTION_1:"Prediction №1",PREDICTION_2:"Prediction №2"}}},CO:{"NO-ITEMS-CHOSEN":"No items chosen. Please, choose at least 1 item","SEND-TO-SUSPEND-LIST":'Send to "Suspend list" until I get to it',"SPECIFIC-DATE":"Specific date","7-DAYS":"7 days","3-DAYS":"3 days","24-HRS":"24 hrs","TEMP-SUSPEND":"Temp. Suspend",BLACKLISTED:"Blacklisted",WHITELIST:"Whitelist",SUSPEND:"Suspend",OPTIMIZER:"Optimizer",BLOCKING:"Blocking","DEVICE-AND-SUPPLY-TYPE":"Device and Supply Type",GEO:"Geo",DOMAIN:"Domain","DOMAIN-LISTS":"Domain Lists",DOMAINS:"Domains",RULES:"Rules for All Domains:","OPTIMISER-FOR":"Optimiser for:","CAMPAIGN-HOME":"back to Campaign Home"},RULESC:{"OPTIMISER-FOR":"Rules for:",RULES:"Rules for All Domains:","ADD-RULE":"Add rule","SAVE-RULE":"Save rule","RULE-DELETE":"RULE DELETE"},VBE:{"PAGE-NAME":"Valuation by expert:","CALCULATE-AUC":"Calculate AUC","CREATE-TEST-SET":"Create test set"},BCC:{"SELECT-CAMPAIGN":"Select Campaign:","ADD-DOMAIN":"Put domain:","PLACEHOLDER-DOMAIN":"Put single domain in one line",CREATE:"Create"}})}(),function(){"use strict";function e(e,t,a,n,i,o){var r=this;r.advertiser={},r.isEven=!1,r.userAuth=!1,r.bannerText="",r.video=!1,r.usual=!1,"videoAds"===e.advertiser.ad_type&&(r.video=!0),("usualAds"===e.advertiser.ad_type||null===e.advertiser.ad_type)&&(r.usual=!0),o.bannerTextReturn().then(function(e){1==e.status&&(r.bannerText=e.text||"")}),r.hideBanner=function(){r.banner=n.$("#techBanner"),r.banner.addClass("non-visible")},null==i.id&&null==i.name&&null!=e.campaign&&(i.id=e.campaign.id,i.name=e.campaign.name),!a.get("token")||"adminfull"!=a.get("permission")&&"adminread"!=a.get("permission")||(r.isEven=!0,r.userAuth=!0),!a.get("token")||"userfull"!=a.get("permission")&&"userread"!=a.get("permission")||(r.isEven=!1,r.userAuth=!0),null==e.advertiser?t.go("auth"):r.advertiser.name=e.advertiser.name,r.checked=function(e){var t=angular.element(n.document.querySelector("#wrapper"))[0];t.classList.add("hidden-menu")&&t.classList.remove("hidden-menu")}}e.$inject=["$localStorage","$state","$cookies","$window","$rootScope","AdminService"],angular.module("pjtLayout").controller("HomeController",e)}(),function(){"use strict";function e(e,t,a){function n(){return new a.DevExpress.data.CustomStore({totalCount:function(){return A},load:function(){return i()}})}function i(){return e({method:"GET",headers:{Authorization:"Token "+t.get("token")},url:"/api/v1/appnexus/user"}).then(function(e){return e.data})["catch"](function(e){a.DevExpress.ui.notify(e.data.detail,"error",4e3)})}function o(){return new a.DevExpress.data.CustomStore({totalCount:function(){return 0},load:function(){return r()}})}function r(){return e({method:"GET",headers:{Authorization:"Token "+t.get("token")},url:"/api/v1/technicalwork"}).then(function(e){return e.data})["catch"](function(e){a.DevExpress.ui.notify(e.data.detail,"error",4e3)})}function s(){return new a.DevExpress.data.CustomStore({totalCount:function(){return 0},load:function(){return c().then(function(e){return e})},remove:function(e){return u(e.id)}})}function d(){return new a.DevExpress.data.CustomStore({totalCount:function(){return 0},load:function(){return l().then(function(e){return e})}})}function l(){return e({method:"GET",headers:{Authorization:"Token "+t.get("token")},url:"/api/v1/advertisers"}).then(function(e){return e.data})["catch"](function(e){a.DevExpress.ui.notify(e.data.detail,"error",4e3)})}function c(){return e({method:"GET",headers:{Authorization:"Token "+t.get("token")},url:"/api/v1/user/"}).then(function(e){return e.data})["catch"](function(e){a.DevExpress.ui.notify(e.data.detail,"error",4e3)})}function u(n){return e({method:"DELETE",url:"/api/v1/user/"+n,headers:{Authorization:"Token "+t.get("token")}}).then(function(e){return e.data})["catch"](function(e){a.DevExpress.ui.notify(e.data.detail,"error",4e3)})}function m(n){return e({method:"POST",url:"/api/v1/user/",headers:{Authorization:"Token "+t.get("token")},data:n}).then(function(e){return e.data})["catch"](function(e){a.DevExpress.ui.notify(e.data.detail,"error",4e3)})}function p(n,i){return e({method:"PUT",url:"/api/v1/advertisersType",headers:{Authorization:"Token "+t.get("token")},data:{id:n,ad_type:i}}).then(function(e){return e.data})["catch"](function(e){a.DevExpress.ui.notify(e.data.detail,"error",4e3)})}function h(){return e({method:"GET",headers:{Authorization:"Token "+t.get("token")},url:"/api/v1/banner"}).then(function(e){return e.data})["catch"](function(e){a.DevExpress.ui.notify(e.data.detail,"error",4e3)})}function v(n){return e({method:"POST",url:"/api/v1/banner",headers:{Authorization:"Token "+t.get("token")},data:n}).then(function(e){return e.data})["catch"](function(e){a.DevExpress.ui.notify(e.data.detail,"error",4e3)})}function C(){return e({method:"PUT",url:"/api/v1/banner",headers:{Authorization:"Token "+t.get("token")}}).then(function(e){return e.data})["catch"](function(e){a.DevExpress.ui.notify(e.data.detail,"error",4e3)})}function g(n){return e({method:"POST",url:"/api/v1/technicalwork",headers:{Authorization:"Token "+t.get("token")},data:n}).then(function(e){return e.data})["catch"](function(e){a.DevExpress.ui.notify(e.data.detail,"error",4e3)})}function f(){return e({method:"GET",headers:{Authorization:"Token "+t.get("token")},url:"/api/v1/technicalwork/last"}).then(function(e){return e.data})["catch"](function(e){a.DevExpress.ui.notify(e.data.detail,"error",4e3)})}var S=this,A=0;S.selectNexusUsersStore=n,S.editAdvertiserList=p,S.advertiserListStore=d,S.usersStore=s,S.addUser=m,S.bannerTextReturn=h,S.techRecordStore=o,S.bannerTextRecord=v,S.statusTech=g,S.getValueOfTech=f,S.bannerOff=C}e.$inject=["$http","$cookies","$window"],angular.module("pjtLayout").service("AdminService",e)}(),function(){"use strict";function e(e,t,a,n,i){var o=this,r=a.instant;o.first=!0,o.second=!1,o.third=!1,o.statusBanner="",o.goToMainPage=function(){t.go("auth")},n.bannerTextReturn().then(function(e){o.bannerText=e.text,1==e.status?o.statusBanner="ON":o.statusBanner="OFF"}),o.submitBannerText=function(e){o.newTextBaner={text:e,status:!0},n.bannerTextRecord(o.newTextBaner).then(function(e){1==e.status?o.statusBanner="ON":o.statusBanner="OFF"})},o.cleanBannerText=function(){return n.bannerOff().then(function(e){1==e.status?o.statusBanner="ON":o.statusBanner="OFF"})},o.changeTechWork=function(t){o.status={value:t,date:new Date},n.statusTech(o.status),e.$("#techRecords").dxDataGrid("instance").refresh()},n.getValueOfTech().then(function(e){o.name=e}),o.changeTab=function(t){e.$(".link-second").removeClass("btn-success"),e.$(".link-first").removeClass("btn-success"),e.$(".link-third").removeClass("btn-success"),o.first=!1,o.second=!1,o.third=!1,"first"===t&&(o.first=!0,e.$(".link-first").addClass("btn-success")),"second"===t&&(e.$(".link-second").addClass("btn-success"),o.second=!0),"third"===t&&(e.$(".link-third").addClass("btn-success"),o.third=!0)},o.submitForm=function(t){return o.selectedService?(t.apnexus_user=o.selectedService.id,t.apnexusname=o.selectedService.userxtname):(t.apnexus_user=null,t.apnexusname=null),("adminfull"==t.permission||"adminread"==t.permission)&&(t.apnexus_user=null),t.username=t.email,n.addUser(t).then(function(){o.user={},o.userForm.$setPristine(),e.$("#usersList").dxDataGrid("instance").refresh()})},o.usersStore=n.usersStore(),o.advertiserListStore=n.advertiserListStore(),o.selectNexusUsersStore=n.selectNexusUsersStore(),o.techRecordStore=n.techRecordStore(),o.UI={listOfUsers:{remoteOperations:!1,showBorders:!0,alignment:"left",bindingOptions:{dataSource:"admin.usersStore"},headerFilter:{visible:!0},filterRow:{visible:!0,applyFilter:"auto"},pager:{showPageSizeSelector:!0,allowedPageSizes:[10,30,50],visible:!0,showNavigationButtons:!0},allowColumnReordering:!0,allowColumnResizing:!0,wordWrapEnabled:!0,howBorders:!0,showRowLines:!0,align:"left",loadPanel:{shadingColor:"rgba(0,0,0,0.4)",visible:!1,showIndicator:!0,showPane:!0,shading:!0,closeOnOutsideClick:!1},editing:{allowDeleting:!0},columns:[{caption:"id",dataField:"id",alignment:"center"},{caption:r("ADMIN.LIST-USER.EMAIL"),dataField:"email",alignment:"center"},{caption:r("ADMIN.LIST-USER.FIRST-NAME"),dataField:"first_name",alignment:"center"},{caption:r("ADMIN.LIST-USER.LAST-NAME"),dataField:"last_name",alignment:"center"},{caption:r("ADMIN.LIST-USER.APNEXUS-ID"),dataField:"apnexusname",alignment:"center"},{caption:r("ADMIN.LIST-USER.APNEXUS-NAME"),dataField:"apnexus_user",alignment:"center"},{caption:r("ADMIN.LIST-USER.PERMISSION"),dataField:"permission",alignment:"center"}]},selectAppNexusUser:{bindingOptions:{dataSource:"admin.selectNexusUsersStore",value:"admin.selectedService"},placeholder:r("ADMIN.ANU.SELECT-NEXUS-USER"),displayExpr:"username"},techRecords:{remoteOperations:!1,showBorders:!0,alignment:"left",bindingOptions:{dataSource:"admin.techRecordStore"},headerFilter:{visible:!0},filterRow:{visible:!0,applyFilter:"auto"},pager:{showPageSizeSelector:!0,allowedPageSizes:[10,30,50],visible:!0,showNavigationButtons:!0},allowColumnReordering:!0,allowColumnResizing:!0,columnAutoWidth:!0,wordWrapEnabled:!0,howBorders:!0,showRowLines:!0,align:"left",loadPanel:{shadingColor:"rgba(0,0,0,0.4)",visible:!1,showIndicator:!0,showPane:!0,shading:!0,closeOnOutsideClick:!1},editing:{allowDeleting:!1,allowDragging:!0},columns:[{caption:r("ADMIN.TECHNICAL-WORK.TECH-DATE"),dataField:"date",alignment:"center",sortOrder:"desc"},{caption:r("ADMIN.TECHNICAL-WORK.TECH-STATUS"),dataField:"status",alignment:"center"}]},advertiserList:{remoteOperations:!1,showBorders:!0,alignment:"left",bindingOptions:{dataSource:"admin.advertiserListStore"},headerFilter:{visible:!0},filterRow:{visible:!0,applyFilter:"auto"},pager:{showPageSizeSelector:!0,allowedPageSizes:[10,30,50],visible:!0,showNavigationButtons:!0},allowColumnReordering:!0,allowColumnResizing:!0,wordWrapEnabled:!0,howBorders:!0,showRowLines:!0,align:"left",loadPanel:{shadingColor:"rgba(0,0,0,0.4)",visible:!1,showIndicator:!0,showPane:!0,shading:!0,closeOnOutsideClick:!1},columns:[{caption:r("ADMIN.ADVERTISER-LIST.ID"),dataField:"id",alignment:"left"},{caption:r("ADMIN.ADVERTISER-LIST.NAME"),dataField:"name",alignment:"left"},{caption:r("ADMIN.ADVERTISER-LIST.AD-TYPE"),width:204,columnIndex:16,allowEditing:!1,dataField:"ad_type",alignment:"left",cellTemplate:function(t,a){var i=e.$("<div />").dxButton({text:"Usual",height:30,width:89,disabled:!1,onClick:function(t){var i=e.$("div.state-white"+a.data.id),o=e.$("div.state-black"+a.data.id);i.dxButton("instance").option("disabled",!0),o.dxButton("instance").option("disabled",!0),i.removeClass("active-white"),o.removeClass("active-white"),n.editAdvertiserList(a.data.id,"usualAds").then(function(t){return i.dxButton("instance").option("disabled",!1),o.dxButton("instance").option("disabled",!1),404==t?(e.DevExpress.ui.notify("Not found","warning",4e3),$("#gridContainerWhite").dxDataGrid("instance").refresh(),t):503==t?(e.DevExpress.ui.notify("Not connect to appnexus server, please try again later","warning",4e3),e.$("#gridContainer2").dxDataGrid("instance").refresh(),t):("Unactive"!==t&&i.addClass("active-white"),t)})["catch"](function(e){return e})}});"usualAds"==a.data.ad_type?i.addClass("state-white"+a.data.id).addClass("active-white").appendTo(t):i.addClass("state-white"+a.data.id).appendTo(t);
var o=e.$("<div />").dxButton({text:"Video",height:30,width:89,disabled:!1,onClick:function(t){var i=e.$("div.state-white"+a.data.id),o=e.$("div.state-black"+a.data.id);i.dxButton("instance").option("disabled",!0),o.dxButton("instance").option("disabled",!0),i.removeClass("active-white"),o.removeClass("active-white"),n.editAdvertiserList(a.data.id,"videoAds").then(function(t){return i.dxButton("instance").option("disabled",!1),o.dxButton("instance").option("disabled",!1),404==t?(e.DevExpress.ui.notify("Not found","warning",4e3),e.$("#gridContainer2").dxDataGrid("instance").refresh(),t):503==t?(e.DevExpress.ui.notify("Not connect to appnexus server, please try again later","warning",4e3),e.$("#gridContainer2").dxDataGrid("instance").refresh(),t):("Unactive"!==t&&o.addClass("active-white"),t)})["catch"](function(e){return e})}});"videoAds"==a.data.ad_type?o.addClass("state-black"+a.data.id).addClass("active-white").appendTo(t):o.addClass("state-black"+a.data.id).appendTo(t)}}]}}}e.$inject=["$window","$state","$translate","AdminService","$localStorage"],angular.module("pjtLayout").controller("AdminController",e)}(),function(){"use strict";function e(e,t,a,n,i,o,r,s){n.$state=t,n.$stateParams=i;var d=n.$on("$stateChangeStart",function(e,t){"auth"!=t.name&&(s.get("token")||s.get("permission")||(o.$reset(),r.location="/")),"admin"==t.name&&("userfull"==s.get("permission")||"userread"==s.get("permission"))&&(o.$reset(),r.location="/")});n.$on("$destroy",d),e.debug("runBlock end")}e.$inject=["$log","$state","$http","$rootScope","$stateParams","$localStorage","$window","$cookies"],angular.module("pjtLayout").run(e)}(),function(){"use strict";function e(e,t){e.state("auth",{url:"/",templateUrl:"app/auth/auth.html",controller:"AuthController",controllerAs:"auth"}).state("home",{templateUrl:"app/home/home.html",controller:"HomeController",controllerAs:"home"}).state("home.main",{url:"/main",templateUrl:"app/usual/main/main.html",controller:"MainController",controllerAs:"main",resolve:{TWStatus:["AdminService","$stateParams","$state","$cookies",function(e,t,a,n){return e.getValueOfTech().then(function(e){"on"!=e||!n.get("token")||"userfull"!=n.get("permission")&&"userread"!=n.get("permission")||a.go("auth")})}]}}).state("home.videomain",{url:"/video/main",templateUrl:"app/video/main/videomain.html",controller:"VideoMainController",controllerAs:"vmain",resolve:{TWStatus:["AdminService","$stateParams","$state","$cookies",function(e,t,a,n){return e.getValueOfTech().then(function(e){"on"!=e||!n.get("token")||"userfull"!=n.get("permission")&&"userread"!=n.get("permission")||a.go("auth")})}]}}).state("home.videocampaign",{url:"/video/campaign/:id",templateUrl:"app/video/campaign/videocampaign.html",controller:"VideoCampaignController",controllerAs:"videocamp",resolve:{Campaign:["CampMain","$stateParams","$state",function(e,t,a){return t.id||a.go("home.main"),e.nameCampaigns(t.id).then(function(e){return e})}],TWStatus:["AdminService","$stateParams","$state","$cookies",function(e,t,a,n){return e.getValueOfTech().then(function(e){"on"!=e||!n.get("token")||"userfull"!=n.get("permission")&&"userread"!=n.get("permission")||a.go("auth")})}]}}).state("home.campaign",{url:"/campaign/:id",templateUrl:"app/usual/campaign/campaign.html",controller:"CampaignMainController",controllerAs:"campmain",resolve:{Campaign:["CampMain","$stateParams","$state",function(e,t,a){return t.id||a.go("home.main"),e.nameCampaigns(t.id).then(function(e){return e})}],TWStatus:["AdminService","$stateParams","$state","$cookies",function(e,t,a,n){return e.getValueOfTech().then(function(e){"on"!=e||!n.get("token")||"userfull"!=n.get("permission")&&"userread"!=n.get("permission")||a.go("auth")})}]}}).state("home.optimiser",{url:"/optimiser/:id",templateUrl:"app/usual/optimiser/optimiser.html",controller:"CampaignOptimiserController",controllerAs:"CO",resolve:{Campaign:["CampMain","$stateParams","$state",function(e,t,a){return t.id||a.go("home.main"),e.nameCampaigns(t.id).then(function(e){return e})}],TWStatus:["AdminService","$stateParams","$state","$cookies",function(e,t,a,n){return e.getValueOfTech().then(function(e){"on"!=e||!n.get("token")||"userfull"!=n.get("permission")&&"userread"!=n.get("permission")||a.go("auth")})}]}}).state("home.valuationByExpert",{url:"/valuationByExpert/",templateUrl:"app/valuationByExpert/valuationByExpert.html",controller:"valuationByExpertController",controllerAs:"VBE",resolve:{TWStatus:["AdminService","$stateParams","$state","$cookies",function(e,t,a,n){return e.getValueOfTech().then(function(e){"on"!=e||!n.get("token")||"userfull"!=n.get("permission")&&"userread"!=n.get("permission")||a.go("auth")})}]}}).state("admin",{url:"/admin/",templateUrl:"app/admin/admin.html",controller:"AdminController",controllerAs:"admin"}).state("home.rules",{url:"/rules/:id",templateUrl:"app/usual/rules/rules.html",controller:"rulesController",controllerAs:"rulesC",resolve:{Campaign:["CampMain","$stateParams","$state",function(e,t,a){return t.id||a.go("home.main"),e.nameCampaigns(t.id).then(function(e){return e})}],TWStatus:["AdminService","$stateParams","$state","$cookies",function(e,t,a,n){return e.getValueOfTech().then(function(e){"on"!=e||!n.get("token")||"userfull"!=n.get("permission")&&"userread"!=n.get("permission")||a.go("auth")})}]}}).state("home.bcc",{url:"/video/bcc/:id",templateUrl:"app/video/bcc/bcc.html",controller:"BCCController",controllerAs:"bcc",resolve:{Campaign:["CampMain","$stateParams","$state",function(e,t,a){return t.id||a.go("home.main"),e.nameCampaigns(t.id).then(function(e){return e})}],TWStatus:["AdminService","$stateParams","$state","$cookies",function(e,t,a,n){return e.getValueOfTech().then(function(e){"on"!=e||!n.get("token")||"userfull"!=n.get("permission")&&"userread"!=n.get("permission")||a.go("auth")})}]}}).state("home.cpa",{url:"/cpa/:id",templateUrl:"app/usual/cpa/cpa.html",controller:"CPAController",controllerAs:"cpa",resolve:{Campaign:["CampMain","$stateParams","$state",function(e,t,a){return t.id||a.go("home.main"),e.nameCampaigns(t.id).then(function(e){return e})}],ChartDetails:["CPA","$stateParams","$state","$localStorage",function(e,t,a,n){return t.id||a.go("home.main"),e.detailsStoreAll(t.id,n.dataStart,n.dataEnd,n.selectedSection).then(function(e){return e})["catch"](function(e){return e})}],CpaBucketsAll:["CPA","$stateParams","$state","$localStorage",function(e,t,a,n){return t.id||a.go("home.main"),e.bucketsCpa(t.id,n.dataStart,n.dataEnd,n.selectedSection).then(function(e){return e})["catch"](function(e){return e})}],TWStatus:["AdminService","$stateParams","$state","$cookies",function(e,t,a,n){return e.getValueOfTech().then(function(e){"on"!=e||!n.get("token")||"userfull"!=n.get("permission")&&"userread"!=n.get("permission")||a.go("auth")})}]}}),t.otherwise("/")}e.$inject=["$stateProvider","$urlRouterProvider"],angular.module("pjtLayout").config(e)}(),function(){"use strict";angular.module("pjtLayout")}(),function(){"use strict";function e(e,t,a,n,i){e.debugEnabled(!0),a.translations("en",i),a.translations("ru",n),a.useSanitizeValueStrategy("escape"),a.preferredLanguage("ru"),a.useLocalStorage(),a.storageKey("TRANSLATE_LANG_KEY"),t.allowHtml=!0,t.timeOut=3e3,t.positionClass="toast-top-right",t.preventDuplicates=!0,t.progressBar=!0}e.$inject=["$logProvider","toastrConfig","$translateProvider","RussianTranslations","EnglishTranslations"],angular.module("pjtLayout").config(e)}(),angular.module("pjtLayout").run(["$templateCache",function(e){e.put("app/auth/auth.html",'<div class=location><div class=location-language><a ng-click="root.changeLang(\'ru\')"><i class="fa fa-globe fa-fw"></i> Русский </a>/ <a ng-click="root.changeLang(\'en\')"><i class="fa fa-globe fa-fw"></i> English</a></div><a class="btn btn-danger admin-btn" ng-show=auth.userLogOut ng-click=auth.logout()><span class="glyphicon glyphicon-log-out"></span> {{ \'COMMON.LOGOUT\' | translate }} </a><a href=# class="btn btn-primary admin-btn" ng-show=auth.adminPanel ui-sref=admin><span class="glyphicon glyphicon-user"></span> {{ \'COMMON.GO-TO-ADMIN-PANEL\' | translate }}</a></div><div class="authorization container"><div class=row><div ng-show=!auth.bannerShow class="Absolute-Center is-Responsive reg-form-wrapper"><form name=auth.userForm ng-submit=auth.submitForm(auth.user) novalidate><div class=col-sm-10><div class=form-group ng-class="{ \'has-error\' : auth.userForm.email.$invalid && !auth.userForm.email.$pristine }"><i class="fa fa-user fa-2x icon-for-user"></i> <input type=email name=email class="form-control input-item-login" placeholder="{{ \'AUTH.MAIL-PLACEHOLDER\' | translate }}" ng-model=auth.user.email required><p ng-show="auth.userForm.email.$invalid && !auth.userForm.email.$pristine && auth.userForm.email.$error.required" class=help-block>{{ \'AUTH.MAIL-REQUIRED\' | translate }}</p><p ng-show="!auth.userForm.email.$error.required && auth.userForm.email.$invalid && !auth.userForm.email.$pristine" class=help-block>{{ \'AUTH.MAIL-VALID\' | translate }}</p></div></div><div class=col-sm-10><div class=form-group ng-class="{ \'has-error\' : auth.userForm.password.$invalid && !auth.userForm.password.$pristine }"><i class="fa fa-unlock fa-2x icon-for-user"></i> <input type=password name=password class="input-item-password form-control input-item-password" ng-model=auth.user.password placeholder="{{ \'AUTH.MAIL-PASSWORD\' | translate }}" required max-length=10 min-length=4><p ng-show="auth.userForm.password.$invalid && !auth.userForm.password.$pristine" class=help-block>{{ \'AUTH.PASSWORD-REQUIRED\' | translate }}</p></div></div><div class=form-group><div class=col-sm-10><button type=submit class="submitting-button btn btn-success">{{ \'AUTH.MAIL-SUBMIT\' | translate }}</button></div></div></form></div><div ng-show=!auth.bannerShow class=advertiser-wrapper><div class="Absolute-Center is-Responsive"><div class="col-sm-12 col-md-10 col-md-offset-1"><div class=mode-button><div dx-select-box=auth.UI.selectAdvertisers></div><div dx-button=auth.UI.addButton class=add-advertisers></div></div></div></div></div><div ng-show=auth.bannerShow class="Absolute-Center is-Responsive banner-show"><div class=banner-place>{{auth.bannerText}}</div></div></div></div>'),e.put("app/admin/admin.html",'<div class=admin><div class="col-lg-12 col-md-12 col-sm-12"><div class=home-navigation><a href=# class="btn btn-primary admin-btn" ui-sref=auth><span class="glyphicon glyphicon-home"></span> {{ \'COMMON.TO-MAIN-PAGE\' | translate }}</a></div><div class=location><div class=location-language><a ng-click="root.changeLang(\'ru\')"><i class="fa fa-globe fa-fw"></i> Русский </a>/ <a ng-click="root.changeLang(\'en\')"><i class="fa fa-globe fa-fw"></i> English</a></div><a href=# class="btn btn-danger admin-btn" ng-click=root.logout()><span class="glyphicon glyphicon-log-out"></span> {{ \'COMMON.LOGOUT\' | translate }}</a></div></div><div class="col-lg-12 col-md-12 col-sm-12 tabs"><ul class=nav_posts><li class="btn btn-default btn-success link-first" ng-click="admin.changeTab(\'first\')">{{ \'ADMIN.TECHNICAL-WORK.EDIT-USERS\' | translate }}</li>|<li class="btn btn-default link-second" ng-click="admin.changeTab(\'second\')">{{\'ADMIN.TECHNICAL-WORK.TECH-WORK\' | translate }}</li>|<li class="btn btn-default link-third" ng-click="admin.changeTab(\'third\')">{{\'ADMIN.TECHNICAL-WORK.ADVERTISER-LIST\' | translate }}</li></ul><div class=post-first ng-show=admin.first><div class="row content-admin"><div class="col-lg-3 col-md-3 col-sm-12 form-add-user"><h3>{{ \'ADMIN.ANU.ADD-NEW-USER\' | translate }}</h3><form name=admin.userForm ng-submit=admin.submitForm(admin.user) novalidate><div class=form-group ng-class="{ \'has-error\' : admin.userForm.email.$invalid && !admin.userForm.email.$pristine }"><input type=email name=email class="form-control input-item-login" placeholder="{{ \'ADMIN.ANU.EMAIL\' | translate }}" ng-model=admin.user.email required><p ng-show="admin.userForm.email.$invalid && !admin.userForm.email.$pristine && admin.userForm.email.$error.required" class=help-block>{{ \'ADMIN.ANU.MAIL-REQUIRED\' | translate }}</p><p ng-show="!admin.userForm.email.$error.required && admin.userForm.email.$invalid && !admin.userForm.email.$pristine" class=help-block>{{ \'ADMIN.ANU.MAIL-VALID\' | translate }}</p></div><div class=form-group ng-class="{ \'has-error\' : admin.userForm.password.$invalid && !admin.userForm.password.$pristine }"><input type=password class=form-control name=password ng-model=admin.user.password placeholder="{{ \'ADMIN.ANU.PASSWORD\' | translate }}" required><p ng-show="admin.userForm.password.$invalid && !admin.userForm.password.$pristine && admin.userForm.password.$error.required" class=help-block>{{ \'ADMIN.ANU.PASSWORD-REQUIRED\' | translate }}</p></div><div class=form-group ng-class="{ \'has-error\' : (admin.userForm.passwordconfirm.$invalid && !admin.userForm.passwordconfirm.$pristine) || ((admin.user.passwordconfirm !== admin.user.password) && !auth.userForm.password.$pristine)}"><input type=password class=form-control name=passwordconfirm ng-model=admin.user.passwordconfirm required placeholder="{{ \'ADMIN.ANU.CONFIRM-PASSWORD\' | translate }}"><p ng-show="!admin.userForm.passwordconfirm.$error.required && (admin.user.passwordconfirm !== admin.user.password) && !admin.userForm.passwordconfirm.$pristine" class=help-block>{{ \'ADMIN.ANU.CONFIRM-PASSWORD-INCORRECT\' | translate }}</p><p ng-show="admin.userForm.passwordconfirm.$invalid && !admin.userForm.passwordconfirm.$pristine && admin.userForm.passwordconfirm.$error.required" class=help-block>{{ \'ADMIN.ANU.CONFIRM-PASSWORD-REQUIRED\' | translate }}</p></div><div class=form-group ng-class="{ \'has-error\' : admin.userForm.first_name.$invalid && !admin.userForm.first_name.$pristine }"><input type=text name=first_name class="form-control input-item-login" placeholder="{{ \'ADMIN.ANU.FIRST-NAME\' | translate }}" ng-model=admin.user.first_name required><p ng-show="admin.userForm.first_name.$invalid && !admin.userForm.first_name.$pristine && admin.userForm.first_name.$error.required" class=help-block>{{ \'ADMIN.ANU.FIRST-NAME-REQUIRED\' | translate }}</p></div><div class=form-group ng-class="{ \'has-error\' : admin.userForm.last_name.$invalid && !admin.userForm.last_name.$pristine }"><input type=text name=last_name class="form-control input-item-login" placeholder="{{ \'ADMIN.ANU.LAST-NAME\' | translate }}" ng-model=admin.user.last_name required><p ng-show="admin.userForm.last_name.$invalid && !admin.userForm.last_name.$pristine && admin.userForm.last_name.$error.required" class=help-block>{{ \'ADMIN.ANU.LAST-NAME-REQUIRED\' | translate }}</p></div><div class=form-group><select ng-model=admin.user.permission name=permission class="select-user-type form-control" title=user><option value="" disabled selected>{{ \'ADMIN.ANU.SELECT-PERMISSION\' | translate }}</option><option value=adminfull>admin full</option><option value=adminread>admin read-only</option><option value=userfull>user full</option><option value=userread>user read-only</option></select></div><div ng-show="admin.user.permission==\'userfull\' || admin.user.permission==\'userread\'" class=form-group><div dx-select-box=admin.UI.selectAppNexusUser></div></div><button type=submit class="btn btn-primary" ng-disabled=admin.userForm.$invalid>{{ \'ADMIN.ANU.SUBMIT\' | translate }}</button></form></div><div class="col-lg-9 col-md-9 col-sm-12"><h3>{{ \'ADMIN.LIST-USER.TITLE\' | translate }}</h3><div dx-data-grid=admin.UI.listOfUsers id=usersList></div></div></div></div><div class="post-second col-lg-12 col-md-12 col-sm-12" ng-show=admin.second><div class="col-lg-4 col-md-4 col-sm-12"><span class=toggle-bg><input type=radio name=toggle ng-click=admin.valueOfTech(admin.name) ng-change=admin.changeTechWork(admin.name) ng-model=admin.name value=off> <input type=radio name=toggle ng-click=admin.valueOfTech(admin.name) ng-change=admin.changeTechWork(admin.name) ng-model=admin.name value=on> <span class=switch></span> </span><span class=checkbox-value>{{admin.name}}</span> - {{ \'ADMIN.TECHNICAL-WORK.TECH-WORK-SWITCHER\' | translate }}<form class=admin-banner ng-submit=admin.submitBannerText(admin.bannerText)><div class=form-group><textarea cols=30 rows=10 ng-model=admin.bannerText placeholder="Текст банера для пользователей с предупреждением о проведении технических работ на сайте/сервере">{{admin.bannerText}}</textarea></div><div class=form-group><button type=submit class="btn btn-primary">ON</button> <button type=button class="btn btn-primary" ng-click=admin.cleanBannerText()>OFF</button><div style="float: right"><b>{{ \'ADMIN.TECHNICAL-WORK.TECH-STATUS-BANNER\' | translate }} - <span style="color: #3c763d">{{admin.statusBanner}}</span></b></div></div></form></div><div class="col-lg-8 col-md-8 col-sm-12 tech-record"><h3>{{ \'ADMIN.TECHNICAL-WORK.TECH-JOURNAL\' | translate }}</h3><div dx-data-grid=admin.UI.techRecords id=techRecords></div></div></div><div class="post-third col-lg-6 col-md-9 col-sm-12" ng-show=admin.third><h3>{{ \'ADMIN.TECHNICAL-WORK.ADVERTISER-LIST\' | translate }}</h3><div dx-data-grid=admin.UI.advertiserList></div></div></div></div>'),e.put("app/home/home.html",'<div id=wrapper><div class=row><div class="left-nav col-lg-1 col-md-2 col-sm-2 col-xs-2"><ul class="nav nav-list" ng-if=home.usual><li class=nav-header><a ui-sref="home.campaign ({id: $root.id}) " translate=INDEX.LEFT_NAV.CAMPAIGN></a></li><li class=active><a ui-sref="home.cpa ({id: $root.id}) " translate=INDEX.LEFT_NAV.CPA></a></li><li><a ui-sref="home.optimiser ({id: $root.id})" translate=INDEX.LEFT_NAV.OPTIMIZER></a></li><!-- <li><a href="#/" translate="INDEX.LEFT_NAV.BILLING">Billing</a></li>--><li class=active><a ui-sref="home.rules ({id: $root.id})" translate=INDEX.LEFT_NAV.Rules></a></li><li><a ui-sref="home.bcc ({id: $root.id})" translate=INDEX.LEFT_NAV.BCC></a></li><li ng-if="home.isEven == true"><a ui-sref=home.valuationByExpert translate=INDEX.LEFT_NAV.EXPERT></a></li></ul><ul class="nav nav-list" ng-if=home.video><li><a ui-sref="home.videocampaign ({id: $root.id}) " translate=INDEX.LEFT_NAV.CAMPAIGN></a></li><!--<li><a ui-sref="home.videooptimiser ({id: $root.id})"  translate="INDEX.LEFT_NAV.OPTIMIZER"></a></li>--><!--<li><a ui-sref="home.videorules ({id: $root.id})" translate="INDEX.LEFT_NAV.Rules"></a></li>--><li><a ui-sref="home.bcc ({id: $root.id})" translate=INDEX.LEFT_NAV.BCC></a></li><!--<li ng-if="home.isEven == true"><a  ui-sref="home.valuationByExpert" translate="INDEX.LEFT_NAV.EXPERT" ></a></li>--></ul></div><div class="main-nav navbar-header col-lg-11 col-md-10 col-sm-10 col-xs-10 col-lg-offset-1 col-md-offset-2 col-sm-offset-2 col-xs-offset-2"><div class=row><div style="display: table" class="col-lg-12 col-md-12 col-sm-12"><div class=home-navigation><a href=# class="btn btn-primary admin-btn" ui-sref=auth><span class="glyphicon glyphicon-home"></span> {{ \'COMMON.TO-MAIN-PAGE\' | translate }}</a></div><a ui-sref=home.main ng-show=home.usual class=navbar-brand>{{ \'INDEX.ADVERTISER_TITLE\' | translate }} {{ home.advertiser.name }}</a> <a ui-sref=home.videomain ng-show=home.video class=navbar-brand>{{ \'INDEX.ADVERTISER_TITLE\' | translate }} {{ home.advertiser.name }}</a><div ng-if="home.bannerText != \'\'" class=wrapping-tech-banner id=techBanner><div class=tech-banner>{{home.bannerText}}</div><span ng-click=home.hideBanner() class=close-block></span></div><div class=location><div class=location-help><div><a href="https://rtbcat.atlassian.net/wiki/display/RCHW/RTB+Cat+Help+Wiki?src=spacemenu" target=_blank>Help</a></div></div><div class=location-language><a ng-click="root.changeLang(\'ru\')"><i class="fa fa-globe fa-fw"></i> Русский </a>/ <a ng-click="root.changeLang(\'en\')"><i class="fa fa-globe fa-fw"></i> English</a></div><a href=# class="btn btn-danger admin-btn" ng-click=root.logout()><span class="glyphicon glyphicon-log-out"></span> {{ \'COMMON.LOGOUT\' | translate }} </a><a href=# class="btn btn-primary admin-btn" ng-show=home.isEven ui-sref=admin><span class="glyphicon glyphicon-user"></span> {{ \'COMMON.GO-TO-ADMIN-PANEL\' | translate }}</a></div></div></div></div><ui-view class="page-view col-lg-11 col-md-10 col-sm-10 col-xs-10 col-lg-offset-1 col-md-offset-2 col-sm-offset-2 col-xs-offset-2"></ui-view></div></div>'),e.put("app/valuationByExpert/valuationByExpert.html",'<div class="container-fluid expert-camp col-lg-12 col-md-12 col-sm-12"><div class="row stats-header"><div class=groupHeadOpti><span translate=VBE.PAGE-NAME class=camp-header></span><span class=camp-header><br><!--<div class="control pull-right" dx-select-box="VBE.UI.datePiker"></div>--></span></div></div><div class="row camp-content1"><div dx-button=VBE.UI.calculateAUC></div><div dx-button=VBE.UI.createTestSet></div><div class=select-test_type dx-select-box=VBE.UI.test_type></div><div class=gridContainerWhite dx-data-grid=VBE.UI.dataGridOptionsExpert></div><br><div ng-if="VBE.culcReady == true"><h1>{{VBE.titlePred}}</h1><h2>AUC = {{VBE.auc}}</h2><div id=chart dx-chart=VBE.UI.ROC_curve></div></div></div></div>'),e.put("app/usual/campaign/campaign.html",'<div class="container-fluid container-camp col-lg-12 col-md-12 col-sm-12"><div class="row stats-header"><span translate=CAMP.NAME class=camp-header></span><span class=camp-header> <a href="" ui-sref="home.campaign({id: campmain.campId})">{{campmain.campName}} ({{campmain.campId}})</a></span><br><span translate=CAMP.LINE_ITEM class=camp-header></span><span class=camp-line-item> {{campmain.line_item}} ({{campmain.line_item_id}})</span><div class="control pull-right" dx-select-box=campmain.datePiker></div></div><div class="row camp-content1"><div class="row-fluid charts-block"><div id=zoomedContainerFirst class="first-chart col-lg-5 col-md-9 col-sm-9 col-xs-9"><div id=zoomedChartFirst dx-chart=campmain.chartOptionsFirst></div><div dx-range-selector=campmain.rangeOptionsFirst id=rangeChartFirst></div></div><div class=checkbox-container><div><label class=label-checkbox><div dx-check-box=campmain.impressions></div></label><label class=label-checkbox><div dx-check-box=campmain.CPA></div></label><label class=label-checkbox><div dx-check-box=campmain.CPC></div></label><label class=label-checkbox><div dx-check-box=campmain.clicks></div></label><label class=label-checkbox><div dx-check-box=campmain.cost></div></label><label class=label-checkbox><div dx-check-box=campmain.conversions></div></label><label class=label-checkbox><div dx-check-box=campmain.CTR></div></label></div></div><div id=zoomedContainerSecond class="first-chart col-lg-5 col-md-10 col-sm-10"><div id=zoomedChartSecond dx-chart=campmain.chartOptionsSecond></div><!--<div dx-range-selector="campmain.rangeOptionsSecond"></div>--></div></div><div class=counter-popup-group dx-popup=campmain.UI.confirmPopup><div class=title>{{ \'campmain.SUSPEND\' | translate }}</div><div id=radioGroupMain dx-radio-group=campmain.UI.radioGroupMain></div><div id=dateFormatPop style="margin-left: 35px" dx-date-box=campmain.UI.dateFormatPop></div><br><div id=radioGroupSend dx-radio-group=campmain.UI.radioGroupSend></div><div class=button id=buttonOk dx-button=campmain.UI.confirmPopupOk></div><div class=button dx-button=campmain.UI.confirmPopupCancel></div></div></div><div class="row first-grid"><div id=gridContainer2 dx-data-grid=campmain.dataGridOptionsCampaign></div></div></div>'),e.put("app/usual/cpa/cpa.html",'<div class="container-fluid container-camp col-lg-12 col-md-12 col-sm-12"><div class="row stats-header"><div class=groupHeadOpti><span translate=CAMP.NAME class=camp-header></span><span class=camp-header> <a href="" ui-sref="home.campaign({id: cpa.campId})">{{cpa.campName}} ({{cpa.campId}})</a></span><br><span translate=CAMP.LINE_ITEM class=camp-header></span><span class=camp-line-item> {{cpa.line_item}} ({{cpa.line_item_id}})</span><div class="control pull-right" dx-select-box=cpa.UI.datePiker></div></div></div><div class="second-container-details row"><div class=label-container><input type=button ng-click="cpa.selectInfoBtn($event, cpa.ctrlBbtns.placement.header)" name=Placement value={{cpa.ctrlBbtns.placement.btn}} class=nav-btn> <input type=button ng-click="cpa.selectInfoBtn($event, cpa.ctrlBbtns.creativeId.header)" name=creative_id value={{cpa.ctrlBbtns.creativeId.btn}} class=nav-btn> <input type=button ng-click="cpa.selectInfoBtn($event, cpa.ctrlBbtns.creativeSize.header)" name=creative_size value={{cpa.ctrlBbtns.creativeSize.btn}} class=nav-btn> <input type=button ng-click="cpa.selectInfoBtn($event, cpa.ctrlBbtns.os.header)" name=OS value={{cpa.ctrlBbtns.os.btn}} class=nav-btn> <input type=button ng-click="cpa.selectInfoBtn($event, cpa.ctrlBbtns.carrier.header)" name=carrier value={{cpa.ctrlBbtns.carrier.btn}} class=nav-btn> <input type=button ng-click="cpa.selectInfoBtn($event, cpa.ctrlBbtns.networkSeller.header)" name=network(seller) value={{cpa.ctrlBbtns.networkSeller.btn}} class=nav-btn> <input type=button ng-click="cpa.selectInfoBtn($event, cpa.ctrlBbtns.connectionType.header)" name=connection_type value={{cpa.ctrlBbtns.connectionType.btn}} class=nav-btn> <input type=button ng-click="cpa.selectInfoBtn($event, cpa.ctrlBbtns.device.header)" name=device value={{cpa.ctrlBbtns.device.btn}} class=nav-btn></div><div class=pie-chart-container><div class=header-pie-chart><div class=pie-chart-header><h4>{{cpa.pieChartHeader}}</h4></div><div class=target-cpa-container><div class=input-target-cpa-text>target CPA</div><input class=input-target-cpa type=text ng-blur=cpa.targetCpaChange($event) ng-keyup="$event.keyCode == 13 && cpa.targetCpaChange($event)" ng-model=cpa.targetCpa maxlength=4></div></div><div class=pie-charts><div class=chart-container dx-pie-chart=cpa.pieChartAll></div><div class=chart-container dx-pie-chart=cpa.pieChartConversions></div></div><div class=row><div class="col-lg-6 cpa-buckets-container"><span class=first>${{cpa.backetsRanges.first.min}}-${{cpa.backetsRanges.first.max}}</span><div id=backets-1 dx-data-grid=cpa.cpaBucketFirst></div></div><div class="col-lg-6 cpa-buckets-container"><span class=first>${{cpa.backetsRanges.second.min}}-${{cpa.backetsRanges.second.max}}</span><div id=backets-2 dx-data-grid=cpa.cpaBucketSecond></div></div></div><div class=row><div class="col-lg-6 cpa-buckets-container"><span class=first>${{cpa.backetsRanges.third.min}}-${{cpa.backetsRanges.third.max}}</span><div id=backets-3 dx-data-grid=cpa.cpaBucketThird></div></div><div class="col-lg-6 cpa-buckets-container"><span class=first>${{cpa.backetsRanges.fourth.min}}+</span><div id=backets-4 dx-data-grid=cpa.cpaBucketFourth></div></div></div></div></div></div>'),e.put("app/usual/main/main.html",'<div class="container-home col-lg-12 col-md-12 col-sm-12 col-xs-12"><h1 translate=MAIN.HOME>Home</h1><div class="col-md-3 col-md-offset-8 piker col-sm-3 col-sm-offset-8 col-xs-5 col-xs-offset-6"><div dx-select-box=main.UI.datePiker></div></div><div class="row charts-block"><div class="col-lg-5 col-md-9 col-sm-9 col-xs-9 chart"><div dx-chart=main.UI.chartOptions id=chart></div></div><div class=checkbox-container><label class=label-checkbox><div class=checkboxchart dx-check-box=main.UI.impressions></div></label><label class=label-checkbox><div class=checkboxchart dx-check-box=main.UI.CVR></div></label><label class=label-checkbox><div class=checkboxchart dx-check-box=main.UI.CPC></div></label><label class=label-checkbox><div class=checkboxchart dx-check-box=main.UI.clicks></div></label><label class=label-checkbox><div class=checkboxchart dx-check-box=main.UI.cost></div></label><label class=label-checkbox><div class=checkboxchart dx-check-box=main.UI.conversions></div></label><label class=label-checkbox><div class=checkboxchart dx-check-box=main.UI.CTR></div></label></div><div class="col-lg-5 col-md-12 col-sm-12 chart"><div id=visualMap></div></div></div><div class="row first-grid table-responsive"><table class="table table-bordered"><tr><td translate=MAIN.TOTALS.COLUMNS.TOTALS></td><td translate=MAIN.TOTALS.COLUMNS.SPENT></td><td translate=MAIN.TOTALS.COLUMNS.CONV></td><td translate=MAIN.TOTALS.COLUMNS.IMP></td><td translate=MAIN.TOTALS.COLUMNS.CPC></td><td translate=MAIN.TOTALS.COLUMNS.CPM></td><td translate=MAIN.TOTALS.COLUMNS.CVR></td><td translate=MAIN.TOTALS.COLUMNS.CTR></td></tr><tr><td></td><td>${{main.totals.spent}}</td><td>{{main.totals.conv}}</td><td>{{main.totals.imp}}</td><td>${{main.totals.cpc}}</td><td>${{main.totals.cpm}}</td><td>{{main.totals.cvr}}%</td><td>{{main.totals.ctr}}%</td></tr></table></div><div class="row second-grid"><div id=gridContainer2 dx-data-grid=main.UI.dataGridOptionsMultiple></div></div></div>'),e.put("app/usual/optimiser/optimiser.html",'<div class="container-fluid optimiser-camp col-lg-12 col-md-12 col-sm-12"><div class="row stats-header"><div class=groupHeadOpti><span translate=CO.OPTIMISER-FOR class=camp-header></span><span class=camp-header> <a href="" ui-sref="home.campaign({id: CO.campId})">{{CO.campName}} ({{CO.campId}})</a></span><br><span translate=CAMP.LINE_ITEM class=camp-header></span><span class=camp-line-item> {{CO.line_item}} ({{CO.line_item_id}})</span><div class="control pull-right" dx-select-box=CO.UI.datePiker></div></div></div><div class="row camp-content1"><!--<div class="transformable" ng-class="{\'smallTargeting\':isSmall, \'bigTargeting\':!isSmall}" >\n      <table class="table table-bordered">\n        <tr>\n          <td class="col-md-3">\n            <h5> {{ \'CO.DOMAIN-LISTS\' | translate }} & {{ \'CO.DOMAINS\' | translate}} </h5>\n            <p ng-repeat="domain in CO.object.domains">\n              {{domain}} - {{ \'CO.DOMAIN\' | translate }}\n            </p>\n          </td>\n          <td class="col-md-2">\n            <h5> {{ \'CO.GEO\' | translate }}</h5>\n            <p ng-repeat="geo in CO.object.geo">\n              {{geo}}\n            </p>\n          </td>\n          <td class="col-md-5">\n            <div class="col-md-6">\n              <h5>{{ \'CO.DEVICE-AND-SUPPLY-TYPE\' | translate }}</h5>\n              <p ng-repeat="device in CO.object.device">\n                {{device}}\n              </p>\n            </div>\n            <div class="col-md-6">\n              <h5>{{ \'CO.BLOCKING\' | translate }}</h5>\n              <p ng-repeat="block in CO.object.block">\n                {{block}}\n              </p>\n            </div>\n          </td>\n          <td class="col-md-2">\n\n          </td>\n        </tr>\n      </table>\n    </div>--><div class=gridContainerWhite dx-data-grid=CO.UI.dataGridOptionsCampaign></div><div class=counter-popup-group dx-popup=CO.UI.confirmPopup><div class=title>{{ \'CO.SUSPEND\' | translate }}</div><div id=radioGroupMain dx-radio-group=CO.UI.radioGroupMain></div><div id=dateFormatPop style="margin-left: 35px" dx-date-box=CO.UI.dateFormatPop></div><br><div id=radioGroupSend dx-radio-group=CO.UI.radioGroupSend></div><div class=button id=buttonOk dx-button=CO.UI.confirmPopupOk></div><div class=button dx-button=CO.UI.confirmPopupCancel></div></div></div></div>'),e.put("app/usual/rules/rule.html",'<div class=logic-rule ng-if=rulesC.typeOfLogic(rule)><button class="btn-danger removeF" ng-click=rulesC.deleteFilds($parent,IndexF) data-title=Delete>X</button><div class=RadioRule><div class=ORback><input class=RadioRuleOr id=orlogic type=radio data-ng-model=rule.logicOrAnd value=or ng-checked="rule.logicOrAnd == \'or\'"><label class=OrLogic for=orlogic><div calss=verticalOr>OR</div></label></div><div class=ANDback><input class=RadioRuleAnd id=andlogic type=radio data-ng-model=rule.logicOrAnd value=and ng-checked="rule.logicOrAnd == \'and\'"><label class=AndLogic for=andlogic><div calss=verticalAnd>AND</div></label></div></div></div><div class=object-rule ng-if=rulesC.typeOfObject(rule)><div ng-if="$index == 0"><button class="btn green addfields" ng-click=rulesC.addField($parent) data-title="Add Field">F+</button> <button class="btn green addgroup" ng-click="rulesC.addGroup($parent, IndexF)" data-title="Add Group">G+</button></div><div class=RuleShow><div class=dropdown><span><select class=select3 data-ng-model=rule.target><option ng-selected="rule.target == \'Placement/App\'">Placement/App</option><!--<option ng-selected="rule.target == \'Carrier\'">Carrier</option>--><!--<option ng-selected="rule.target == \'Device\'">Device</option>--><!--<option ng-selected="rule.target == \'OS\'">OS</option>--><!--<option ng-selected="rule.target == \'Ad exchange\'">Ad exchange</option>--></select></span></div><div class=dropdown1>if <span><select class=select1 data-ng-model=rule.payment><option ng-selected="rule.payment == \'cpa\'">cpa</option><option ng-selected="rule.payment == \'spent\'">spent</option><option ng-selected="rule.payment == \'prediction1\'">prediction1</option><option ng-selected="rule.payment == \'prediction2\'">prediction2</option><option ng-selected="rule.payment == \'impressions\'">impressions</option><option ng-selected="rule.payment == \'clicks\'">clicks</option><option ng-selected="rule.payment == \'ctr\'">ctr</option><option ng-selected="rule.payment == \'cpc\'">cpc</option><option ng-selected="rule.payment == \'cvr\'">cvr</option></select></span></div><!-- START OTHER--><div ng-if="rule.payment != \'prediction1\'  || rule.payment != \'prediction2\'" class=dropdown2>compare <span><select class=select2 data-ng-model=rule.compare><option ng-selected="rule.compare == \'>\'">&#x3e;</option><option ng-selected="rule.compare == \'<\'">&#x3c;</option><option ng-selected="rule.compare == \'=\'">=</option><option ng-selected="rule.compare == \'>=\'">&#x3e;=</option><option ng-selected="rule.compare == \'<=\'">&#x3c;=</option></select></span></div><div ng-if="rule.payment != \'prediction1\'  || rule.payment != \'prediction2\'" class=inputm><label>Value <input class=money type=number ng-model=rule.value></label></div><!-- END OTHER--><!-- START PREDICTION--><div ng-if="rule.payment == \'prediction1\'  || rule.payment == \'prediction2\'" class=dropdown2>{{rule.compare=\'=\'}}</div><div ng-if="rule.payment == \'prediction1\'  || rule.payment == \'prediction2\'" class=inputm><label>Value<select class=money data-ng-model=rule.value><option ng-selected="rule.value == \'good\' || !rule.value?rule.value=\'good\':rule.value">good</option><option ng-selected="rule.value == \'bad\'">bad</option></select></label></div><!-- END PREDICTION--></div></div><div class=GroupShow><!----><!--  --><div class=object-group ng-if="rulesC.typeOfArray(rule) "><div class=bracet-begin></div><div class=GroupRepeat ng-repeat="(IndexF,rule) in rule" ng-include="\'app/rules/rule.html\'"></div><div class=bracet-end></div></div></div>'),
e.put("app/usual/rules/rules.html",'<div class="container-fluid optimiser-camp col-lg-12 col-md-12 col-sm-12"><div class="row stats-header"><div class=groupHeadOpti><span translate=RULESC.OPTIMISER-FOR class=camp-header></span><span class=camp-header> <a href="" ui-sref="home.campaign({id: rulesC.campId})">{{rulesC.campName}} ({{rulesC.campId}})</a></span><br><span translate=CAMP.LINE_ITEM class=camp-header></span><span class=camp-line-item> {{rulesC.line_item}} ({{rulesC.line_item_id}})</span><div class="control pull-right" dx-select-box=rulesC.UI.datePiker></div></div></div><div class="row camp-content1"><!--<h3 class="titleRules" translate="RULESC.RULES">Rules for All Domains:</h3>--><fieldset data-ng-repeat="(Index,rules) in rulesC.rulesArray" class="container-fluid-rule rule"><div class=all-if-rule><div class=chek><div class=DeleteRule><button class="btn btn-danger" translate=RULESC.RULE-DELETE ng-click=rulesC.deleteRule(Index)>RULE DELETE</button></div></div><div class=if-rule data-ng-repeat="(IndexF,rule) in rules.if" ng-include="\'app/rules/rule.html\'"></div><div class=then><input type=radio class=r-optionc ng-model=rules.then id=r-option value=Blacklist ng-click="rulesC.checkTime(Index, rules)"><label class=lr-option for=r-option>Blacklist</label><input type=radio class=r1-optionc ng-model=rules.then id=r1-option value=Whitelist ng-click="rulesC.checkTime(Index, rules)"><label class=lr1-option for=r1-option>Whitelist</label><div class=RadioTime1>Suspend: <input type=radio class=option1 id=option1 ng-model=rules.then value=1 ng-click="rulesC.checkTime(Index, rules)"><label class=lr-option-time for=option1>24 hrs</label><input type=radio class=option2 id=option2 ng-model=rules.then value=3 ng-click="rulesC.checkTime(Index, rules)"><label class=lr1-option-time for=option2>3 days</label><input type=radio class=option3 id=option3 ng-model=rules.then value=7 ng-click="rulesC.checkTime(Index, rules)"><label class=lr2-option-time for=option3>7 days</label><input type=radio class=option4 id=option4 ng-model=rules.then value=0 ng-click="rulesC.checkTime(Index, rules)"><label class=lr3-option-time for=option4>manual</label></div><p class=TimeRule ng-if=rules.time>Time:{{rules.time}}</p></div></div></fieldset><button class="btn btn-primary" translate=RULESC.ADD-RULE ng-click=rulesC.addNewRule()>Add rule</button> <button class="btn btn-success" translate=RULESC.SAVE-RULE ng-click=rulesC.saveRules()>Save rule</button></div></div>'),e.put("app/video/bcc/bcc.html",'<div class="container-fluid container-camp col-lg-12 col-md-12 col-sm-12"><div class="row stats-header"><span translate=CAMP.NAME class=camp-header></span><span class=camp-header> <a href="" ui-sref="home.videocampaign({id: bcc.campId})">{{bcc.campName}} ({{bcc.campId}})</a></span><br><span translate=CAMP.LINE_ITEM class=camp-header></span><span class=camp-line-item> {{bcc.line_item}} ({{bcc.line_item_id}})</span><div class="control pull-right" dx-select-box=bcc.UI.datePiker></div></div><div class="row camp-content1"><div class=row><div dx-load-panel=bcc.UI.loadPanel></div><div class="col-lg-4 col-md-4 col-sm-4"><div translate=BCC.SELECT-CAMPAIGN>Select Campaign:</div><div dx-select-box=bcc.UI.searchOptions></div></div><div class="col-lg-6 col-md-6 col-sm-6"><div translate=BCC.ADD-DOMAIN>Add domain:</div><div dx-text-area=bcc.UI.domainArea></div></div><div class="col-lg-2 col-md-2 col-sm-2"><div dx-button=bcc.UI.send class=margin-top></div></div></div><div class="dx-toast-success dx-toast-content message" ng-show=bcc.message><div class=dx-toast-icon></div>{{ bcc.message }}</div></div></div>'),e.put("app/video/campaign/videocampaign.html",'<div class="container-fluid container-camp col-lg-12 col-md-12 col-sm-12"><div class="row stats-header"><span translate=CAMP.NAME class=camp-header></span><span class=camp-header> <a href="" ui-sref="home.videocampaign({id: videocamp.campId})">{{videocamp.campName}} ({{videocamp.campId}})</a></span><br><span translate=CAMP.LINE_ITEM class=camp-header></span><span class=camp-line-item> {{videocamp.line_item}} ({{videocamp.line_item_id}})</span><div class="control pull-right" dx-select-box=videocamp.UI.datePiker></div></div><div class="row charts-block"><div class="row camp-content1"><div class="col-lg-10 col-md-10 col-sm-10 col-xs-10 chart"><div dx-chart=videocamp.UI.chartOptions id=chart></div></div><div class=checkbox-container><label class=label-checkbox><div class=checkboxchart dx-check-box=videocamp.UI.impressions></div></label><label class=label-checkbox><div class=checkboxchart dx-check-box=videocamp.UI.ad_starts></div></label><label class=label-checkbox><div class=checkboxchart dx-check-box=videocamp.UI.fill_rate></div></label><label class=label-checkbox><div class=checkboxchart dx-check-box=videocamp.UI.profit_loss></div></label><label class=label-checkbox><div class=checkboxchart dx-check-box=videocamp.UI.cost></div></label></div></div></div></div>'),e.put("app/video/main/videomain.html",'<div class="container-home col-lg-12 col-md-12 col-sm-12 col-xs-12"><h1 translate=MAIN.HOME>Home</h1><div class="col-md-3 col-md-offset-8 piker col-sm-3 col-sm-offset-8 col-xs-5 col-xs-offset-6"><div dx-select-box=vmain.UI.datePiker></div></div><div class="row charts-block"><div class="col-lg-5 col-md-9 col-sm-9 col-xs-9 chart"><div dx-chart=vmain.UI.chartOptions id=chart></div></div><div class=checkbox-container><label class=label-checkbox><div class=checkboxchart dx-check-box=vmain.UI.impressions></div></label><label class=label-checkbox><div class=checkboxchart dx-check-box=vmain.UI.ad_starts></div></label><label class=label-checkbox><div class=checkboxchart dx-check-box=vmain.UI.fill_rate></div></label><label class=label-checkbox><div class=checkboxchart dx-check-box=vmain.UI.profit_loss></div></label><label class=label-checkbox><div class=checkboxchart dx-check-box=vmain.UI.cost></div></label></div><div class="col-lg-5 col-md-12 col-sm-12 chart"><div id=visualMap></div></div></div><div class="row first-grid table-responsive"></div><div class="row second-grid"><div id=gridContainer2 dx-data-grid=vmain.UI.dataGridOptionsMultiple></div></div></div>')}]);